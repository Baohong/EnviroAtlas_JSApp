//>>built
require({cache:{"esri/toolbars/edit":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/_base/Color dojo/has dojo/dom-construct dojo/dom-style ../kernel ../lang ../sniff ./_toolbar ./_Box ./_GraphicMover ./_VertexEditor ./TextEditor ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/TextSymbol ../graphic".split(" "),function(v,a,g,q,p,l,u,z,r,y,x,w,n,b,h,e,d,c,k,f,t){var m=a(n,{declaredClass:"esri.toolbars.Edit",constructor:function(b,
d){if(this._map=b,this._tool=0,this._map.loaded)this._scratchGL=b.graphics;else var f=q.connect(this._map,"onLoad",this,function(){q.disconnect(f);f=null;this._scratchGL=this._map.graphics});b=u("esri-mobile");this._defaultOptions=g.mixin({vertexSymbol:new c(c.STYLE_CIRCLE,b?20:12,new k(k.STYLE_SOLID,new l([0,0,0,.5]),1),new l([128,128,128])),ghostVertexSymbol:new c(c.STYLE_CIRCLE,b?18:10,new k(k.STYLE_SOLID,new l([0,0,0,.5]),1),new l([255,255,255,.75])),ghostLineSymbol:new k(k.STYLE_DOT,new l([128,
128,128]),2),allowDeleteVertices:!0,allowAddVertices:!0,rotateHandleOffset:b?24:16,boxLineSymbol:new k(k.STYLE_DASH,new l([64,64,64]),1),boxHandleSymbol:new c(c.STYLE_SQUARE,b?16:9,new k(k.STYLE_SOLID,new l([0,0,0,.5]),1),new l([255,255,255,.75])),textAnchorSymbol:new c(c.STYLE_CIRCLE,10,null,new l([255,0,0]))},d||{})},activate:function(b,c,d){this.deactivate();this._graphic=c;this._options=g.mixin(g.mixin({},this._defaultOptions),d||{});var k=m.MOVE;d=m.EDIT_VERTICES;var f=m.SCALE,a=m.ROTATE,h=m.EDIT_TEXT,
B=!1,t=!1,e=!1,C=this._map,n=C.spatialReference,E=c.geometry.spatialReference;this._geo=!(!n||!E||n.equals(E)||!n.isWebMercator()||4326!==E.wkid);this._isTextPoint=this._prepareTextSymbolEditing(c,b);(b&k)===k&&(B=this._enableMove(c));k=(b&f)===f;a=(b&a)===a;if((k||a)&&(e=this._enableBoxEditing(c,k,a)),(b&d)===d&&(t=this._enableVertexEditing(c)),(b&h)===h&&this._enableTextEditing(c),!(B||t||e))throw Error("[esri.toolbars.Edit::activate] Unable to activate the tool. Check if the tool is valid for the given geometry type.");
(this._tool=b)&&(this._mapPanEndHandle=q.connect(C,"onPanEnd",this,this._mapPanEndHandler),this._mapExtChgHandle=q.connect(C,"onExtentChange",this,this._mapExtentChangeHandler),this.onActivate(this._tool,c));C.snappingManager&&(B||t)&&C.snappingManager._startSelectionLayerQuery()},deactivate:function(){this._isTextPoint=null;var b=this._tool,c=this._graphic;if(b){var d=!!this._modified;this._clear();q.disconnect(this._mapPanEndHandle);q.disconnect(this._mapExtChgHandle);this._graphic=this._geo=this._mapPanEndHandle=
this._mapExtChgHandle=null;this.onDeactivate(b,c,{isModified:d});this._map.snappingManager&&this._map.snappingManager._stopSelectionLayerQuery()}},refresh:function(){this._refreshMoveables(!0)},getCurrentState:function(){return{tool:this._tool,graphic:this._graphic,isModified:!!this._modified}},onActivate:function(b,c){},onDeactivate:function(b,c,d){},onGraphicMoveStart:function(b){},onGraphicFirstMove:function(b){this._modified=!0},onGraphicMove:function(b,c){},onGraphicMoveStop:function(b,c){},
onGraphicClick:function(b,c){},onVertexMoveStart:function(b,c){},onVertexFirstMove:function(b,c){this._modified=!0},onVertexMove:function(b,c,d){},onVertexMoveStop:function(b,c,d){},onVertexAdd:function(b,c){this._modified=!0},onVertexClick:function(b,c){},onVertexMouseOver:function(b,c){},onVertexMouseOut:function(b,c){},onVertexDelete:function(b,c){this._modified=!0},onTextEditStart:function(b,c){},onTextEditEnd:function(b){},onScaleStart:function(b){},onScaleFirstMove:function(b){this._modified=
!0},onScale:function(b,c){},onScaleStop:function(b,c){},onRotateStart:function(b){},onRotateFirstMove:function(b){this._modified=!0},onRotate:function(b,c){},onRotateStop:function(b,c){},_eventMap:{activate:["tool","graphic"],deactivate:["tool","graphic","info"],"graphic-move-start":["graphic"],"graphic-first-move":["graphic"],"graphic-move":["graphic","transform"],"graphic-move-stop":["graphic","transform"],"graphic-click":["graphic","info"],"vertex-move-start":["graphic","vertexinfo"],"vertex-first-move":["graphic",
"vertexinfo"],"vertex-move":["graphic","vertexinfo","transform"],"vertex-move-stop":["graphic","vertexinfo","transform"],"vertex-add":["graphic","vertexinfo"],"vertex-click":["graphic","vertexinfo"],"vertex-mouse-over":["graphic","vertexinfo"],"vertex-mouse-out":["graphic","vertexinfo"],"vertex-delete":["graphic","vertexinfo"],"scale-start":["graphic"],"scale-first-move":["graphic"],scale:["graphic","info"],"scale-stop":["graphic","info"],"rotate-start":["graphic"],"rotate-first-move":["graphic"],
rotate:["graphic","info"],"rotate-stop":["graphic","info"]},_prepareTextSymbolEditing:function(b,c){if("point"===b.geometry.type||"multipoint"===b.geometry.type){var d=b.getLayer(),k=d.renderer,d=b.symbol||d._getSymbol(b);if(!d&&(k.hasVisualVariables("sizeInfo",!1)||k.hasVisualVariables("colorInfo",!1)||k.hasVisualVariables("opacityInfo",!1))&&k.addBreak&&k.infos&&1===k.infos.length&&(d=k.infos[0].symbol||k.defaultSymbol),d&&"textsymbol"===d.type){if((c&m.SCALE)===m.SCALE||(c&m.ROTATE)===m.ROTATE||
(c&m.EDIT_TEXT)===m.EDIT_TEXT){b.setSymbol(new f(d.toJson()));var a=this;this._textSymbolEditor?(this._textSymbolEditor.createForm(b),this._textSymbolEditor.show()):this._options&&this._options.textSymbolEditor?(this._textSymbolEditor=this._options.textSymbolEditor,this._textSymbolEditor.on("symbol-change",function(){a._boxEditor&&a._boxEditor.refresh()})):v(["../dijit/SymbolEditor"],function(c){if(!a._textSymbolEditor){var d;d=a._options.textSymbolEditorHolder?z.create("div",null,a._options.textSymbolEditorHolder):
z.create("div",null,a._map.root);a._textSymbolEditor=new c({graphic:b},d);c=a._textSymbolEditor.domNode.parentNode.id;r.set(a._textSymbolEditor.domNode,{position:"map_root"===c?"absolute":"relative",left:"map_root"===c?a._map.width/2-100+"px":"5px",top:"20px","z-index":50});a._textSymbolEditor.startup();a._textSymbolEditor.createForm(b);a._textSymbolEditor.show();a._textSymbolEditor.on("symbol-change",function(){a._boxEditor&&a._boxEditor.refresh()})}})}return(c&m.MOVE)!==m.MOVE&&(c&m.ROTATE)!==m.ROTATE&&
(c&m.SCALE)!==m.SCALE||(this._textAnchor=new t(b.geometry,this._options.textAnchorSymbol),this._scratchGL.add(this._textAnchor)),!0}}return!1},_enableMove:function(b){var c=this._map;switch(b.geometry.type){case "point":case "polyline":case "polygon":return this._graphicMover=new h(b,c,this,this._textAnchor),!0}return!1},_enableVertexEditing:function(b){var c=this._map;switch(b.geometry.type){case "multipoint":case "polyline":case "polygon":return this._vertexEditor=e.create(b,c,this),!0}return!1},
_enableBoxEditing:function(c,d,k){var f=this._map,a=c.geometry.type;return!("polyline"!==a&&"polygon"!==a&&!this._isTextPoint)&&(this._boxEditor=new b(c,f,this,d,k,this._options.uniformScaling,this._isTextPoint),!0)},_enableTextEditing:function(b){return!!this._isTextPoint&&(this._textEditor=new d(b,this._map,this),q.connect(this._textEditor,"onEditStart",g.hitch(this,function(){this._textAnchor&&(this._textAnchor.getLayer().remove(this._textAnchor),this._textAnchor=null);this._map.disableKeyboardNavigation();
this._disableMove();this._disableBoxEditing()})),!0)},_disableMove:function(){var b=this._graphicMover;b&&(b.destroy(),this._graphicMover=null)},_disableVertexEditing:function(){var b=this._vertexEditor;b&&(b.destroy(),this._vertexEditor=null)},_disableBoxEditing:function(){var b=this._boxEditor;b&&(b.destroy(),this._boxEditor=null)},_disableTextEditing:function(){this._textEditor&&(this._textEditor.destroy(),this._textEditor=null);this._map.enableKeyboardNavigation()},_disableSymbolEditing:function(){this._textSymbolEditor&&
this._textSymbolEditor.hide()},_clear:function(){this._disableMove();this._disableVertexEditing();this._disableBoxEditing();this._disableTextEditing();this._disableSymbolEditing();this._textAnchor&&(this._textAnchor.getLayer().remove(this._textAnchor),this._textAnchor=null);this._tool=0;this._modified=!1},_mapPanEndHandler:function(){this._refreshMoveables()},_mapExtentChangeHandler:function(b,c,d){d&&this._refreshMoveables()},_refreshMoveables:function(b){var c=p.filter([this._graphicMover,this._vertexEditor,
this._boxEditor],x.isDefined);p.forEach(c,function(c){c.refresh(b)})},_beginOperation:function(b){p.forEach(this._getAffectedTools(b),function(b){b.suspend()})},_endOperation:function(b){p.forEach(this._getAffectedTools(b),function(b){b.resume()})},_getAffectedTools:function(b){var c=[];switch(b){case "MOVE":c=[this._vertexEditor,this._boxEditor];break;case "VERTICES":c=[this._boxEditor];break;case "BOX":c=[this._vertexEditor]}return c=p.filter(c,x.isDefined)}});return g.mixin(m,{MOVE:1,EDIT_VERTICES:2,
SCALE:4,ROTATE:8,EDIT_TEXT:16}),u("extend-esri")&&g.setObject("toolbars.Edit",m,y),m})},"esri/toolbars/_Box":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/Color dojo/has dojo/dom-style dojox/gfx/Moveable dojox/gfx/matrix ../kernel ../lang ../geometry/Point ../geometry/Polyline ../symbols/SimpleMarkerSymbol ../geometry/webMercatorUtils ../geometry/jsonUtils ../graphic".split(" "),function(v,a,g,q,p,l,u,z,r,y,x,w,n,b,h,e,d){v=v(null,{declaredClass:"esri.toolbars._Box",
constructor:function(b,d,f,h,m,e,C){this._graphic=b;this._map=d;this._toolbar=f;this._scale=h;this._rotate=m;this._defaultEventArgs={};this._scaleEvent="Scale";this._rotateEvent="Rotate";this._uniformScaling=e;b=f._options;this._markerSymbol=b.boxHandleSymbol;this._lineSymbol=b.boxLineSymbol;this._moveStartHandler=a.hitch(this,this._moveStartHandler);this._firstMoveHandler=a.hitch(this,this._firstMoveHandler);this._moveStopHandler=a.hitch(this,this._moveStopHandler);this._moveHandler=a.hitch(this,
this._moveHandler);this._isTextPoint=C;this._init()},destroy:function(){this._cleanUp();this._graphic=this._map=this._toolbar=this._markerSymbol=this._lineSymbol=null},refresh:function(){this._draw()},suspend:function(){g.forEach(this._getAllGraphics(),function(b){b.hide()})},resume:function(){g.forEach(this._getAllGraphics(),function(b){b.show()});this._draw()},_init:function(){this._draw()},_cleanUp:function(){this._connects&&g.forEach(this._connects,q.disconnect);var b=this._toolbar._scratchGL;
this._anchors&&g.forEach(this._anchors,function(c){b.remove(c.graphic);(c=c.moveable)&&c.destroy()});this._box&&b.remove(this._box);this._box=this._anchors=this._connects=null},_draw:function(){if(!this._graphic.getDojoShape())return void this._cleanUp();var b=this._map,k=this._toolbar._scratchGL,f=this._getBoxCoords(),h=new n(b.spatialReference),m=a.clone(g.filter(f,function(b,c){return 8!==c&&0==c%2}));m[0]&&m.push([m[0][0],m[0][1]]);h.addPath(m);this._rotate&&h.addPath([f[1],f[8]]);this._box?this._box.setGeometry(h):
(this._box=new d(h,this._lineSymbol),k.add(this._box));this._anchors?g.forEach(this._anchors,function(c,d){this._scale||(d=8);var k=new w(f[d],b.spatialReference);c.graphic.setGeometry(k);var k=c.moveable,a=c.graphic.getDojoShape();a&&(k?a!==k.shape&&(k.destroy(),c.moveable=this._getMoveable(c.graphic,d)):c.moveable=this._getMoveable(c.graphic,d))},this):(this._anchors=[],this._connects=[],g.forEach(f,function(c,f){!this._scale&&8>f||(c=new w(c,b.spatialReference),c=new d(c,this._markerSymbol),this._isTextPoint&&
1==f%2&&c.hide(),k.add(c),this._anchors.push({graphic:c,moveable:this._getMoveable(c,f)}))},this))},_getBoxCoords:function(b){var c,d,h,m,e=this._map,n=[];if(this._isTextPoint){c=this._graphic.getNode().getBoundingClientRect();var l=e.__container.getBoundingClientRect();c=[{x:c.left-l.left,y:c.top-l.top},{x:c.right-l.left,y:c.top-l.top},{x:c.right-l.left,y:c.bottom-l.top},{x:c.left-l.left,y:c.bottom-l.top}]}else c=this._getTransformedBoundingBox(this._graphic);if(g.forEach(c,function(c,k,f){d=c;(h=
f[k+1])||(h=f[0]);m={x:(d.x+h.x)/2,y:(d.y+h.y)/2};b||(d=e.toMap(d),m=e.toMap(m));n.push([d.x,d.y]);n.push([m.x,m.y])}),this._rotate)c=a.clone(n[1]),c=b?{x:c[0],y:c[1]}:e.toScreen({x:c[0],y:c[1],spatialReference:e.spatialReference}),c.y-=this._toolbar._options.rotateHandleOffset,b||(c=e.toMap(c)),n.push([c.x,c.y]);return n},_getTransformedBoundingBox:function(b){var c=this._map,d=b.geometry.getExtent(),a=b.geometry.spatialReference;b=new w(d.xmin,d.ymax,a);d=new w(d.xmax,d.ymin,a);return b=c.toScreen(b),
d=c.toScreen(d),[{x:b.x,y:b.y},{x:d.x,y:b.y},{x:d.x,y:d.y},{x:b.x,y:d.y}]},_getAllGraphics:function(){var b=[this._box];return this._anchors&&g.forEach(this._anchors,function(c){b.push(c.graphic)}),b=g.filter(b,x.isDefined)},_getMoveable:function(b,d){var c=b.getDojoShape();if(c)return b=new z(c),b._index=d,this._connects.push(q.connect(b,"onMoveStart",this._moveStartHandler)),this._connects.push(q.connect(b,"onFirstMove",this._firstMoveHandler)),this._connects.push(q.connect(b,"onMoveStop",this._moveStopHandler)),
b.onMove=this._moveHandler,c=c.getEventSource(),c&&u.set(c,"cursor",this._toolbar._cursors["box"+d]),b},_moveStartHandler:function(b){this._toolbar["on"+(8===b.host._index?this._rotateEvent:this._scaleEvent)+"Start"](this._graphic)},_firstMoveHandler:function(b){this._toolbar._deactivateScrollWheel();var c,d,h=b.host._index,m=this._wrapOffset=b.host.shape._wrapOffsets[0]||0,e=this._graphic.getLayer().getNavigationTransform(),n=g.map(this._getBoxCoords(!0),function(b){return{x:b[0]+m,y:b[1]}});b=this._isTextPoint?
this._map.toScreen(this._graphic.geometry):{x:n[1].x,y:n[3].y};this._centerCoord=r.multiplyPoint(r.invert(e),b);8===h?(c=r.multiplyPoint(r.invert(e),n[1]),this._isTextPoint&&(this._centerCoord=this._deNormalizePoint(this._centerCoord,c)),this._startLine=[this._centerCoord,c],this._moveLine=a.clone(this._startLine)):(c=r.multiplyPoint(r.invert(e),n[h]),d=r.multiplyPoint(r.invert(e),n[(h+4)%8]),this._isTextPoint&&(this._centerCoord=this._deNormalizePoint(this._centerCoord,c)),this._firstMoverToAnchor=
Math.sqrt((c.x-this._centerCoord.x)*(c.x-this._centerCoord.x)+(c.y-this._centerCoord.y)*(c.y-this._centerCoord.y)),this._startBox=d,this._startBox.width=n[4].x-n[0].x,this._startBox.height=n[4].y-n[0].y,this._moveBox=a.clone(this._startBox),this._xfactor=c.x>d.x?1:-1,this._yfactor=c.y>d.y?1:-1,1===h||5===h?this._xfactor=0:3!==h&&7!==h||(this._yfactor=0));this._toolbar._beginOperation("BOX");this._toolbar["on"+(8===h?this._rotateEvent:this._scaleEvent)+"FirstMove"](this._graphic)},_moveHandler:function(b,
d){var c,a,h,k,e,n,l,p;b=b.host._index;var g=this._defaultEventArgs;(g.angle=0,g.scaleX=1,g.scaleY=1,8===b)?(c=this._startLine,a=this._moveLine,h=a[1],h.x+=d.dx,h.y+=d.dy,a=this._getAngle(c,a),this._isTextPoint&&(a+=this._graphic.symbol.angle),d=r.rotategAt(a,c[0]),this._graphic.getDojoShape().setTransform(d),g.transform=d,g.angle=a,g.around=c[0]):((c=this._startBox,a=this._moveBox,a.width+=d.dx*this._xfactor,a.height+=d.dy*this._yfactor,this._uniformScaling||this._isTextPoint?(n=a.x+this._xfactor*
a.width,l=a.y+this._yfactor*a.height,p=Math.sqrt((n-this._centerCoord.x)*(n-this._centerCoord.x)+(l-this._centerCoord.y)*(l-this._centerCoord.y)),this._scaleRatio=h=k=p/this._firstMoverToAnchor,e=this._centerCoord):(h=a.width/c.width,k=a.height/c.height,e={x:c.x,y:c.y}),(isNaN(h)||h===1/0||h===-1/0)&&(h=1),(isNaN(k)||k===1/0||k===-1/0)&&(k=1),d=r.scaleAt(h,k,e),this._isTextPoint)?(c=r.rotategAt(this._graphic.symbol.angle,e),this._graphic.getDojoShape().setTransform([c,d])):this._graphic.getDojoShape().setTransform(d),
g.transform=d,g.scaleX=h,g.scaleY=k,g.around=e);this._toolbar["on"+(8===b?this._rotateEvent:this._scaleEvent)](this._graphic,g)},_moveStopHandler:function(b){this._toolbar._activateScrollWheel();var c,d=this._graphic,a=this._toolbar,m=a._geo?h.geographicToWebMercator(d.geometry):d.geometry,n=m.spatialReference,l=d.getDojoShape(),g=l.getTransform(),p=d.getLayer().getNavigationTransform();this._isTextPoint?(c=this._graphic.symbol,8===b.host._index?c.angle+=this._getAngle(this._startLine,this._moveLine):
c.font.setSize(Math.round(c.font.size*this._scaleRatio*100)/100),this._graphic.setSymbol(c)):(m=m.toJson(),this._updateSegments(m.paths||m.rings,g,p,n),l.setTransform(null),m=e.fromJson(m),d.setGeometry(a._geo?h.webMercatorToGeographic(m,!0):m));this._draw();this._startLine=this._moveLine=this._startBox=this._moveBox=this._xfactor=this._yfactor=null;a._endOperation("BOX");this._defaultEventArgs.transform=g;a["on"+(8===b.host._index?this._rotateEvent:this._scaleEvent)+"Stop"](this._graphic,this._defaultEventArgs)},
_updateSegments:function(b,d,a,h){var c=this._map,k=this._wrapOffset||0;g.forEach(b,function(b){g.forEach(b,function(b){this._updatePoint(b,h,k,r,c,a,d)},this)},this)},_updatePoint:function(b,d,a,h,m,e,n){d=m.toScreen({x:b[0],y:b[1],spatialReference:d},!0);d.x+=a;d=h.multiplyPoint([e,n,h.invert(e)],d);d.x-=a;a=m.toMap(d);b[0]=a.x;b[1]=a.y},_getAngle:function(b,d){return 180*Math.atan2(d[0].y-d[1].y,d[0].x-d[1].x)/Math.PI-180*Math.atan2(b[0].y-b[1].y,b[0].x-b[1].x)/Math.PI},_deNormalizePoint:function(b,
d){var c=this._map._getFrameWidth();if(-1===c)return b;for(b={x:b.x,y:b.y};Math.abs(b.x-d.x)>=c;)b.x<d.x?b.x+=c:b.x-=c;var a=Math.abs(b.x-d.x);return Math.abs(b.x-d.x+c)<a?b.x+=c:Math.abs(b.x-d.x-c)<a&&(b.x-=c),b}});return l("extend-esri")&&a.setObject("toolbars._Box",v,y),v})},"dojox/gfx/Moveable":function(){define("dojo/_base/lang dojo/_base/declare dojo/_base/array dojo/_base/event dojo/topic dojo/touch dojo/dom-class dojo/_base/window ./Mover".split(" "),function(v,a,g,q,p,l,u,z,r){return a("dojox.gfx.Moveable",
null,{constructor:function(a,g){this.shape=a;this.delay=g&&0<g.delay?g.delay:0;this.mover=g&&g.mover?g.mover:r;this.events=[this.shape.on(l.press,v.hitch(this,"onMouseDown"))]},destroy:function(){g.forEach(this.events,function(a){a.remove()});this.events=this.shape=null},onMouseDown:function(a){this.delay?(this.events.push(this.shape.on(l.move,v.hitch(this,"onMouseMove")),this.shape.on(l.release,v.hitch(this,"onMouseUp"))),this._lastX=a.clientX,this._lastY=a.clientY):new this.mover(this.shape,a,this);
q.stop(a)},onMouseMove:function(a){var l=a.clientY;if(Math.abs(a.clientX-this._lastX)>this.delay||Math.abs(l-this._lastY)>this.delay)this.onMouseUp(a),new this.mover(this.shape,a,this);q.stop(a)},onMouseUp:function(a){this.events.pop().remove()},onMoveStart:function(a){p.publish("/gfx/move/start",a);u.add(z.body(),"dojoMove")},onMoveStop:function(a){p.publish("/gfx/move/stop",a);u.remove(z.body(),"dojoMove")},onFirstMove:function(a){},onMove:function(a,l){this.onMoving(a,l);this.shape.applyLeftTransform(l);
this.onMoved(a,l)},onMoving:function(a,l){},onMoved:function(a,l){}})})},"dojox/gfx/Mover":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/declare dojo/on dojo/touch dojo/_base/event".split(" "),function(v,a,g,q,p,l){return g("dojox.gfx.Mover",null,{constructor:function(a,g,r){this.shape=a;this.lastX=g.clientX;this.lastY=g.clientY;a=this.host=r;g=document;r=q(g,p.move,v.hitch(this,"onFirstMove"));this.events=[q(g,p.move,v.hitch(this,"onMouseMove")),q(g,p.release,v.hitch(this,"destroy")),
q(g,"dragstart",v.hitch(l,"stop")),q(g,"selectstart",v.hitch(l,"stop")),r];if(a&&a.onMoveStart)a.onMoveStart(this)},onMouseMove:function(a){var g=a.clientX,p=a.clientY;this.host.onMove(this,{dx:g-this.lastX,dy:p-this.lastY});this.lastX=g;this.lastY=p;l.stop(a)},onFirstMove:function(){this.host.onFirstMove(this);this.events.pop().remove()},destroy:function(){a.forEach(this.events,function(a){a.remove()});var g=this.host;if(g&&g.onMoveStop)g.onMoveStop(this);this.events=this.shape=null}})})},"esri/toolbars/_GraphicMover":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/json dojo/dom-style dojox/gfx/Moveable dojox/gfx/Mover dojox/gfx/matrix ../kernel ../PointerEvents ../sniff ../geometry/webMercatorUtils ../geometry/ScreenPoint ../geometry/Point".split(" "),
function(v,a,g,q,p,l,u,z,r,y,x,w,n,b){var h=v(null,{declaredClass:"esri.toolbars._GraphicMover",constructor:function(b,d,c,a){this.graphic=b;this.map=d;this.toolbar=c;this.tempPt=a;this._enableGraphicMover();this._moved=!1},refresh:function(b){var d=this.graphic.getDojoShape();!d||!b&&d._hostGraphic||(this._disableGraphicMover(),this._enableGraphicMover())},destroy:function(){this._disableGraphicMover()},hasMoved:function(){return this._moved},_enableGraphicMover:function(){var b=this.graphic,d=b.getDojoShape();
d&&(d._hostGraphic=b,this._moveable=new l(d,{mover:h.Mover}),this._moveStartHandle=g.connect(this._moveable,"onMoveStart",this,this._moveStartHandler),this._firstMoveHandle=g.connect(this._moveable,"onFirstMove",this,this._firstMoveHandler),this._movingHandle=g.connect(this._moveable,"onMoving",this,this._movingHandler),this._moveStopHandle=g.connect(this._moveable,"onMoveStop",this,this._moveStopHandler),(b=d.getEventSource())&&p.set(b,"cursor",this.toolbar._cursors.move))},_disableGraphicMover:function(){var b=
this._moveable;if(b){g.disconnect(this._moveStartHandle);g.disconnect(this._firstMoveHandle);g.disconnect(this._movingHandle);g.disconnect(this._moveStopHandle);var d=b.shape;d&&(d._hostGraphic=null,(d=d.getEventSource())&&p.set(d,"cursor","inherit"));b.destroy()}this._moveable=null},_moveStartHandler:function(){var b=this.graphic,d=this.map;this._startTx=b.getDojoShape().getTransform();"point"===this.graphic.geometry.type&&d.snappingManager&&d.snappingManager._setUpSnapping();this.toolbar.onGraphicMoveStart(b)},
_firstMoveHandler:function(){this.toolbar._beginOperation("MOVE");this.toolbar.onGraphicFirstMove(this.graphic)},_movingHandler:function(b,d,c){var a;b=b.shape.getTransform();d=this.map;x("esri-pointer")?a=d.navigationManager.pointerEvents._processTouchEvent(c,c):c&&"pointermove"===c.type&&(a=y.prototype._processTouchEvent.call({map:d},c,c));a&&d.snappingManager&&d.snappingManager._onSnappingMouseMoveHandler(a);this.tempPt&&this.tempPt.getDojoShape().setTransform(b);this.toolbar.onGraphicMove(this.graphic,
b)},_moveStopHandler:function(a){var d=this.graphic,c=this.toolbar,h=this.map,f=c._geo?w.geographicToWebMercator(d.geometry):d.geometry,e=f.type,m=d.getDojoShape(),B=m.getTransform();if(q.toJson(B)!==q.toJson(this._startTx)){switch(this._moved=!0,e){case "point":var g,e=[B,z.invert(this._startTx)];h.snappingManager&&(g=h.snappingManager._snappingPoint);f=g||h.toMap(z.multiplyPoint(e,h.toScreen(f,!0)));h.snappingManager&&h.snappingManager._killOffSnapping();break;case "polyline":f=this._updatePolyGeometry(f,
f.paths,B);break;case "polygon":f=this._updatePolyGeometry(f,f.rings,B)}m.setTransform(null);d.setGeometry(c._geo?w.webMercatorToGeographic(f,!0):f);this.tempPt&&this.tempPt.setGeometry(new b(d.geometry.toJson()))}else this._moved=!1;(c._endOperation("MOVE"),c.onGraphicMoveStop(d,B),this._moved)||(a=a.__e,h=this.map.position,a=new n(a.pageX-h.x,a.pageY-h.y),c.onGraphicClick(d,{screenPoint:a,mapPoint:this.map.toMap(a)}))},_updatePolyGeometry:function(b,d,c){var a,h,e,m;h=this.map;a=b.getPoint(0,0);
h=h.toMap(h.toScreen(a).offset(c.dx,c.dy));c=h.x-a.x;var n=h.y-a.y;for(a=0;a<d.length;a++)for(e=d[a],h=0;h<e.length;h++)m=b.getPoint(a,h),b.setPoint(a,h,m.offset(c,n));return b}});return h.Mover=v(u,{declaredClass:"esri.toolbars._Mover",constructor:function(b,d,c){this.__e=d}}),x("extend-esri")&&(a.setObject("toolbars._GraphicMover",h,r),a.setObject("toolbars._Mover",h.Mover,r)),h})},"esri/toolbars/_VertexEditor":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/has dijit/Menu dijit/MenuItem ../kernel ./_VertexMover ../geometry/Point ../geometry/jsonUtils dojo/i18n!../nls/jsapi".split(" "),
function(v,a,g,q,p,l,u,z,r,y,x,w){var n=v(null,{declaredClass:"esri.toolbars._GraphicVertexEditor",constructor:function(b,a,e){this.graphic=b;this.map=a;this.toolbar=e;b=e._options;this._symbol1=b.vertexSymbol;this._symbol2=b.ghostVertexSymbol;a=b.ghostLineSymbol;this._lineStroke={style:a.style,width:a.width,color:a.color};this._canDel=b.allowDeleteVertices;this._canAdd=b.allowAddVertices;this._addControllers()},destroy:function(){this._removeControllers()},refresh:function(b){b?(this._removeControllers(),
this._addControllers()):(this._refresh(this._vertexMovers),this._refresh(this._mpVertexMovers))},suspend:function(){this._suspended||this._removeControllers();this._suspended=!0},resume:function(){this._suspended&&this._addControllers();this._suspended=!1},_addControllers:function(){this._firstMoveHandle=g.connect(r,"onFirstMove",this,this._firstMoveHandler);this._moveStopHandle=g.connect(r,"onMoveStop",this,this._moveStopHandler);this._vertexMovers=this._add(this._getSegments(this.graphic.geometry),
this._symbol1);this._canAdd&&(this._mpVertexMovers=this._add(this._getMidpointSegments(this.graphic.geometry),this._symbol2,!0));var b=this._getGraphicsLayer();if(this._mouseOverHandle=g.connect(b,"onMouseOver",this,this._mouseOverHandler),this._mouseOutHandle=g.connect(b,"onMouseOut",this,this._mouseOutHandler),this._canDel)this._ctxMenu=new l({style:"font-size: 12px; margin-left: 5px; margin-top: 5px;"}),b=this._ctxDelete=new u({label:w.toolbars.edit.deleteLabel,iconClass:"vertexDeleteIcon",style:"outline: none;"}),
this._deleteHandle=g.connect(b,"onClick",this,this._deleteHandler),this._ctxMenu.addChild(b),this._ctxMenu.startup()},_removeControllers:function(){g.disconnect(this._firstMoveHandle);g.disconnect(this._moveStopHandle);g.disconnect(this._mouseOverHandle);g.disconnect(this._mouseOutHandle);g.disconnect(this._deleteHandle);this._ctxMenu&&(this._ctxDelete=null,this._unbindCtxNode(),this._ctxMenu.destroyRecursive());this._remove(this._vertexMovers);this._remove(this._mpVertexMovers);this._vertexMovers=
this._mpVertexMovers=null},_add:function(b,a,e){var d,c,h=this.graphic,f=[];for(d=0;d<b.length;d++){var t=b[d],m=[];for(c=0;c<t.length;c++)m.push(new r(t[c],a,h,d,c,t.length,this,e));f.push(m)}return f},_remove:function(b){b&&q.forEach(b,function(b){q.forEach(b,function(b){b.destroy()})})},_refresh:function(b){b&&q.forEach(b,function(b){q.forEach(b,function(b){b.refresh()})})},_isNew:function(b){return-1===q.indexOf(this._vertexMovers[b.segIndex],b)},_getGraphicsLayer:function(){return this.toolbar._scratchGL},
_deleteHandler:function(b){b=this._selectedMover;b.ptIndex;this._updateRelatedGraphic(b,b.relatedGraphic,b.graphic.geometry,b.segIndex,b.ptIndex,b.segLength,!1,!0);this._canAdd&&this._deleteMidpoints(b);this._deleteVertex(b);this.toolbar._endOperation("VERTICES")},_mouseOverHandler:function(b){b=b.graphic;var a=this._findMover(b);a&&(this.toolbar.onVertexMouseOver(this.graphic,a._getInfo()),a._placeholder||(this._selectedMover=a,this._canDel&&this._bindCtxNode(b.getDojoShape().getNode())))},_mouseOutHandler:function(b){(b=
this._findMover(b.graphic))&&this.toolbar.onVertexMouseOut(this.graphic,b._getInfo())},_bindCtxNode:function(b){this._unbindCtxNode();this._ctxDelete.set("disabled",this._selectedMover.segLength<=this.minLength);this._ctxMenu.bindDomNode(b);this._bindNode=b},_unbindCtxNode:function(){var b=this._bindNode;b&&this._ctxMenu.unBindDomNode(b)},_findMover:function(b){var a,e=[];a=this._mpVertexMovers;q.forEach(this._vertexMovers,function(b){e=e.concat(b)});a&&q.forEach(a,function(b){e=e.concat(b)});for(a=
0;a<e.length;a++){var d=e[a];if(d.graphic===b)return d}},_firstMoveHandler:function(b){!this._isNew(b)&&this._canAdd&&this._hideRelatedMidpoints(b);this.toolbar._beginOperation("VERTICES")},_moveStopHandler:function(b,a){var h=this._isNew(b);if(!a||!a.dx&&!a.dy)return void(!h&&this._canAdd&&this._showRelatedMidpoints(b));this._updateRelatedGraphic(b,b.relatedGraphic,b.graphic.geometry,b.segIndex,b.ptIndex,b.segLength,h);this._canAdd&&(h?this._addMidpoints(b):(this._repositionRelatedMidpoints(b),this._showRelatedMidpoints(b)));
this.toolbar._endOperation("VERTICES")},_showRelatedMidpoints:function(b){var a=this._getAdjacentMidpoints(b.ptIndex,b.segLength),e=this._mpVertexMovers[b.segIndex];for(b=0;b<a.length;b++){var d=e[a[b]];d.graphic.show();d.refresh()}},_hideRelatedMidpoints:function(b){var a=this._getAdjacentMidpoints(b.ptIndex,b.segLength),e=this._mpVertexMovers[b.segIndex];for(b=0;b<a.length;b++)e[a[b]].graphic.hide()},_repositionRelatedMidpoints:function(b){var a,e=this._getAdjacentMidpoints(b.ptIndex,b.segLength),
d=this._mpVertexMovers[b.segIndex];for(a=0;a<e.length;a++){var c=this._getAdjacentVertices(e[a],b.segLength),k=b.relatedGraphic.geometry.getPoint(b.segIndex,c[0]),c=b.relatedGraphic.geometry.getPoint(b.segIndex,c[1]),k=new y({x:(k.x+c.x)/2,y:(k.y+c.y)/2,spatialReference:k.spatialReference.toJson()});d[e[a]].graphic.setGeometry(k)}},_addMidpoints:function(b){var a,e=b.segIndex,d=b.ptIndex,c=b.segLength,k=d+1,f=c+1;this._mpVertexMovers[e].splice(d,1);var t=this._vertexMovers[e];for(a=0;a<k;a++)t[a].segLength+=
1;for(a=k;a<t.length;a++)t[a].ptIndex+=1,t[a].segLength+=1;b.ptIndex=k;b.segLength=t.length+1;t.splice(k,0,b);b.graphic.setSymbol(this._symbol1);t=this._mpVertexMovers[e];for(a=0;a<d;a++)t[a].segLength+=1;for(a=d;a<c-1;a++)t[a].ptIndex+=1,t[a].segLength+=1;c=this._getAdjacentVertices(d,f);e=this._getAdjacentVertices(d+1,f);a=b.relatedGraphic.geometry.getPoint(b.segIndex,c[0]);k=b.relatedGraphic.geometry.getPoint(b.segIndex,c[1]);c=new y({x:(a.x+k.x)/2,y:(a.y+k.y)/2,spatialReference:a.spatialReference.toJson()});
a=b.relatedGraphic.geometry.getPoint(b.segIndex,e[0]);k=b.relatedGraphic.geometry.getPoint(b.segIndex,e[1]);a=new y({x:(a.x+k.x)/2,y:(a.y+k.y)/2,spatialReference:a.spatialReference.toJson()});e=new r(c,this._symbol2,this.graphic,b.segIndex,d,f,this,!0);b=new r(a,this._symbol2,this.graphic,b.segIndex,d+1,f,this,!0);t.splice(d,0,e,b)},_deleteVertex:function(b){var a,e=b.ptIndex,d=this._vertexMovers[b.segIndex];for(a=0;a<e;a++)--d[a].segLength;for(a=e+1;a<d.length;a++){var c=d[a];--c.ptIndex;--c.segLength}d.splice(e,
1);a=b._getInfo();b.destroy();this.toolbar.onVertexDelete(this.graphic,a)}});return a.mixin(n,{create:function(b,a,e){switch(b.geometry.type){case "multipoint":return new n.MultipointVertexEditor(b,a,e);case "polyline":return new n.PolylineVertexEditor(b,a,e);case "polygon":return new n.PolygonVertexEditor(b,a,e)}}}),n.MultipointVertexEditor=v(n,{declaredClass:"esri.toolbars._MultipointVertexEditor",minLength:1,constructor:function(){this._moveStartHandle=g.connect(r,"onMoveStart",this,this._moveStartHandler);
g.disconnect(this._firstMoveHandle)},destroy:function(){this.inherited(arguments);g.disconnect(this._moveStartHandle)},_getSegments:function(b){var a=b.points,e=[],d=b.spatialReference;for(b=0;b<a.length;b++){var c=a[b];e.push(new y({x:c[0],y:c[1],spatialReference:d.toJson()}))}return[e]},_getMidpointSegments:function(b){return[]},_getControlPoints:function(b,a,e,d,c){return[]},_getGraphicsLayer:function(){return this.graphic._graphicsLayer},_mouseOverHandler:function(b){var a=b.graphic;(b=this._findMover(b))&&
(this.toolbar.onVertexMouseOver(a,b._getInfo()),this._selectedMover=b,this._canDel&&this._bindCtxNode(b.graphic.getDojoShape().getNode()))},_mouseOutHandler:function(b){var a=b.graphic;(b=this._findMover(b))&&this.toolbar.onVertexMouseOut(a,b._getInfo())},_findMover:function(b){var a=[].concat(this._vertexMovers[0]),e=b.target;for(b=0;b<a.length;b++){var d=a[b];if(d.graphic.getDojoShape().getNode()===e)return d}},_moveStartHandler:function(b){var a=b.ptIndex,e=b.segLength-1,d=b.relatedGraphic.geometry.points;
b=d.splice(a,1);d.push(b[0]);d=this._vertexMovers[0];for(b=e;b>a;b--)--d[b].ptIndex;b=d.splice(a,1);d.push(b[0]);b[0].ptIndex=e},_moveStopHandler:function(b){this._updateRelatedGraphic(b,b.relatedGraphic,b.graphic.geometry,b.segIndex,b.ptIndex,b.segLength);this.toolbar._endOperation("VERTICES")},_updateRelatedGraphic:function(b,a,e,d,c,k,f,t){b=a.geometry;t?b.removePoint(c):b.setPoint(c,e);a.setGeometry(b)},_deleteMidpoints:function(b){}}),n.PolylineVertexEditor=v(n,{declaredClass:"esri.toolbars._PolylineVertexEditor",
minLength:2,_getSegments:function(b){var a,e,d=b.paths,c=[];for(a=0;a<d.length;a++){var k=d[a],f=[];for(e=0;e<k.length;e++)f.push(b.getPoint(a,e));c.push(f)}return c},_getMidpointSegments:function(b){var a,e,d=b.paths,c=[],k=b.spatialReference;for(a=0;a<d.length;a++){var f=d[a],t=[];for(e=0;e<f.length-1;e++){var m=b.getPoint(a,e),n=b.getPoint(a,e+1),m=new y({x:(m.x+n.x)/2,y:(m.y+n.y)/2,spatialReference:k.toJson()});t.push(m)}c.push(t)}return c},_getControlPoints:function(b,a,e,d,c){var k,f,h,m,n=
this.map;return this._isNew(b)?(k=d,f=d+1,0<=k&&(h=n.toScreen(a.getPoint(e,k))),f<=c&&(m=n.toScreen(a.getPoint(e,f)))):(k=d-1,f=d+1,0<=k&&(h=n.toScreen(a.getPoint(e,k))),f<c&&(m=n.toScreen(a.getPoint(e,f)))),[h,m]},_getAdjacentMidpoints:function(b,a){var h=[],d=b-1;0<=d&&h.push(d);return b<a-1&&h.push(b),h},_getAdjacentVertices:function(b,a){return[b,b+1]},_deleteMidpoints:function(b){var a,e=this._mpVertexMovers[b.segIndex],d=e.length-1,c=this._getAdjacentMidpoints(b.ptIndex,b.segLength).sort(),
k=c[0];for(a=0;a<k;a++)--e[a].segLength;for(a=k+1;a<e.length;a++){var f=e[a];--f.ptIndex;--f.segLength}if(1===c.length)e.splice(k,1)[0].destroy();else for(f=this._getAdjacentVertices(k,d),a=b.relatedGraphic.geometry.getPoint(b.segIndex,f[0]),f=b.relatedGraphic.geometry.getPoint(b.segIndex,f[1]),a=new y({x:(a.x+f.x)/2,y:(a.y+f.y)/2,spatialReference:a.spatialReference.toJson()}),b=new r(a,this._symbol2,this.graphic,b.segIndex,k,d,this,!0),e=e.splice(k,c.length,b),a=0;a<e.length;a++)e[a].destroy()},
_updateRelatedGraphic:function(b,a,e,d,c,k,f,t){b=a.geometry;f?b.insertPoint(d,c+1,x.fromJson(e.toJson())):t?b.removePoint(d,c):b.setPoint(d,c,x.fromJson(e.toJson()));a.setGeometry(b)}}),n.PolygonVertexEditor=v(n,{declaredClass:"esri.toolbars._PolygonVertexEditor",minLength:3,_getSegments:function(b){var a,e,d=b.rings,c=[];for(a=0;a<d.length;a++){var k=d[a],f=[];for(e=0;e<k.length-1;e++)f.push(b.getPoint(a,e));c.push(f)}return c},_getMidpointSegments:function(b){var a,e,d=b.rings,c=[],k=b.spatialReference;
for(a=0;a<d.length;a++){var f=d[a],t=[];for(e=0;e<f.length-1;e++){var m=b.getPoint(a,e),n=b.getPoint(a,e+1),m=new y({x:(m.x+n.x)/2,y:(m.y+n.y)/2,spatialReference:k.toJson()});t.push(m)}c.push(t)}return c},_getControlPoints:function(b,a,e,d,c){var k,f,t,m,h=this.map;return this._isNew(b)?(k=d,f=(d+1)%c):(k=d-1,k=0>k?(c+k)%c:k,f=(d+1)%c),t=h.toScreen(a.getPoint(e,k)),m=h.toScreen(a.getPoint(e,f)),[t,m]},_getAdjacentMidpoints:function(b,a){var e=b-1;return e=0>e?(a+e)%a:e,[e,b]},_getAdjacentVertices:function(b,
a){return[b,(b+1)%a]},_deleteMidpoints:function(b){var a,e,d,c;e=b.ptIndex;var k=this._mpVertexMovers[b.segIndex],f=k.length-1;d=this._getAdjacentMidpoints(e,b.segLength).sort();c=d[0];var t=d[d.length-1];if(0===e)for(a=this._getAdjacentVertices(f-1,f),e=b.relatedGraphic.geometry.getPoint(b.segIndex,a[0]),a=b.relatedGraphic.geometry.getPoint(b.segIndex,a[1]),e=new y({x:(e.x+a.x)/2,y:(e.y+a.y)/2,spatialReference:e.spatialReference.toJson()}),b=new r(e,this._symbol2,this.graphic,b.segIndex,f-1,f,this,
!0),k.splice(t,1,b)[0].destroy(),k.splice(c,1)[0].destroy(),d=0;d<k.length-1;d++)c=k[d],--c.ptIndex,--c.segLength;else{a=this._getAdjacentVertices(c,f);e=b.relatedGraphic.geometry.getPoint(b.segIndex,a[0]);a=b.relatedGraphic.geometry.getPoint(b.segIndex,a[1]);e=new y({x:(e.x+a.x)/2,y:(e.y+a.y)/2,spatialReference:e.spatialReference.toJson()});b=new r(e,this._symbol2,this.graphic,b.segIndex,c,f,this,!0);t=k.splice(c,d.length,b);for(d=0;d<t.length;d++)t[d].destroy();for(d=0;d<c;d++)--k[d].segLength;
for(d=c+1;d<k.length;d++)c=k[d],--c.ptIndex,--c.segLength}},_updateRelatedGraphic:function(a,n,e,d,c,k,f,t){a=n.geometry;f?a.insertPoint(d,c+1,x.fromJson(e.toJson())):t?(a.removePoint(d,c),0===c&&a.setPoint(d,k-1,x.fromJson(a.getPoint(d,0).toJson()))):(a.setPoint(d,c,x.fromJson(e.toJson())),0===c&&a.setPoint(d,k,x.fromJson(e.toJson())));n.setGeometry(a)}}),p("extend-esri")&&(a.setObject("toolbars._GraphicVertexEditor",n,z),a.setObject("toolbars._MultipointVertexEditor",n.MultipointVertexEditor,z),
a.setObject("toolbars._PolylineVertexEditor",n.PolylineVertexEditor,z),a.setObject("toolbars._PolygonVertexEditor",n.PolygonVertexEditor,z)),n})},"dijit/Menu":function(){define("require dojo/_base/array dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-geometry dojo/dom-style dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/_base/window dojo/window ./popup ./DropDownMenu dojo/ready".split(" "),function(v,a,g,q,p,l,u,z,r,y,x,w,n,b,h,e){x("dijit-legacy-requires")&&e(0,function(){v(["dijit/MenuItem",
"dijit/PopupMenuItem","dijit/CheckedMenuItem","dijit/MenuSeparator"])});return g("dijit.Menu",h,{constructor:function(){this._bindings=[]},targetNodeIds:[],selector:"",contextMenuForWindow:!1,leftClickToOpen:!1,refocus:!0,postCreate:function(){this.contextMenuForWindow?this.bindDomNode(this.ownerDocumentBody):a.forEach(this.targetNodeIds,this.bindDomNode,this);this.inherited(arguments)},_iframeContentWindow:function(a){return n.get(this._iframeContentDocument(a))||this._iframeContentDocument(a).__parent__||
a.name&&document.frames[a.name]||null},_iframeContentDocument:function(a){return a.contentDocument||a.contentWindow&&a.contentWindow.document||a.name&&document.frames[a.name]&&document.frames[a.name].document||null},bindDomNode:function(a){a=q.byId(a,this.ownerDocument);var b;if("iframe"==a.tagName.toLowerCase()){var d=a;b=this._iframeContentWindow(d);b=w.body(b.document)}else b=a==w.body(this.ownerDocument)?this.ownerDocument.documentElement:a;var f={node:a,iframe:d};p.set(a,"_dijitMenu"+this.id,
this._bindings.push(f));var e=r.hitch(this,function(a){var b=this.selector,c=b?function(a){return y.selector(b,a)}:function(a){return a},f=this;return[y(a,c(this.leftClickToOpen?"click":"contextmenu"),function(a){a.stopPropagation();a.preventDefault();(new Date).getTime()<f._lastKeyDown+500||f._scheduleOpen(this,d,{x:a.pageX,y:a.pageY},a.target)}),y(a,c("keydown"),function(a){if(93==a.keyCode||a.shiftKey&&a.keyCode==z.F10||f.leftClickToOpen&&a.keyCode==z.SPACE)a.stopPropagation(),a.preventDefault(),
f._scheduleOpen(this,d,null,a.target),f._lastKeyDown=(new Date).getTime()})]});f.connects=b?e(b):[];d&&(f.onloadHandler=r.hitch(this,function(){var a=this._iframeContentWindow(d),a=w.body(a.document);f.connects=e(a)}),d.addEventListener?d.addEventListener("load",f.onloadHandler,!1):d.attachEvent("onload",f.onloadHandler))},unBindDomNode:function(a){var b;try{b=q.byId(a,this.ownerDocument)}catch(m){return}a="_dijitMenu"+this.id;if(b&&p.has(b,a)){for(var d=p.get(b,a)-1,f=this._bindings[d],e;e=f.connects.pop();)e.remove();
(e=f.iframe)&&(e.removeEventListener?e.removeEventListener("load",f.onloadHandler,!1):e.detachEvent("onload",f.onloadHandler));p.remove(b,a);delete this._bindings[d]}},_scheduleOpen:function(a,b,k,f){this._openTimer||(this._openTimer=this.defer(function(){delete this._openTimer;this._openMyself({target:f,delegatedTarget:a,iframe:b,coords:k})},1))},_openMyself:function(a){function c(){p.refocus&&w&&w.focus();b.close(p)}var d=a.target,f=a.iframe,e=a.coords,m=!e;this.currentTarget=a.delegatedTarget;
if(e){if(f){a=l.position(f,!0);var d=this._iframeContentWindow(f),d=l.docScroll(d.document),n=u.getComputedStyle(f),h=u.toPixelValue,g=(x("ie")&&x("quirks")?0:h(f,n.paddingLeft))+(x("ie")&&x("quirks")?h(f,n.borderLeftWidth):0),f=(x("ie")&&x("quirks")?0:h(f,n.paddingTop))+(x("ie")&&x("quirks")?h(f,n.borderTopWidth):0);e.x+=a.x+g-d.x;e.y+=a.y+f-d.y}}else e=l.position(d,!0),e.x+=10,e.y+=10;var p=this,f=this._focusManager.get("prevNode");a=this._focusManager.get("curNode");var w=!a||q.isDescendant(a,
this.domNode)?f:a;b.open({popup:this,x:e.x,y:e.y,onExecute:c,onCancel:c,orient:this.isLeftToRight()?"L":"R"});this.focus();m||this.defer(function(){this._cleanUp(!0)});this._onBlur=function(){this.inherited("_onBlur",arguments);b.close(this)}},destroy:function(){a.forEach(this._bindings,function(a){a&&this.unBindDomNode(a.node)},this);this.inherited(arguments)}})})},"esri/toolbars/_VertexMover":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/sniff dojo/dom-style dojox/gfx/Moveable ../kernel ../PointerEvents ../sniff ../geometry/Point ../graphic ../geometry/webMercatorUtils".split(" "),
function(v,a,g,q,p,l,u,z,r,y,x,w){v=v(null,{declaredClass:"esri.toolbars.VertexMover",constructor:function(a,b,h,e,d,c,k,f){this.point=a;this.symbol=b;this.relatedGraphic=h;this.segIndex=e;this.ptIndex=d;this.segLength=c;this.editor=k;this.map=k.map;this._scratchGL=k.toolbar._scratchGL;this._placeholder=f||!1;this._type=h.geometry.type;this._init();this._enable()},refresh:function(a){(a||this._needRefresh())&&(this._disable(),this._enable())},destroy:function(){this._disable();this.graphic&&this._scratchGL.remove(this.graphic);
this.point=this.symbol=this.graphic=this.relatedGraphic=this.segIndex=this.ptIndex=this.segLength=this.editor=this.map=this._scratchGL=null},_init:function(){var a=new y(this.point.toJson()),a=new x(a,this.symbol);switch(this._type){case "multipoint":a._shape=this.relatedGraphic.getDojoShape().children[this.ptIndex];break;case "polyline":case "polygon":this._scratchGL.add(a)}this.graphic=a},_enable:function(){var a=this.graphic.getDojoShape();a&&(a._hasMover=!0,this._moveable=this._getMoveable(a),
(a=a.getEventSource())&&p.set(a,"cursor",this.editor.toolbar._cursors[this._placeholder?"move-gv":"move-v"]))},_disable:function(){var a=this._moveable;if(a){g.disconnect(this._startHandle);g.disconnect(this._firstHandle);g.disconnect(this._movingHandle);g.disconnect(this._stopHandle);var b=a.shape;b&&(b=b.getEventSource())&&p.set(b,"cursor","inherit");a.destroy();this._moveable=null}},_needRefresh:function(){var a=this.graphic.getDojoShape(),b=!1;if(a)switch(this._type){case "multipoint":var h=this.relatedGraphic.getDojoShape();
h&&(h=h.children[this.ptIndex],a!==h&&(a=h,this.graphic._shape=a,b=!0));break;case "polyline":case "polygon":b=!a._hasMover}return b},_getMoveable:function(a){a=new l(a,q("mac")&&q("ff")&&!r("esri-touch")&&{leftButtonOnly:!0});return this._startHandle=g.connect(a,"onMoveStart",this,this._moveStartHandler),this._firstHandle=g.connect(a,"onFirstMove",this,this._firstMoveHandler),this._movingHandle=g.connect(a,"onMoving",this,this._movingHandler),this._stopHandle=g.connect(a,"onMoveStop",this,this._moveStopHandler),
a},_getPtIndex:function(){return this.ptIndex+(this._placeholder?1:0)},_getInfo:function(){return{graphic:this.graphic,isGhost:this._placeholder,segmentIndex:this.segIndex,pointIndex:this._getPtIndex()}},_moveStartHandler:function(a){var b=this.map;b.snappingManager&&b.snappingManager._setUpSnapping();this.editor.toolbar._deactivateScrollWheel();a.shape.moveToFront();this.constructor.onMoveStart(this);this.editor.toolbar.onVertexMoveStart(this.relatedGraphic,this._getInfo())},_firstMoveHandler:function(a){var b,
h=a.shape,e=this._getControlEdges(),d=this._scratchGL._div,c=[],k=a.host.shape._wrapOffsets[0]||0;for(b=0;b<e.length;b++){var f=e[b];f.x1+=k;f.x2+=k;c.push([d.createLine({x1:f.x1,y1:f.y1,x2:f.x2,y2:f.y2}).setStroke(this.editor._lineStroke),f.x1,f.y1,f.x2,f.y2])}h._lines=c;a.shape.moveToFront();this.constructor.onFirstMove(this);this.editor.toolbar.onVertexFirstMove(this.relatedGraphic,this._getInfo())},_movingHandler:function(a,b,h){var e;b=this.map;r("esri-pointer")?e=b.navigationManager.pointerEvents._processTouchEvent(h,
h):h&&"pointermove"===h.type&&(e=z.prototype._processTouchEvent.call({map:b},h,h));e&&b.snappingManager&&b.snappingManager._onSnappingMouseMoveHandler(e);h=a.shape;a=h.getTransform();e=h._lines;for(h=0;h<e.length;h++)b=e[h],b[0].setShape({x1:b[1]+a.dx,y1:b[2]+a.dy,x2:b[3],y2:b[4]});this.editor.toolbar.onVertexMove(this.relatedGraphic,this._getInfo(),a)},_moveStopHandler:function(a){a=a.shape;var b=this.editor.toolbar,h=a.getTransform(),e=this.map,d=this.graphic,c=b._geo?w.geographicToWebMercator(d.geometry):
d.geometry;b._activateScrollWheel();var k,f=a._lines;if(f){for(k=0;k<f.length;k++)f[k][0].removeShape();a._lines=null}k=!1;var f=!0,t=this._getInfo();h&&(h.dx||h.dy)?this._placeholder&&(this._placeholder=!1,k=!0):f=!1;var m;e.snappingManager&&(m=e.snappingManager._snappingPoint);m=m||e.toMap(e.toScreen(c).offset(h.dx,h.dy));e.snappingManager&&e.snappingManager._killOffSnapping();a.setTransform(null);d.setGeometry(b._geo?w.webMercatorToGeographic(m,!0):m);this.constructor.onMoveStop(this,h);b.onVertexMoveStop(this.relatedGraphic,
t,h);f||b.onVertexClick(this.relatedGraphic,t);k&&b.onVertexAdd(this.relatedGraphic,this._getInfo())},_getControlEdges:function(){var a=this.map,b=this.relatedGraphic.geometry,h=this.segIndex,e=this.ptIndex,d=this.segLength,c=this._scratchGL.getNavigationTransform(),k=c.dx,c=c.dy,f=a.toScreen(this.graphic.geometry),a=f.x-k,f=f.y-c,t=[],b=this.editor._getControlPoints(this,b,h,e,d);return b[0]&&t.push({x1:a,y1:f,x2:b[0].x-k,y2:b[0].y-c}),b[1]&&t.push({x1:a,y1:f,x2:b[1].x-k,y2:b[1].y-c}),t}});return r("extend-esri")&&
a.setObject("toolbars.VertexMover",v,u),a.mixin(v,{onMoveStart:function(){},onFirstMove:function(){},onMoveStop:function(){}}),v})},"esri/toolbars/TextEditor":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/event dojo/has dojo/dom-construct dojo/dom-class dojo/dom-style dojo/keys ../kernel".split(" "),function(v,a,g,q,p,l,u,z,r,y){v=v(null,{declaredClass:"esri.toolbars.TextEditor",constructor:function(a,g,l){this._graphic=a;this._map=g;this._toolbar=l;this._enable(this._graphic)},
destroy:function(){this._disable()},onEditStart:function(){},onEditEnd:function(){},_enable:function(a){if(this._editBox)return g.disconnect(this._addEditBoxHandler),void(this._addEditBoxHandler=null);this._map.navigationManager.setImmediateClick(!0);this._addEditBoxHandler=g.connect(a.getLayer(),"onDblClick",this,function(l){this._map.navigationManager.setImmediateClick(!1);l.graphic==a&&(q.stop(l),g.disconnect(this._addEditBoxHandler),this._addEditBoxHandler=null,this._addTextBox(a))})},_disable:function(){this._applyEdit();
this._addEditBoxHandler&&(g.disconnect(this._addEditBoxHandler),this._addEditBoxHandler=null);this._removeTextBox();this.onEditEnd(this._graphic);this._toolbar.onTextEditEnd(this._graphic)},_addTextBox:function(p,q){if(!this._editBox){var n;p.symbol.text||(p.symbol.text="Tempt text",p.setSymbol(p.symbol),n="");var b=this._createInputTextStyle(p,this._map);""!==n&&(n=q||p.symbol.text);this._editBox=l.create("input",{type:"text",value:n});z.set(this._editBox,b);u.add(this._editBox,"esriTextEditorInput");
this._map.container.appendChild(this._editBox);this._editBox.focus();this._editBoxKeyHandler=g.connect(this._editBox,"onkeyup",a.hitch(this,function(a){a.keyCode!=r.ENTER&&a.keyCode!==r.TAB||this._disable()}));this._editBoxBlurHandler=g.connect(this._editBox,"onblur",a.hitch(this,function(a){this._disable()}));p.symbol.text="";p.setSymbol(p.symbol);p.hide();var h=this._editBox;this._disableBoxHandler||(this._disableBoxHandler=this._map.on("zoom-start",a.hitch(this,function(){this._disable()})));this._moveBoxHandler=
this._map.on("pan",function(a){z.set(h,{left:this._editBoxLeft+a.delta.x+"px",top:this._editBoxTop+a.delta.y+"px"})});this._moveBoxStartHandler=this._map.on("pan-start",function(){this._editBoxLeft=parseFloat(z.get(h,"left"));this._editBoxTop=parseFloat(z.get(h,"top"))});this.onEditStart(p,this._editBox);this._toolbar.onTextEditStart(p,this._editBox)}},_removeTextBox:function(){this._editBoxBlurHandler&&(g.disconnect(this._editBoxBlurHandler),this._editBoxBlurHandler=null);this._editBox&&(this._editBox.parentNode.removeChild(this._editBox),
this._editBox=null);this._disableBoxHandler&&(this._disableBoxHandler.remove(),this._disableBoxHandler=null);this._moveBoxHandler&&(this._moveBoxHandler.remove(),this._moveBoxHandler=null);this._moveBoxStartHandler&&(this._moveBoxStartHandler.remove(),this._moveBoxStartHandler=null);this._editBoxKeyHandler&&(g.disconnect(this._editBoxKeyHandler),this._editBoxKeyHandler=null)},_createInputTextStyle:function(a,g){g=a.getDojoShape().getTransformedBoundingBox();var l=a.getLayer(),l=l.hasLocalNavigationTransform()?
{dx:0,dy:0}:l.getNavigationTransform(),b=a.symbol.font;return{"font-family":b.family,"font-size":b.size+"px","font-style":b.style,"font-variant":b.variant,"font-weight":b.weight,left:g[0].x+l.dx+"px",top:g[0].y+l.dy+"px",width:Math.abs(g[0].x-g[1].x)/Math.cos(a.symbol.angle/180*Math.PI)+"px"}},_applyEdit:function(){if(this._editBox)if(this._editBox.value){this._graphic.show();var a=this._graphic.symbol;a.text=this._editBox.value;this._graphic.setSymbol(a)}else this._graphic.getLayer().remove(this._graphic)}});
return p("extend-esri")&&a.setObject("toolbars.TextEditor",v,y),v})},"esri/geometry/projection":function(){define("require exports dojo/Deferred ./pe ../SpatialReference ./GeographicTransformation".split(" "),function(v,a,g,q,p,l){function u(a,g,b,h,e){if(void 0===h&&(h=null),void 0===e&&(e=!1),null===h){var d=l.cacheKey(g,b);void 0!==x[d]?h=x[d]:(h=z(g,b,null),null===h&&(h=new l),x[d]=h)}return r._project(a,g,b instanceof p||!1===e?b:new p(b),h,e)}function z(a,g,b){void 0===b&&(b=null);a=r._getTransformation(a,
g,b);return null!==a?l.fromGE(a):null}Object.defineProperty(a,"__esModule",{value:!0});var r=null;a.isLoaded=function(){return!!r&&q.isLoaded()};a.isSupported=function(){return q.isSupported()};var y=null;a.load=function(){if(y)return y.promise;y=new g;var a=q.load();return v(["./geometryEngine"],function(g){r=g;a.then(function(){r._enableProjection(q);y.resolve()},function(a){y.reject(a)})}),y.promise};a.project=function(a,g,b){return void 0===b&&(b=null),a instanceof Array?0===a.length?[]:u(a,a[0].spatialReference,
g,b):u([a],a.spatialReference,g,b)[0]};var x={};a.projectMany=u;a.getTransformation=z;a.getTransformations=function(a,g,b){void 0===b&&(b=null);a=r._getTransformationBySuitability(a,g,b);if(null!==a){g=[];for(b=0;b<a.length;b++)g.push(l.fromGE(a[b]));return g}return[]}})},"esri/geometry/pe":function(){define(["require","exports","../core/tsSupport/extendsHelper","dojo/Deferred","../core/sniff"],function(v,a,g,q,p){function l(d){function c(a,b,d){a[b]=d(a[b])}a._pe=d;w.init();n.init();b.init();h.init();
e.init();a.PeGCSExtent=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}return g(d,b),d.prototype.destroy=function(){a._pe.destroy(this)},d}(a._pe.PeGCSExtent);for(var k=0,f=[a._pe.PeDatum,a._pe.PeGeogcs,a._pe.PeGeogtran,a._pe.PeObject,a._pe.PeParameter,a._pe.PePrimem,a._pe.PeProjcs,a._pe.PeSpheroid,a._pe.PeUnit];k<f.length;k++)d=f[k],c(d.prototype,"getName",function(a){return function(){return a.call(this,Array(w.PE_NAME_MAX))}});k=0;for(f=[a._pe.PeGeogtran,a._pe.PeProjcs];k<
f.length;k++)d=f[k],c(d.prototype,"getParameters",function(b){return function(){for(var d=Array(w.PE_PARM_MAX),c=b.call(this),f=0;f<d.length;f++){var m=a._pe.getValue(c,"*");d[f]=m?a._pe.wrapPointer(m,a._pe.PeParameter):null;c+=Int32Array.BYTES_PER_ELEMENT}return d}});c(a._pe.PeHorizon.prototype,"getCoord",function(a){return function(){var b=this.getSize();if(!b)return null;var d=[];return y(d,b,a.call(this)),d}});c(a._pe.PeGTlistExtendedEntry.prototype,"getEntries",function(b){var d=a._pe._pe_getPeGTlistExtendedGTsSize();
return function(){var c=null,f=b.call(this);if(!a._pe.compare(f,a._pe.NULL)){var c=[f],m=this.getSteps();if(1<m)for(var f=a._pe.getPointer(f),e=1;e<m;e++)c.push(a._pe.wrapPointer(f+d*e,a._pe.PeGTlistExtendedGTs))}return c}});var t=a._pe._pe_getPeHorizonSize();d=function(b){return function(){var d=this._cache;if(d||(d=new Map,this._cache=d),d.has(b))return d.get(b);var c=null,f=b.call(this);if(!a._pe.compare(f,a._pe.NULL)){var c=[f],e=f.getNump();if(1<e)for(var f=a._pe.getPointer(f),m=1;m<e;m++)c.push(a._pe.wrapPointer(f+
t*m,a._pe.PeHorizon))}return d.set(b,c),c}};c(a._pe.PeProjcs.prototype,"horizonGcsGenerate",d);c(a._pe.PeProjcs.prototype,"horizonPcsGenerate",d);a._pe.PeObject.prototype.toString=function(b){void 0===b&&(b=w.PE_STR_OPTS_NONE);a._pe.ensureCache.prepare();var d=a._pe.getPointer(this),c=a._pe.ensureInt8(Array(w.PE_BUFFER_MAX));return a._pe.Pointer_stringify(a._pe._pe_object_to_string_ext(d,b,c))}}function u(b){if(b){var d=a._pe.getClass(b);d&&(d=a._pe.getCache(d))&&(b=a._pe.getPointer(b))&&delete d[b]}}
function z(b,c){var d=[];c=Array(c);for(var f=0;f<b;f++)d.push(a._pe.ensureInt8(c));return d}function r(a){var b;return Array.isArray(a[0])?(b=[],a.forEach(function(a){b.push(a[0],a[1])})):b=a,b}function y(b,c,e,f){if(void 0===f&&(f=!1),f)for(f=0;f<2*c;f++)b[f]=a._pe.getValue(e+f*Float64Array.BYTES_PER_ELEMENT,"double");else{var d=0===b.length;for(f=0;f<c;f++)d&&(b[f]=Array(2)),b[f][0]=a._pe.getValue(e,"double"),b[f][1]=a._pe.getValue(e+Float64Array.BYTES_PER_ELEMENT,"double"),e+=2*Float64Array.BYTES_PER_ELEMENT}}
Object.defineProperty(a,"__esModule",{value:!0});var x;a._pe=null;a.isLoaded=function(){return!!a._pe};a.isSupported=function(){return!!p("esri-wasm")};a.load=function(){return x?x.promise:(x=new q,v(["./support/pe-wasm"],function(a){a({locateFile:function(a){return v.toUrl("./support/"+a)},onAbort:function(a){x.reject(Error(a))}}).then(function(a){l(a);x.resolve()})}),x.promise)};!function(b){function d(b,d,c){a._pe.ensureCache.prepare();var f=r(c),e=c===f,f=a._pe.ensureFloat64(f);b=a._pe._pe_geog_to_proj(a._pe.getPointer(b),
d,f);return b&&y(c,d,f,e),b}function e(a,b,d){return f(a,b,d,0)}function f(b,d,c,f){a._pe.ensureCache.prepare();var e=r(c),m=c===e,e=a._pe.ensureFloat64(e);b=a._pe._pe_proj_to_geog_center(a._pe.getPointer(b),d,e,f);return b&&y(c,d,e,m),b}b.geogToProj=d;b.projGeog=function(a,b,c,f){switch(f){case w.PE_TRANSFORM_P_TO_G:return e(a,b,c);case w.PE_TRANSFORM_G_TO_P:return d(a,b,c)}return 0};b.projToGeog=e;b.projToGeogCenter=f}(a.PeCSTransformations||(a.PeCSTransformations={}));var w;!function(b){b.init=
function(){b.PE_BUFFER_MAX=a._pe.PeDefs.prototype.PE_BUFFER_MAX;b.PE_NAME_MAX=a._pe.PeDefs.prototype.PE_NAME_MAX;b.PE_MGRS_MAX=a._pe.PeDefs.prototype.PE_MGRS_MAX;b.PE_USNG_MAX=a._pe.PeDefs.prototype.PE_USNG_MAX;b.PE_DD_MAX=a._pe.PeDefs.prototype.PE_DD_MAX;b.PE_DDM_MAX=a._pe.PeDefs.prototype.PE_DDM_MAX;b.PE_DMS_MAX=a._pe.PeDefs.prototype.PE_DMS_MAX;b.PE_UTM_MAX=a._pe.PeDefs.prototype.PE_UTM_MAX;b.PE_PARM_MAX=a._pe.PeDefs.prototype.PE_PARM_MAX;b.PE_TYPE_NONE=a._pe.PeDefs.prototype.PE_TYPE_NONE;b.PE_TYPE_GEOGCS=
a._pe.PeDefs.prototype.PE_TYPE_GEOGCS;b.PE_TYPE_PROJCS=a._pe.PeDefs.prototype.PE_TYPE_PROJCS;b.PE_TYPE_GEOGTRAN=a._pe.PeDefs.prototype.PE_TYPE_GEOGTRAN;b.PE_TYPE_COORDSYS=a._pe.PeDefs.prototype.PE_TYPE_COORDSYS;b.PE_TYPE_UNIT=a._pe.PeDefs.prototype.PE_TYPE_UNIT;b.PE_STR_OPTS_NONE=a._pe.PeDefs.prototype.PE_STR_OPTS_NONE;b.PE_STR_AUTH_NONE=a._pe.PeDefs.prototype.PE_STR_AUTH_NONE;b.PE_STR_AUTH_TOP=a._pe.PeDefs.prototype.PE_STR_AUTH_TOP;b.PE_STR_NAME_CANON=a._pe.PeDefs.prototype.PE_STR_NAME_CANON;b.PE_PARM_X0=
a._pe.PeDefs.prototype.PE_PARM_X0;b.PE_PARM_ND=a._pe.PeDefs.prototype.PE_PARM_ND;b.PE_TRANSFORM_1_TO_2=a._pe.PeDefs.prototype.PE_TRANSFORM_1_TO_2;b.PE_TRANSFORM_2_TO_1=a._pe.PeDefs.prototype.PE_TRANSFORM_2_TO_1;b.PE_TRANSFORM_P_TO_G=a._pe.PeDefs.prototype.PE_TRANSFORM_P_TO_G;b.PE_TRANSFORM_G_TO_P=a._pe.PeDefs.prototype.PE_TRANSFORM_G_TO_P;b.PE_HORIZON_RECT=a._pe.PeDefs.prototype.PE_HORIZON_RECT;b.PE_HORIZON_POLY=a._pe.PeDefs.prototype.PE_HORIZON_POLY;b.PE_HORIZON_LINE=a._pe.PeDefs.prototype.PE_HORIZON_LINE;
b.PE_HORIZON_DELTA=a._pe.PeDefs.prototype.PE_HORIZON_DELTA}}(w=a.PeDefs||(a.PeDefs={}));!function(b){function c(b,c){var e=null,m=f[b];(m||(m={},f[b]=m),m.hasOwnProperty(String(c)))?e=m[c]:(b=a._pe.PeFactory.prototype.factoryByType(b,c),a._pe.compare(b,a._pe.NULL)||(e=b,m[c]=e));return e=d(e)}function d(b){if(b){var c=b.getType();switch(c){case w.PE_TYPE_GEOGCS:b=a._pe.castObject(b,a._pe.PeGeogcs);break;case w.PE_TYPE_PROJCS:b=a._pe.castObject(b,a._pe.PeProjcs);break;case w.PE_TYPE_GEOGTRAN:b=a._pe.castObject(b,
a._pe.PeGeogtran);break;default:c&w.PE_TYPE_UNIT&&(b=a._pe.castObject(b,a._pe.PeUnit))}}return b}var f={},e={};b.initialize=function(){a._pe.PeFactory.prototype.initialize(null)};b.coordsys=function(a){return c(w.PE_TYPE_COORDSYS,a)};b.factoryByType=c;b.fromString=function(b,c){var f=null,k=e[b];(k||(k={},e[b]=k),k.hasOwnProperty(c))?f=k[c]:(b=a._pe.PeFactory.prototype.fromString(b,c),a._pe.compare(b,a._pe.NULL)||(f=b,k[c]=f));return f=d(f)};b.geogcs=function(a){return c(w.PE_TYPE_GEOGCS,a)};b.geogtran=
function(a){return c(w.PE_TYPE_GEOGTRAN,a)};b.getCode=function(b){return a._pe.PeFactory.prototype.getCode(b)};b.projcs=function(a){return c(w.PE_TYPE_PROJCS,a)};b.unit=function(a){return c(w.PE_TYPE_UNIT,a)}}(a.PeFactory||(a.PeFactory={}));a.PeGCSExtent=null;var n;!function(b){var c;b.init=function(){b.PE_GTLIST_OPTS_COMMON=a._pe.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON;c=a._pe._pe_getPeGTlistExtendedEntrySize()};b.getGTlist=function(b,d,e,m,g,h){var f=null,k=new a._pe.PeInteger(h);try{var l=
a._pe.PeGTlistExtended.prototype.getGTlist(b,d,e,m,g,k);if((h=k.val)&&(f=[l],1<h)){var t=a._pe.getPointer(l);for(b=1;b<h;b++)f.push(a._pe.wrapPointer(t+c*b,a._pe.PeGTlistExtendedEntry))}}finally{a._pe.destroy(k)}return f}}(n=a.PeGTlistExtended||(a.PeGTlistExtended={}));!function(b){b.destroy=function(b){if(b&&b.length){for(var c=0;c<b.length;c++){var d=b[c];u(d);d.getEntries().forEach(function(a){u(a);a=a.getGeogtran();u(a);a.getParameters().forEach(u);[a.getGeogcs1(),a.getGeogcs2()].forEach(function(a){u(a);
var b=a.getDatum();u(b);u(b.getSpheroid());u(a.getPrimem());u(a.getUnit())})})}a._pe.PeGTlistExtendedEntry.prototype.Delete(b[0])}}}(a.PeGTlistExtendedEntry||(a.PeGTlistExtendedEntry={}));!function(b){b.geogToGeog=function(b,d,f,e,m){a._pe.ensureCache.prepare();var c=r(f),k=f===c,c=a._pe.ensureFloat64(c),g=0;e&&(g=a._pe.ensureFloat64(e));b=a._pe._pe_geog_to_geog(a._pe.getPointer(b),d,c,g,m);return b&&y(f,d,c,k),b}}(a.PeGTTransformations||(a.PeGTTransformations={}));!function(b){function c(b,c,d,e,
k,g){a._pe.ensureCache.prepare();var f,m;switch(b){case "dd":f=a._pe._pe_geog_to_dd;m=w.PE_DD_MAX;break;case "ddm":f=a._pe._pe_geog_to_ddm;m=w.PE_DDM_MAX;break;case "dms":f=a._pe._pe_geog_to_dms,m=w.PE_DMS_MAX}b=0;c&&(b=a._pe.getPointer(c));c=r(e);c=a._pe.ensureFloat64(c);m=z(d,m);e=a._pe.ensureInt32(m);if(k=f(b,d,c,k,e))for(f=0;f<d;f++)g[f]=a._pe.Pointer_stringify(m[f]);return k}function d(b,c,d,e,k){a._pe.ensureCache.prepare();var f;switch(b){case "dd":f=a._pe._pe_dd_to_geog;break;case "ddm":f=
a._pe._pe_ddm_to_geog;break;case "dms":f=a._pe._pe_dms_to_geog}b=0;c&&(b=a._pe.getPointer(c));c=e.map(function(b){return a._pe.ensureString(b)});e=a._pe.ensureInt32(c);c=a._pe.ensureFloat64(Array(2*d));f=f(b,d,e,c);return f&&y(k,d,c),f}b.geog_to_dms=function(a,b,d,e,k){return c("dms",a,b,d,e,k)};b.dms_to_geog=function(a,b,c,e){return d("dms",a,b,c,e)};b.geog_to_ddm=function(a,b,d,e,k){return c("ddm",a,b,d,e,k)};b.ddm_to_geog=function(a,b,c,e){return d("ddm",a,b,c,e)};b.geog_to_dd=function(a,b,d,e,
k){return c("dd",a,b,d,e,k)};b.dd_to_geog=function(a,b,c,e){return d("dd",a,b,c,e)}}(a.PeNotationDms||(a.PeNotationDms={}));var b;!function(b){b.init=function(){b.PE_MGRS_STYLE_NEW=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW;b.PE_MGRS_STYLE_OLD=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD;b.PE_MGRS_STYLE_AUTO=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO;b.PE_MGRS_180_ZONE_1_PLUS=a._pe.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS;b.PE_MGRS_ADD_SPACES=a._pe.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES};
b.geog_to_mgrs_extended=function(b,d,f,e,g,h,l){a._pe.ensureCache.prepare();var c=0;b&&(c=a._pe.getPointer(b));b=r(f);f=a._pe.ensureFloat64(b);b=z(d,w.PE_MGRS_MAX);var k=a._pe.ensureInt32(b);if(e=a._pe._pe_geog_to_mgrs_extended(c,d,f,e,g,h,k))for(g=0;g<d;g++)l[g]=a._pe.Pointer_stringify(b[g]);return e};b.mgrs_to_geog_extended=function(b,d,e,g,h){a._pe.ensureCache.prepare();var c=0;b&&(c=a._pe.getPointer(b));b=e.map(function(b){return a._pe.ensureString(b)});e=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*
d));g=a._pe._pe_mgrs_to_geog_extended(c,d,e,g,b);return g&&y(h,d,b),g}}(b=a.PeNotationMgrs||(a.PeNotationMgrs={}));!function(b){b.geog_to_usng=function(b,d,e,g,h,l,p){a._pe.ensureCache.prepare();var c=0;b&&(c=a._pe.getPointer(b));b=r(e);e=a._pe.ensureFloat64(b);b=z(d,w.PE_MGRS_MAX);var f=a._pe.ensureInt32(b);if(g=a._pe._pe_geog_to_usng(c,d,e,g,h,l,f))for(h=0;h<d;h++)p[h]=a._pe.Pointer_stringify(b[h]);return g};b.usng_to_geog=function(b,d,e,g){a._pe.ensureCache.prepare();var c=0;b&&(c=a._pe.getPointer(b));
b=e.map(function(b){return a._pe.ensureString(b)});e=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*d));c=a._pe._pe_usng_to_geog(c,d,e,b);return c&&y(g,d,b),c}}(a.PeNotationUsng||(a.PeNotationUsng={}));var h;!function(b){b.init=function(){b.PE_UTM_OPTS_NONE=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NONE;b.PE_UTM_OPTS_ADD_SPACES=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES;b.PE_UTM_OPTS_NS=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NS};b.geog_to_utm=function(b,d,e,g,h){a._pe.ensureCache.prepare();
var c=0;b&&(c=a._pe.getPointer(b));b=r(e);e=a._pe.ensureFloat64(b);b=z(d,w.PE_UTM_MAX);var f=a._pe.ensureInt32(b);if(g=a._pe._pe_geog_to_utm(c,d,e,g,f))for(c=0;c<d;c++)h[c]=a._pe.Pointer_stringify(b[c]);return g};b.utm_to_geog=function(b,d,e,g,h){a._pe.ensureCache.prepare();var c=0;b&&(c=a._pe.getPointer(b));b=e.map(function(b){return a._pe.ensureString(b)});e=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*d));g=a._pe._pe_utm_to_geog(c,d,e,g,b);return g&&y(h,d,b),g}}(h=a.PeNotationUtm||(a.PeNotationUtm=
{}));var e;!function(b){var c=new Map;b.init=function(){b.PE_PCSINFO_OPTION_NONE=a._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE;b.PE_PCSINFO_OPTION_DOMAIN=a._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN;b.PE_POLE_OUTSIDE_BOUNDARY=a._pe.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY;b.PE_POLE_POINT=a._pe.PePCSInfo.prototype.PE_POLE_POINT};b.generate=function(d,e){void 0===e&&(e=b.PE_PCSINFO_OPTION_DOMAIN);var f,g;return c.has(d)&&(g=c.get(d),g[e]&&(f=g[e])),f||(f=a._pe.PePCSInfo.prototype.generate(d,
e),g||(g=[],c.set(d,g)),g[e]=f),f}}(e=a.PePCSInfo||(a.PePCSInfo={}));!function(b){b.version_string=function(){return a._pe.PeVersion.prototype.version_string()}}(a.PeVersion||(a.PeVersion={}));a._init=l})},"esri/core/tsSupport/extendsHelper":function(){define([],function(){return function(){var v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,g){a.__proto__=g}||function(a,g){for(var q in g)g.hasOwnProperty(q)&&(a[q]=g[q])};return function(a,g){function q(){this.constructor=a}v(a,
g);a.prototype=null===g?Object.create(g):(q.prototype=g.prototype,new q)}}()})},"esri/geometry/GeographicTransformation":function(){define(["require","exports","./GeographicTransformationStep"],function(v,a,g){return function(){function a(a){if(this.steps=[],this._cached_projection={},this._chain="",this._gtlistentry=null,a&&a.steps){var l=0;for(a=a.steps;l<a.length;l++){var p=a[l];p instanceof g?this.steps.push(p):this.steps.push(new g({wkid:p.wkid,wkt:p.wkt,isInverse:p.isInverse}))}}}return a.cacheKey=
function(a,g){return[void 0!==a.wkid&&null!==a.wkid?a.wkid.toString():"-1",void 0!==a.wkt&&null!==a.wkt?a.wkt.toString():"",void 0!==g.wkid&&null!==g.wkid?g.wkid.toString():"-1",void 0!==g.wkt&&null!==g.wkt?g.wkt.toString():""].join()},a.fromGE=function(p){var l=new a,q="",v=0;for(p=p.steps;v<p.length;v++){var r=g.fromGE(p[v]);l.steps.push(r);q+=r.uid.toString()+","}return l._cached_projection={},l._gtlistentry=null,l._chain=q,l},a.prototype.getInverse=function(){var g=new a;g.steps=[];for(var l=
this.steps.length-1;0<=l;l--)g.steps.push(this.steps[l].getInverse());return g},a.prototype.getGTListEntry=function(){for(var a="",g=0,q=this.steps;g<q.length;g++)a+=q[g].uid.toString()+",";return a!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=a),this._gtlistentry},a.prototype.assignCachedGe=function(g,l,q){this._cached_projection[a.cacheKey(g,l)]=q},a.prototype.getCachedGeTransformation=function(g,l){for(var p="",q=0,r=this.steps;q<r.length;q++)p+=r[q].uid.toString()+
",";p!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=p);g=this._cached_projection[a.cacheKey(g,l)];return void 0===g?null:g},a}()})},"esri/geometry/GeographicTransformationStep":function(){define(["require","exports"],function(v,a){var g=0;return function(){function a(a){void 0===a&&(a=null);this.uid=g++;a?(this._wkt=void 0!==a.wkt?a.wkt:null,this._wkid=void 0!==a.wkid?a.wkid:-1,this._isInverse=void 0!==a.isInverse&&!0===a.isInverse):(this._wkt=null,this._wkid=-1,this._isInverse=
!1)}return a.fromGE=function(g){var l=new a;return l._wkt=g.wkt,l._wkid=g.wkid,l._isInverse=g.isInverse,l},Object.defineProperty(a.prototype,"wkt",{get:function(){return this._wkt},set:function(a){this._wkt=a;this.uid=g++},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"wkid",{get:function(){return this._wkid},set:function(a){this._wkid=a;this.uid=g++},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"isInverse",{get:function(){return this._isInverse},set:function(a){this._isInverse=
a;this.uid=g++},enumerable:!0,configurable:!0}),a.prototype.getInverse=function(){var g=new a;return g._wkt=this.wkt,g._wkid=this._wkid,g._isInverse=!this.isInverse,g},a}()})},"widgets/eDraw/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings","dojo/text!widgets/eDraw/config.json"],function(){})},"url:widgets/eDraw/Widget.html":'\x3cdiv\x3e\r\n    \x3cdiv class\x3d"menu" data-dojo-attach-point\x3d"menu"\x3e\r\n        \x3cimg title\x3d"${nls.addDrawTitle}" data-dojo-attach-point\x3d"menuAddButton" class\x3d"menu-item-active" src\x3d"${folderUrl}images/add.png" data-dojo-attach-event\x3d"onclick:menuOnClickAdd" /\x3e\r\n        \x3cimg title\x3d"${nls.editDrawTitle}" data-dojo-attach-point\x3d"menuEditButton" class\x3d"menu-item-active hidden" src\x3d"${folderUrl}images/edit.png" /\x3e\r\n        \x3cimg title\x3d"${nls.listDrawTitle}" data-dojo-attach-point\x3d"menuListButton" class\x3d"menu-item" src\x3d"${folderUrl}images/list.png" data-dojo-attach-event\x3d"onclick:menuOnClickList" /\x3e\r\n    \x3c/div\x3e\r\n    \x3cspan class\x3d"hide-box"\x3e\r\n        ${nls.hideOption}\r\n        \x3cinput type\x3d"checkbox" data-dojo-attach-point\x3d"hideCheckbox" data-dojo-attach-event\x3d"onclick:onHideCheckboxClick"/\x3e\r\n  \x3c/span\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"settingAllContent"\x3e\r\n\r\n        \x3cdiv data-dojo-attach-point\x3d"addSection"\x3e\r\n            \x3ch2\x3e${nls.addDrawTitle}\x3c/h2\x3e\r\n\r\n            \x3cdiv class\x3d"bloc"\x3e\r\n                \x3clabel\x3e${nls.selectDrawMode}\x3c/label\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"drawBox" data-dojo-type\x3d"jimu/dijit/DrawBox" data-dojo-props\x3d\'types:["point","polyline","polygon","text"],showClear:false\' style\x3d"margin-top:5px;"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv data-dojo-attach-point\x3d"editorSection"\x3e\r\n            \x3ch2 data-dojo-attach-point\x3d"editorTitle"\x3e${nls.addDrawTitle}\x3c/h2\x3e\r\n            \x3cdiv class\x3d"content"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"fieldsDiv"\x3e\r\n\t\t\t\t\t\x3clabel\x3e${nls.nameField}:\x3c/label\x3e\r\n\t\t\t\t\t\x3cbr /\x3e\r\n\t\t\t\t\t\x3cinput id\x3d"nameField" type\x3d"text" data-dojo-attach-point\x3d"nameField" value\x3d"${nls.nameFieldDefaultValue}" class\x3d"jimu-input" data-dojo-attach-event\x3d"onchange:editorUpdateTextPlus" /\x3e\r\n\t\t\t\t\t\x3cbr /\x3e\r\n\t\t\t\t\t\x3clabel\x3e${nls.descriptionField}:\x3c/label\x3e\r\n\t\t\t\t\t\x3cbr /\x3e\r\n\t\t\t\t\t\x3ctextarea id\x3d"descriptionField" data-dojo-attach-point\x3d"descriptionField" class\x3d"jimu-input" rows\x3d"3"\x3e\x3c/textarea\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cspan class\x3d"is-measure" data-dojo-attach-point\x3d"isMeasureSpan" style\x3d"display:none;"\x3e\x3chr /\x3e${nls.isMeasureMessage}\x3c/span\x3e\r\n                \x3chr /\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"editorSymbolChooserDiv" class\x3d"full-width"\x3e\x3c/div\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"editorSymbolLinePlusNode" style\x3d"width:100%; height:40px;"\x3e\r\n                    \x3cdiv class\x3d"jimu-float-leading" style\x3d"width:40%;height:30px;"\x3e${nls.arrow}\x3c/div\x3e\r\n                    \x3cdiv data-dojo-attach-point\x3d"editorLinePlusArrow" data-dojo-type\x3d"dijit/form/Select" class\x3d"jimu-float-trailing" style\x3d"width:57%;height:30px;"\x3e\r\n                        \x3cspan value\x3d""\x3e${nls.arrowNone}\x3c/span\x3e\r\n                        \x3cspan value\x3d"end"\x3e${nls.arrowEnd}\x3c/span\x3e\r\n                        \x3cspan value\x3d"begin"\x3e${nls.arrowBegin}\x3c/span\x3e\r\n                        \x3cspan value\x3d"begin-end"\x3e${nls.arrowBeginEnd}\x3c/span\x3e\r\n                    \x3c/div\x3e\r\n                \x3c/div\x3e\r\n                \x3ctable class\x3d"symbol-set-table" cellspading\x3d"0" data-dojo-attach-point\x3d"editorSymbolTextPlusNode"\x3e\r\n                    \x3ctbody\x3e\r\n                        \x3ctr class\x3d"draw-plus textFontOptions"\x3e\r\n                            \x3ctd\x3e\r\n                                \x3cspan\x3e${nls.fontName}\x3c/span\x3e\r\n                            \x3c/td\x3e\r\n                            \x3ctd\x3e\r\n                                \x3cdiv data-dojo-attach-point\x3d"editorTextPlusFontFamilyNode" data-dojo-type\x3d"dijit/form/Select" class\x3d"draw-plus font-name"\x3e\r\n                                    \x3cspan value\x3d"Arial"\x3eArial\x3c/span\x3e\r\n                                    \x3cspan value\x3d"Helvetica"\x3eHelvetica\x3c/span\x3e\r\n                                    \x3cspan value\x3d"Times New Roman"\x3eTimes New Roman\x3c/span\x3e\r\n                                    \x3cspan value\x3d"Courier New"\x3eCourier New\x3c/span\x3e\r\n                                \x3c/div\x3e\r\n                                \x3cdiv class\x3d"draw-plus text-options"\x3e\r\n                                    \x3cdiv data-dojo-attach-point\x3d"editorTextPlusBoldNode" title\x3d"${nls.boldTitle}" class\x3d"draw-plus text-option text-bold"\x3e${nls.boldCharacter}\x3c/div\x3e\r\n                                    \x3cdiv data-dojo-attach-point\x3d"editorTextPlusItalicNode" title\x3d"${nls.italicTitle}" class\x3d"draw-plus text-option text-italic"\x3e${nls.italicCharacter}\x3c/div\x3e\r\n                                    \x3cdiv data-dojo-attach-point\x3d"editorTextPlusUnderlineNode" title\x3d"${nls.underlineTitle}" class\x3d"draw-plus text-option text-underline"\x3e${nls.underlineCharacter}\x3c/div\x3e\r\n                                \x3c/div\x3e\r\n                            \x3c/td\x3e\r\n                        \x3c/tr\x3e\r\n                        \x3ctr class\x3d"draw-plus textAngleOptions"\x3e\r\n                            \x3ctd\x3e\r\n                                \x3cspan\x3e${nls.textAngle}\x3c/span\x3e\r\n                            \x3c/td\x3e\r\n                            \x3ctd\x3e\r\n                                \x3cinput data-dojo-attach-point\x3d"editorTextPlusAngleNode" data-dojo-type\x3d"dijit/form/NumberSpinner" data-dojo-props\x3d"value:0,smallDelta:5,constraints:{min:-180,max:180},intermediateChanges:true" class\x3d"draw-plus text-angle"\x3e\x3c/input\x3e\r\n                                \x3cspan data-dojo-attach-point\x3d"editorTextAnglePreviewNode" class\x3d"draw-plus text-angle-sample"\x3e${nls.drawSampleRotatedText}\x3c/span\x3e\r\n                            \x3c/td\x3e\r\n                        \x3c/tr\x3e\r\n                        \x3ctr\x3e\r\n                            \x3ctd\x3e\r\n                                \x3cspan\x3e${nls.textPlacement}\x3c/span\x3e\r\n                            \x3c/td\x3e\r\n                            \x3ctd\x3e\r\n                                \x3cdiv class\x3d"draw-plus text-place"\x3e\r\n                                    \x3cspan data-dojo-attach-point\x3d"editorTextPlusPlacementTopLeft" class\x3d"text-place-top-left" title\x3d"top left"\x3e\u2022\x3c/span\x3e\r\n                                    \x3cspan data-dojo-attach-point\x3d"editorTextPlusPlacementTopCenter" class\x3d"text-place-top-center" title\x3d"top center"\x3e\u2022\x3c/span\x3e\r\n                                    \x3cspan data-dojo-attach-point\x3d"editorTextPlusPlacementTopRight" class\x3d"text-place-top-right" title\x3d"top right"\x3e\u2022\x3c/span\x3e\r\n                                    \x3cspan data-dojo-attach-point\x3d"editorTextPlusPlacementMiddleLeft" class\x3d"text-place-middle-left" title\x3d"middle left"\x3e\u2022\x3c/span\x3e\r\n                                    \x3cspan data-dojo-attach-point\x3d"editorTextPlusPlacementMiddleCenter" class\x3d"text-place-middle-center selected" title\x3d"middle center"\x3e\u2022\x3c/span\x3e\r\n                                    \x3cspan data-dojo-attach-point\x3d"editorTextPlusPlacementMiddleRight" class\x3d"text-place-middle-right" title\x3d"middle right"\x3e\u2022\x3c/span\x3e\r\n                                    \x3cspan data-dojo-attach-point\x3d"editorTextPlusPlacementBottomLeft" class\x3d"text-place-bottom-left" title\x3d"bottom left"\x3e\u2022\x3c/span\x3e\r\n                                    \x3cspan data-dojo-attach-point\x3d"editorTextPlusPlacementBottomCenter" class\x3d"text-place-bottom-center" title\x3d"bottom center"\x3e\u2022\x3c/span\x3e\r\n                                    \x3cspan data-dojo-attach-point\x3d"editorTextPlusPlacementBottomRight" class\x3d"text-place-bottom-right" title\x3d"bottom right"\x3e\u2022\x3c/span\x3e\r\n                                \x3c/div\x3e\r\n                            \x3c/td\x3e\r\n                        \x3c/tr\x3e\r\n                    \x3c/tbody\x3e\r\n                \x3c/table\x3e\r\n\t\t\t\t\x3chr /\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"measureSection" class\x3d"measure-section"\x3e\r\n                    \x3cdiv style\x3d"margin-bottom:7px;"\x3e\r\n                        \x3cinput data-dojo-attach-point\x3d"showMeasure" type\x3d"checkbox" /\x3e\r\n                        \x3clabel data-dojo-attach-point\x3d"showMeasureLabel"\x3e${nls.showMeasurements}\x3c/label\x3e\r\n                    \x3c/div\x3e\r\n                    \x3cdiv data-dojo-attach-point\x3d"areaMeasure" style\x3d"display:none;height:30px;margin-bottom:7px;"\x3e\r\n                        \x3cdiv class\x3d"area-units-tip  jimu-float-leading"\x3e${nls.areaUnits}\x3c/div\x3e\r\n                        \x3cselect data-dojo-attach-point\x3d"areaUnitSelect" data-dojo-type\x3d"dijit/form/Select" class\x3d" jimu-float-trailing" style\x3d"width:50%;height:30px;"\x3e\x3c/select\x3e\r\n                    \x3c/div\x3e\r\n                    \x3cdiv data-dojo-attach-point\x3d"distanceMeasure" style\x3d"display:none;height:30px;"\x3e\r\n                        \x3cdiv class\x3d"distance-units-tip jimu-float-leading"\x3e${nls.distanceUnits}\x3c/div\x3e\r\n                        \x3cselect data-dojo-attach-point\x3d"distanceUnitSelect" data-dojo-type\x3d"dijit/form/Select" class\x3d" jimu-float-trailing" style\x3d"width:50%;height:30px;"\x3e\x3c/select\x3e\r\n                    \x3c/div\x3e\r\n                    \x3cdiv data-dojo-attach-point\x3d"pointMeasure" style\x3d"display:none;height:30px;"\x3e\r\n                        \x3cdiv class\x3d"distance-units-tip jimu-float-leading"\x3e${nls.pointUnits}\x3c/div\x3e\r\n                        \x3cselect data-dojo-attach-point\x3d"pointUnitSelect" data-dojo-type\x3d"dijit/form/Select" class\x3d" jimu-float-trailing" style\x3d"width:50%;height:30px;"\x3e\r\n                            \x3coption value\x3d"map"\x3e${nls.unitMap}\x3c/option\x3e\r\n                            \x3coption value\x3d"DMS"\x3e${nls.unitDMS}\x3c/option\x3e\r\n                            \x3coption value\x3d"DD"\x3e${nls.unitDD}\x3c/option\x3e\r\n                        \x3c/select\x3e\r\n                    \x3c/div\x3e\r\n                \x3c/div\x3e\r\n                \x3chr /\x3e\r\n                \x3cp class\x3d"editor-add-message" data-dojo-attach-point\x3d"editorAddMessage" style\x3d"display:none;"\x3e${nls.addMessage}.\x3c/p\x3e\r\n                \x3cp class\x3d"editor-add-message" data-dojo-attach-point\x3d"editorEditMessage" style\x3d"display:none;"\x3e${nls.editMessage}.\x3c/p\x3e\r\n                \x3cp class\x3d"editor-add-message" data-dojo-attach-point\x3d"editorSnappingMessage"\x3e${nls.snappingMessage}.\x3c/p\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"footer"\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"editorFooterEdit"\x3e\r\n                    \x3cinput type\x3d"button" class\x3d"jimu-input blue-button" value\x3d"${nls.saveButton}" data-dojo-attach-event\x3d"onclick:editorOnClickEditSaveButon" /\x3e\r\n                    \x3cinput type\x3d"button" class\x3d"jimu-input red-button" value\x3d"${nls.cancelButton}" data-dojo-attach-event\x3d"onclick:editorOnClickEditCancelButon" /\x3e\r\n                    \x3cinput type\x3d"button" class\x3d"jimu-input grey-button" value\x3d"${nls.resetButton}" data-dojo-attach-event\x3d"onclick:editorOnClickResetCancelButon" /\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"editorFooterAdd" style\x3d"display:none;"\x3e\r\n                    \x3cinput type\x3d"button" class\x3d"jimu-input red-button" value\x3d"${nls.cancelButton}" data-dojo-attach-event\x3d"onclick:editorOnClickAddCancelButon" /\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv data-dojo-attach-point\x3d"listSection"\x3e\r\n            \x3ch2\x3e${nls.listDrawTitle}\x3c/h2\x3e\r\n            \x3cdiv class\x3d"content"\x3e\r\n                \x3ctable class\x3d"jimu-table draw-table"\x3e\r\n                    \x3cthead\x3e\r\n                        \x3ctr\x3e\r\n                            \x3cth\x3e\x3cinput type\x3d"checkbox" data-dojo-attach-event\x3d"onclick:listUpdateAllCheckbox" data-dojo-attach-point\x3d"listCheckboxAll" /\x3e\x3c/th\x3e\r\n                            \x3cth\x3e${nls.nameField}\x3c/th\x3e\r\n                            \x3cth\x3e${nls.symbolField}\x3c/th\x3e\r\n                            \x3cth data-dojo-attach-point\x3d"tableTH"\x3e\x3c/th\x3e\r\n                        \x3c/tr\x3e\r\n                    \x3c/thead\x3e\r\n                    \x3ctbody data-dojo-attach-point\x3d"drawsTableBody"\x3e\x3c/tbody\x3e\r\n                \x3c/table\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"footer"\x3e\r\n                \x3cdiv\x3e\r\n                    \x3cdiv style\x3d"width: calc(100% - 35px);" class\x3d"list-draw-actions" data-dojo-attach-point\x3d"allActionsNode"\x3e\r\n                        \x3c!--\x3cspan class\x3d"text"\x3e${nls.all} :\x3c/span\x3e--\x3e\r\n                        \x3cspan class\x3d"text"\x3e\x3cinput type\x3d"checkbox" data-dojo-attach-event\x3d"onclick:listUpdateAllCheckbox" data-dojo-attach-point\x3d"listCheckboxAll2" /\x3e\x3c/span\x3e\r\n                        \x3cspan title\x3d"${nls.zoomAllLabel}" class\x3d"zoom blue-button" data-dojo-attach-event\x3d"onclick:zoomAll"\x3e\x26nbsp;\x3c/span\x3e\r\n                        \x3cspan title\x3d"${nls.copyLabel}" class\x3d"copy blue-button" data-dojo-attach-event\x3d"onclick:copy"\x3e\x26nbsp;\x3c/span\x3e\r\n                        \x3cspan title\x3d"${nls.deleteAllLabel}" class\x3d"clear red-button" data-dojo-attach-event\x3d"onclick:clear"\x3e\x26nbsp;\x3c/span\x3e\r\n                        \x3cspan title\x3d"${nls.exportLabel}" class\x3d"export blue-button" data-dojo-attach-event\x3d"onclick:exportSelectionInFile"\x3e\x26nbsp;\x3c/span\x3e\r\n                    \x3c/div\x3e\r\n\t\t\t\t\t\x3cspan title\x3d"${nls.importTitle}" class\x3d"import-button blue-button" data-dojo-attach-event\x3d"onclick:launchImportFile"\x3e\x26nbsp;\x3c/span\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/eDraw/css/style.css":'.jimu-widget-edraw {font-size: 14px; height: 100%; min-height: 192px; min-width: 270px; width: 100%; color: black; background-color: white;}.jimu-widget-edraw .full-width {width: 100% !important;}.jimu-widget-edraw .editor-add-message {margin-top: 10px; font-style: italic;}.jimu-widget-edraw .measure-section {margin-top: 12px; width: 100%; margin-bottom: 12px; padding-right: 3px; padding-bottom: 10px;}.jimu-widget-edraw .area-units-tip {height: 30px; line-height: 30px; padding-left: 17px;}.jimu-rtl .jimu-widget-edraw .area-units-tip {padding-left: 0; padding-right: 17px;}.jimu-widget-edraw .distance-units-tip {height: 30px; line-height: 30px; padding-left: 17px;}.jimu-rtl .jimu-widget-edraw .distance-units-tip {padding-left: 0; padding-right: 17px;}.jimu-widget-edraw .dijitArrowButtonContainer {width: 40px;}.jimu-widget-edraw .dijitSelect {height: 40px; width: 100%;}.jimu-widget-edraw .dijitReset.dijitLeft.dijitButtonNode.dijitArrowButton.dijitDownArrowButton {width: 100%;}.jimu-widget-edraw .dijitReset.dijitLeft.dijitButtonNode.dijitArrowButton.dijitUpArrowButton {width: 100%;}.jimu-widget-edraw .dijitReset.dijitLeft.dijitButtonNode.dijitArrowButton.dijitDownArrowButton .dijitArrowButtonInner {width: 100%;}.jimu-widget-edraw .dijitReset.dijitLeft.dijitButtonNode.dijitArrowButton.dijitUpArrowButton .dijitArrowButtonInner {width: 100%;}.jimu-widget-edraw .menu {border-bottom: 2px solid rgb(72, 85, 102); height: 36px; margin-bottom: 10px; width: 100%;}.jimu-widget-edraw .menu-item {background-color: rgba(72, 85, 102, 0.4); border: 1px solid rgba(72, 85, 102, 0.8); float: left; margin-right: 5px; width: 36px;}.jimu-widget-edraw .menu-item:hover {background-color: rgba(72, 85, 102, 0.6); cursor: pointer;}.jimu-widget-edraw .menu-item-active {-moz-border-bottom-colors: none; -moz-border-left-colors: none; -moz-border-right-colors: none; -moz-border-top-colors: none; background-color: rgba(72, 85, 102, 0.8); border-color: rgba(72, 85, 102, 0.8) rgba(72, 85, 102, 0.8) -moz-use-text-color; border-image: none; border-radius: 3px 3px 0 0; border-style: solid solid none; border-width: 2px 2px medium; float: left; margin-right: 5px; width: 36px;}.jimu-widget-edraw .menu-item-active:hover {} .jimu-widget-edraw .hide-box {float: right; position: absolute; right: 0; top: 0px; font-size: 1.1em;}.jimu-widget-edraw .hidden {display: none;}.jimu-widget-edraw .draw-table{display: inline-block;}.jimu-widget-edraw .draw-table td, .jimu-widget-edraw .draw-table th{padding:5px;}.jimu-widget-edraw .draw-table tr {border: 1px solid white; cursor:move;}.jimu-widget-edraw .draw-table th {background-color: #8d989e; font-weight: bold201px; text-align: center; cursor:auto;}.jimu-widget-edraw .draw-table tr:hover th {background-color: #8d989e;}.jimu-widget-edraw .draw-table .td-center {text-align: center;}.jimu-widget-edraw .draw-table .td-checkbox {width:30px;}.jimu-widget-edraw .draw-table .selected td {background-color: rgba(15, 108, 159, 0.2);}.jimu-widget-edraw .draw-table .selected:hover td {background-color: rgba(15, 108, 159, 0.3);}.jimu-widget-edraw .list-draw-actions {height: 100%; vertical-align: middle; width: 192px;}.jimu-widget-edraw .light {width: 120px !important;}.jimu-widget-edraw .list-draw-actions span {border-radius: 5px; color: white; display: block; float: left; font-size: 1.5em; font-weight: bold; height: 30px; margin: 4px 0px 4px 2px; min-height: 30px; text-align: center; vertical-align: middle; width: 30px;}.jimu-widget-edraw .list-draw-actions span.text {background: none repeat scroll 0 0 rgba(0, 0, 0, 0); color: black; font-size: 1em; position: relative; width: auto;}.jimu-widget-edraw .list-draw-actions span.text input {margin-top:10px;}.jimu-widget-edraw .list-draw-actions span.text:hover {border: medium none; cursor: auto; font-size: 1em;}.jimu-widget-edraw .list-draw-actions span.clear {background-image: url("images/clear.png");}.jimu-widget-edraw .list-draw-actions span.edit {background-image: url("images/edit.png");}.jimu-widget-edraw .list-draw-actions span.copy {background-image: url("images/copy.png");}.jimu-widget-edraw .list-draw-actions span.zoom {background-image: url("images/zoom.png");}.jimu-widget-edraw .list-draw-actions span.up {background-image: url("images/up.png");}.jimu-widget-edraw .list-draw-actions span.down {background-image: url("images/down.png");}.jimu-widget-edraw .list-draw-actions span.export {background-image: url("images/download.png");}.jimu-widget-edraw .list-draw-actions span.import {background-image: url("images/upload.png");}.jimu-widget-edraw .list-draw-actions span:hover {border: 1px solid rgb(72, 85, 102); cursor: pointer;}.jimu-widget-edraw .title {margin-left: 5px; margin-top: 5px;}.message-info-icon {background-image: url("images/info.png"); float: left; height: 48px; width: 48px;}.message-error-icon {background-image: url("images/error.png"); float: left; height: 48px; width: 48px;}.message-warning-icon {background-image: url("images/warning.png"); float: left; height: 48px; width: 48px;}.jimu-widget-edraw p.no {display: none;}.jimu-widget-edraw p.info {background-color: lightblue; border-radius: 3px; padding: 3px; width: 100%;}.jimu-widget-edraw p.error {border-radius: 3px; padding: 3px; width: 100%;}.jimu-widget-edraw p.warning {background-color: orange; border-radius: 3px; padding: 3px; width: 100%;}.jimu-widget-edraw h2 {margin-bottom: 0; margin-top: 2px;}.jimu-widget-edraw .draw-import {height: 50px; width: 100%;}.jimu-widget-edraw .import-button{border-radius: 5px; color: #FFF; display: block; float: right; font-size: 1.5em; font-weight: bold; height: 30px; min-height: 30px; text-align: center; vertical-align: middle; width: 30px; background-image: url("images/upload.png"); margin-top: 4px;}.jimu-widget-edraw .import-button:hover{cursor:pointer; border:0.5px solid black;}.jimu-widget-edraw .draw-import .file {background-color: rgba(255, 255, 255, 0.5); border-radius: 5px; cursor: pointer; float: left; padding: 5px;}.jimu-widget-edraw .draw-import \x3e a {float: left; height: 36px; width: 36px;}.jimu-widget-edraw #nameField {width: 100%;}.jimu-widget-edraw #descriptionField {min-height: 60px; width: 100%;}.jimu-widget-edraw label {font-weight: bold;}.jimu-widget-edraw .content {background-color: rgba(78, 130, 138, 0.1); height: calc(100% - 100px); overflow-x: hidden; overflow-y: auto; position: absolute; width: calc(100%);}.jimu-widget-edraw .bloc {background-color: rgba(78, 130, 138, 0.1);}.jimu-widget-edraw .content hr {color: rgba(78, 130, 138, 0.6);}.jimu-widget-edraw .footer {bottom: 0; position: absolute; width: 100%;}.jimu-widget-edraw .footer .jimu-input {border-radius: 5px; color: black;}.jimu-widget-edraw .footer .jimu-input:hover {cursor: pointer;}.jimu-widget-edraw .blue-button {background-color: rgba(115, 185, 255, 0.7);}.jimu-widget-edraw .blue-button:hover {background-color: rgba(115, 185, 255, 1);}.jimu-widget-edraw .red-button {background-color: rgba(255, 150, 115, 0.7);}.jimu-widget-edraw .red-button:hover {background-color: rgba(255, 150, 115, 1);}.jimu-widget-edraw .grey-button {background-color: rgba(153, 153, 153, 0.7);}.jimu-widget-edraw .grey-button:hover {background-color: rgba(153, 153, 153, 1);}.jimu-widget-edraw .symbol-set-table {width: 100%;}.jimu-widget-edraw div.symbol-section.text-symbol-section \x3e table \x3e colgroup \x3e col:nth-child(1) {width: 80px;}.jimu-widget-edraw .draw-plus.font-name {width: 145px; height: 30px; float: left;}.jimu-widget-edraw .draw-plus.text-angle {width: 50%;}.jimu-widget-edraw .draw-plus.text-angle-sample {position: absolute; margin-left: 30px; margin-top: 7px;}.jimu-widget-edraw .draw-plus.text-options {float: left; padding: 4px; height: 30px;}.jimu-widget-edraw .draw-plus.text-option {width: 22px; height: 22px; line-height: 22px; text-align: center; float: left; border-style: solid; border-width: 1px; border-color: #808080; margin-left: 5px; font-family: serif; font-size: 14px; font-weight: bold; display: table;}.jimu-widget-edraw .draw-plus.text-option.selected {background-color: #C0C0C0; border-width: 2px; border-radius: 2px;}.jimu-widget-edraw .draw-plus.text-option:hover {background-color: #D1D1D1; cursor: pointer;}.jimu-widget-edraw .draw-plus.text-options div.draw-plus.text-option.text-italic {font-style: italic;}.jimu-widget-edraw .draw-plus.text-options div.draw-plus.text-option.text-underline {text-decoration: underline;}.jimu-widget-edraw .draw-plus.text-place {position: relative; width: 80px; height: 80px; border-radius: 5px; border: 1px solid lightgrey;}.jimu-widget-edraw .draw-plus.text-place span {position: absolute; width: 20px; height: 20px; border-radius: 3px; border: 1px solid grey; background-color: #E4E4E4; line-height: 50%;}.jimu-widget-edraw .draw-plus.text-place span.selected {background-color: #C0C0C0;}.jimu-widget-edraw .draw-plus.text-place span:hover {background-color: #C8C8E4; cursor: pointer;}.jimu-widget-edraw .draw-plus.text-place span.selected:hover {background-color: #B3B3D9;}.jimu-widget-edraw .draw-plus.text-place .text-place-top-left {top: 55px; left: 55px; text-align: left; vertical-align: top;}.jimu-widget-edraw .draw-plus.text-place .text-place-top-center {top: 55px; left: 30px; text-align: center; vertical-align: top;}.jimu-widget-edraw .draw-plus.text-place .text-place-top-right {top: 55px; left: 5px; text-align: right; vertical-align: top;}.jimu-widget-edraw .draw-plus.text-place .text-place-middle-left {top: 30px; left: 55px; text-align: left; line-height: 100%;}.jimu-widget-edraw .draw-plus.text-place .text-place-middle-center {top: 30px; left: 30px; text-align: center; line-height: 100%;}.jimu-widget-edraw .draw-plus.text-place .text-place-middle-right {top: 30px; left: 5px; text-align: right; line-height: 100%;}.jimu-widget-edraw .draw-plus.text-place .text-place-bottom-left {top: 5px; left: 55px; text-align: left; padding-top: 10px;}.jimu-widget-edraw .draw-plus.text-place .text-place-bottom-center {top: 5px; left: 30px; text-align: center; padding-top: 10px;}.jimu-widget-edraw .draw-plus.text-place .text-place-bottom-right {top: 5px; left: 5px; text-align: right; padding-top: 10px;}.eDraw-import-message{height:100%; width:100%; min-height:150px; border-radius:10px; padding:10px; border:1px solid black;}.eDraw-import-message .eDraw-import-draganddrop-message{display:none;}.eDraw-import-message:hover{background-color:#E2E2E2;}.eDraw-import-message:hover .eDraw-import-draganddrop-message{display:block;}',
"url:widgets/eDraw/config.json":'{\r\n\t"exportFileName" : "myDrawing.json",\r\n\t"confirmOnDelete" : true,\r\n\t"allowLocalStorage" : true,\r\n\t"localStorageKey" : false,\r\n\t"drawPlus" : {\r\n\t\t"fontFamilies" : [{\r\n\t\t\t\t"label" : "Arial",\r\n\t\t\t\t"value" : "Arial"\r\n\t\t\t}, {\r\n\t\t\t\t"label" : "Helvetica",\r\n\t\t\t\t"value" : "Helvetica"\r\n\t\t\t}, {\r\n\t\t\t\t"label" : "Times New Roman",\r\n\t\t\t\t"value" : "Times New Roman"\r\n\t\t\t}, {\r\n\t\t\t\t"label" : "Courier New",\r\n\t\t\t\t"value" : "Courier New"\r\n\t\t\t}\r\n\t\t]\r\n\t},\r\n\t"distanceUnits" : [{\r\n\t\t\t"unit" : "KILOMETERS",\r\n\t\t\t"abbr" : "km"\r\n\t\t}, {\r\n\t\t\t"unit" : "MILES",\r\n\t\t\t"abbr" : "mi"\r\n\t\t}, {\r\n\t\t\t"unit" : "METERS",\r\n\t\t\t"abbr" : "m"\r\n\t\t}, {\r\n\t\t\t"unit" : "NAUTICAL_MILES",\r\n\t\t\t"abbr" : "nm"\r\n\t\t}, {\r\n\t\t\t"unit" : "FEET",\r\n\t\t\t"abbr" : "ft"\r\n\t\t}, {\r\n\t\t\t"unit" : "YARDS",\r\n\t\t\t"abbr" : "yd"\r\n\t\t}\r\n\t],\r\n\t"areaUnits" : [{\r\n\t\t\t"unit" : "SQUARE_KILOMETERS",\r\n\t\t\t"abbr" : "sq km"\r\n\t\t}, {\r\n\t\t\t"unit" : "SQUARE_MILES",\r\n\t\t\t"abbr" : "sq mi"\r\n\t\t}, {\r\n\t\t\t"unit" : "ACRES",\r\n\t\t\t"abbr" : "ac"\r\n\t\t}, {\r\n\t\t\t"unit" : "HECTARES",\r\n\t\t\t"abbr" : "ha"\r\n\t\t}, {\r\n\t\t\t"unit" : "SQUARE_METERS",\r\n\t\t\t"abbr" : "sq m"\r\n\t\t}, {\r\n\t\t\t"unit" : "SQUARE_FEET",\r\n\t\t\t"abbr" : "sq ft"\r\n\t\t}, {\r\n\t\t\t"unit" : "SQUARE_YARDS",\r\n\t\t\t"abbr" : "sq yd"\r\n\t\t}\r\n\t],\r\n\t"useGeometryEngine":false,\r\n\t"geometryService":"//tasks.arcgisonline.com/ArcGIS/rest/services/Geometry/GeometryServer",\r\n\t"measureEnabledByDefault" : true,\r\n\t"measurePolygonLabel" : "{{area}} {{areaUnit}}    {{length}} {{lengthUnit}}",\r\n\t"measurePolylineLabel" : "{{length}} {{lengthUnit}}",\r\n\t"defaultSymbols":{\r\n\t\t"SimpleMarkerSymbol":{"color":[255,199,198,148],"size":15,"angle":0,"xoffset":0,"yoffset":0,"type":"esriSMS","style":"esriSMSCircle","outline":{"color":[207,101,99,255],"width":0.75,"type":"esriSLS","style":"esriSLSSolid"}},\r\n\t\t"SimpleLineSymbol": {"color":[207,101,99,255],"width":1.5,"type":"esriSLS","style":"esriSLSSolid"},\r\n\t\t"SimpleFillSymbol": {"color":[255,199,198,148],"outline":{"color":[207,101,99,255],"width":0.75,"type":"esriSLS","style":"esriSLSSolid"},"type":"esriSFS","style":"esriSFSSolid"},\r\n\t\t"TextSymbol":false\r\n\t}\r\n}\r\n',
"*now":function(v){v(['dojo/i18n!*preload*widgets/eDraw/nls/Widget*["","ROOT"]'])}}});
define("dojo/_base/declare dijit/_WidgetsInTemplateMixin jimu/BaseWidget dojo/Deferred dojo/aspect dojo/_base/lang dojo/on dojo/_base/html dojo/sniff dojo/_base/Color dojo/_base/array dojo/dom-construct dojo/dom dijit/form/Select dijit/form/NumberSpinner libs/storejs/store esri/config esri/InfoTemplate esri/graphic esri/graphicsUtils esri/layers/GraphicsLayer esri/toolbars/edit esri/units esri/SpatialReference esri/geometry/Polyline esri/geometry/Polygon esri/geometry/geometryEngine esri/geometry/projection esri/symbols/SimpleMarkerSymbol esri/symbols/SimpleLineSymbol esri/symbols/SimpleFillSymbol esri/symbols/TextSymbol esri/symbols/Font jimu/exportUtils jimu/dijit/ViewStack jimu/dijit/SymbolChooser jimu/dijit/DrawBox jimu/dijit/Message jimu/utils jimu/symbolUtils".split(" "),function(v,
a,g,q,p,l,u,z,r,y,x,w,n,b,h,e,d,c,k,f,t,m,B,C,E,P,D,I,J,M,N,O,G,K,Q,R,U,H,L,S){return v([g,a],{name:"eDraw",baseClass:"jimu-widget-edraw",setMode:function(a){this.editorEnableMapPreview(!1);this.editorActivateGeometryEdit(!1);this.allowPopup(!1);switch(a){case "add1":this.setMenuState("add");this._editorConfig.graphicCurrent=!1;this.TabViewStack.switchView(this.addSection);this.drawBox.deactivate();this.setInfoWindow(!1);this.allowPopup(!1);break;case "add2":this.setMenuState("add",["add"]);this._editorConfig.graphicCurrent=
!1;this.editorPrepareForAdd(this._editorConfig.defaultSymbols[this._editorConfig.commontype]);this.TabViewStack.switchView(this.editorSection);this.setInfoWindow(!1);this.allowPopup(!1);break;case "edit":this.setMenuState("edit",["edit"]);this._editorConfig.graphicCurrent&&(this.editorPrepareForEdit(this._editorConfig.graphicCurrent),a=f.graphicsExtent([this._editorConfig.graphicCurrent]),this.map.setExtent(a.expand(2),!0));this.TabViewStack.switchView(this.editorSection);this.setInfoWindow(!1);break;
case "list":this.setMenuState("list"),this.allowPopup(!0),this.listGenerateDrawTable(),a=this.drawBox.drawLayer.graphics.length,z.setStyle(this.allActionsNode,"display",0<a?"block":"none"),this.tableTH.innerHTML=a+" "+this.nls.draws,this._editorConfig.graphicCurrent=!1,this.TabViewStack.switchView(this.listSection)}},showMessage:function(a,b){var A="message-info-icon";switch(b){case "error":A="message-error-icon";break;case "warning":A="message-warning-icon"}new H({message:'\x3ci class\x3d"'+A+'"\x3e\x26nbsp;\x3c/i\x3e'+
a})},setMenuState:function(a,b){b?0>b.indexOf(a)&&b.push(a):b=["add","list"];for(var A in this._menuButtons){var c=A==a?"menu-item-active":"menu-item";0>b.indexOf(A)&&(c="hidden");this._menuButtons[A]&&(this._menuButtons[A].className=c)}},setInfoWindow:function(a){if(!this.map.infoWindow)return!1;if(!a)return this.map.infoWindow.hide(),!0;if(a.geometry.x)var b=a.geometry;else if(a.geometry.getCenter)b=a.geometry.getCenter();else if(a.geometry.getExtent)b=a.geometry.getExtent().getCenter();else return!1;
this.map.infoWindow.setFeatures([a]);this.map.infoWindow.show(b)},_clickHandler:!1,allowPopup:function(a){this.map.setInfoWindowOnClick(a);!a&&this._clickHandler?dojo.disconnect(this._clickHandler):this._clickHandler=this.drawBox.drawLayer.on("click",this._onDrawClick)},saveInLocalStorage:function(){this.config.allowLocalStorage&&e.set(this._localStorageKey,this.drawingsGetJson())},getCheckedGraphics:function(a){for(var b=[],A=0,c=this.drawBox.drawLayer.graphics.length;A<c;A++)this.drawBox.drawLayer.graphics[A].checked&&
b.push(this.drawBox.drawLayer.graphics[A]);return a&&0==b.length?this.drawBox.drawLayer.graphics:b},zoomAll:function(){var a=this.getCheckedGraphics(!0);if(!(1>a.length))return a=f.graphicsExtent(a),this.map.setExtent(a,!0),!0},copy:function(){var a=this.getCheckedGraphics(!1),b=a.length;if(0==b)return this.showMessage(this.nls.noSelection,"error"),!1;for(var c=0;c<b;c++){var d=new k(a[c].toJson());d.attributes.name+=this.nls.copySuffix;this.drawBox.drawLayer.add(d);a[c].measure&&a[c].measure.graphic&&
this.addMeasure(d.geometry,d)}this.setMode("list")},clear:function(){var a=this.getCheckedGraphics(!1);if(0==a.length)return this.showMessage(this.nls.noSelection,"error"),!1;this.config.confirmOnDelete?this._confirmDeleteMessage=new H({message:'\x3ci class\x3d"message-warning-icon"\x3e\x3c/i\x3e\x26nbsp;'+this.nls.confirmDrawCheckedDelete,buttons:[{label:this.nls.yes,onClick:this._removeGraphics},{label:this.nls.no}]}):this._removeGraphics(a)},_removeClickedGraphic:function(){if(!this._clickedGraphic)return!1;
this._removeGraphic(this._clickedGraphic);this._editorConfig.graphicCurrent=!1;this.listGenerateDrawTable();this._clickedGraphic=!1;this._confirmDeleteMessage&&this._confirmDeleteMessage.close&&(this._confirmDeleteMessage.close(),this._confirmDeleteMessage=!1)},_removeGraphics:function(a){a=a.target?this.getCheckedGraphics(!1):a;for(var b=a.length,c=0;c<b;c++)this._removeGraphic(a[c]);this._confirmDeleteMessage&&this._confirmDeleteMessage.close&&(this._confirmDeleteMessage.close(),this._confirmDeleteMessage=
!1);this.setInfoWindow(!1);0<this.drawBox.drawLayer.graphics.length?this.setMode("list"):this.setMode("add1")},_removeGraphic:function(a){a.measure&&a.measure.graphic?this.drawBox.drawLayer.remove(a.measure.graphic):a.measureParent&&(a.measureParent.measure=!1);this.drawBox.drawLayer.remove(a)},drawingsGetJson:function(a,b){b=b?this.getCheckedGraphics(!1):this.drawBox.drawLayer.graphics;var c=b.length;if(1>c)return a?"":!1;for(var d={features:[],displayFieldName:"",fieldAliases:{},spatialReference:this.map.spatialReference.toJson(),
fields:[]},A=[],e=0,f=0;f<c;f++){var g=b[f];if(g){var F=g.toJson();g.measure&&g.measure.graphic&&A.push(e);d.features.push(F);e++}}c=0;for(e=A.length;c<e;c++)for(f=A[c],g=0,F=b.length;g<F;g++)if(b[g]==b[f].measure.graphic){d.features[f].measure={areaUnit:b[f].measure.areaUnit,lengthUnit:b[f].measure.lengthUnit,graphic:g};break}a&&(d=JSON.stringify(d));return d},menuOnClickAdd:function(){this.setMode("add1")},menuOnClickList:function(){this.setMode("list")},onHideCheckboxClick:function(){var a=this.hideCheckbox.checked?
"none":"block";this.drawBox.drawLayer.setVisibility(!this.hideCheckbox.checked);this.menu.style.display=a;this.settingAllContent.style.display=a;if(this.hideCheckbox.checked)this.onClose();else this.onOpen()},listGenerateDrawTable:function(){var a=this.drawBox.drawLayer.graphics,b=a.length;this.drawsTableBody.innerHTML="";for(var c=this.config.listShowUpAndDownButtons?8:16,b=b-1;0<=b;b--){var d=a[b],e=d.symbol,f=this._editorConfig.graphicCurrent&&this._editorConfig.graphicCurrent==d;if("textsymbol"==
e.type)var e=e.toJson(),g=4<e.text.length?e.text.substr(0,4)+"...":e.text,k=14>e.font.size?"font-size:"+e.font.size+"px;":"font-size:14px; font-weight:bold;",e='\x3cspan style\x3d"color:'+("rgba("+e.color.join(",")+")")+";"+k+'"\x3e'+g+"\x3c/span\x3e";else e=S.createSymbolNode(e,{width:50,height:50}).innerHTML;var g=d.attributes&&d.attributes.name?d.attributes.name:"",g=g.length>c?'\x3cspan title\x3d"'+g.replace('"',"\x26#34;")+'"\x3e'+g.substr(0,c)+"...\x3c/span\x3e":g,k='\x3cspan class\x3d"edit blue-button" id\x3d"draw-action-edit--'+
b+'" title\x3d"'+this.nls.editLabel+'"\x3e\x26nbsp;\x3c/span\x3e\x3cspan class\x3d"clear red-button" id\x3d"draw-action-delete--'+b+'" title\x3d"'+this.nls.deleteLabel+'"\x3e\x26nbsp;\x3c/span\x3e',h="list-draw-actions light";this.config.listShowUpAndDownButtons&&(k+='\x3cspan class\x3d"up grey-button" id\x3d"draw-action-up--'+b+'" title\x3d"'+this.nls.upLabel+'"\x3e\x26nbsp;\x3c/span\x3e\x3cspan class\x3d"down grey-button" id\x3d"draw-action-down--'+b+'" title\x3d"'+this.nls.downLabel+'"\x3e\x26nbsp;\x3c/span\x3e',
h="list-draw-actions");k+='\x3cspan class\x3d"zoom grey-button" id\x3d"draw-action-zoom--'+b+'" title\x3d"'+this.nls.zoomLabel+'"\x3e\x26nbsp;\x3c/span\x3e';d=w.create("tr",{id:"draw-tr--"+b,innerHTML:'\x3ctd\x3e\x3cinput type\x3d"checkbox" class\x3d"td-checkbox" id\x3d"draw-action-checkclick--'+b+'" '+(d.checked?' checked\x3d"checked"':"")+"/\x3e\x3c/td\x3e\x3ctd\x3e"+g+'\x3c/td\x3e\x3ctd class\x3d"td-center" id\x3d"draw-symbol--'+b+'"\x3e'+e+'\x3c/td\x3e\x3ctd class\x3d"'+h+'"\x3e'+k+"\x3c/td\x3e",
className:f?"selected":"",draggable:"true"},this.drawsTableBody);u(n.byId("draw-action-edit--"+b),"click",this.listOnActionClick);u(n.byId("draw-action-delete--"+b),"click",this.listOnActionClick);u(n.byId("draw-action-zoom--"+b),"click",this.listOnActionClick);this.config.listShowUpAndDownButtons&&(u(n.byId("draw-action-up--"+b),"click",this.listOnActionClick),u(n.byId("draw-action-down--"+b),"click",this.listOnActionClick));u(n.byId("draw-action-checkclick--"+b),"click",this.listOnActionClick);
u(d,"dragstart",this._listOnDragStart)}this.saveInLocalStorage();this.listUpdateAllCheckbox()},_listOnDrop:function(a){a.preventDefault();var b=a.dataTransfer.getData("edraw-list-tr-id");a=this._UTIL__getParentByTag(a.target?a.target:a.originalTarget,"tr");if(!a||a.id==b)return!1;b=b.split("--")[b.split("--").length-1];a=a.id.split("--")[a.id.split("--").length-1];this.moveDrawingGraphic(b,a);this.listGenerateDrawTable()},_listOnDragOver:function(a){a.preventDefault()},_listOnDragStart:function(a){a.dataTransfer.setData("edraw-list-tr-id",
a.target.id)},switch2DrawingGraphics:function(a,b){var c=this.drawBox.drawLayer.graphics[a],d=this.drawBox.drawLayer.graphics[b];if(!c||!d)return!1;this.drawBox.drawLayer.graphics[a]=d;this.drawBox.drawLayer.graphics[b]=c;this._redrawGraphics(a<b?a:b);return!0},moveDrawingGraphic:function(a,b){a=parseInt(a);b=parseInt(b);if(a!=b){var c=this.drawBox.drawLayer.graphics[a];if(a<b)for(var d=a,A=this.drawBox.drawLayer.graphics.length;d<b&&d<A;d++)this.drawBox.drawLayer.graphics[d]=this.drawBox.drawLayer.graphics[d+
1];else for(d=a,A=this.drawBox.drawLayer.graphics.length;d>b&&0<d;d--)this.drawBox.drawLayer.graphics[d]=this.drawBox.drawLayer.graphics[d-1];this.drawBox.drawLayer.graphics[b]=c;this._redrawGraphics(a<b?a:b);return!0}},_redrawGraphics:function(a){a||(a=0);for(var b=this.drawBox.drawLayer.graphics.length,c=0;c<b;c++)if(c>=a){var d=this.drawBox.drawLayer.graphics[c].getShape();d&&d.moveToFront()}},listUpdateAllCheckbox:function(a){if(void 0===a){var b=!0,c=!0;a=0;for(var d=this.drawBox.drawLayer.graphics.length;a<
d;a++)this.drawBox.drawLayer.graphics[a].checked?c=!1:b=!1;b?(this.listCheckboxAll.checked=!0,this.listCheckboxAll.indeterminate=!1,this.listCheckboxAll2.checked=!0,this.listCheckboxAll2.indeterminate=!1):c?(this.listCheckboxAll.checked=!1,this.listCheckboxAll.indeterminate=!1,this.listCheckboxAll2.checked=!1,this.listCheckboxAll2.indeterminate=!1):(this.listCheckboxAll.checked=!0,this.listCheckboxAll.indeterminate=!0,this.listCheckboxAll2.checked=!0,this.listCheckboxAll2.indeterminate=!0)}else{b=
a.target.checked;a=0;for(d=this.drawBox.drawLayer.graphics.length;a<d;a++)this.drawBox.drawLayer.graphics[a].checked=b,n.byId("draw-action-checkclick--"+a).checked=b;this.listCheckboxAll.checked=b;this.listCheckboxAll.indeterminate=!1;this.listCheckboxAll2.checked=b;this.listCheckboxAll2.indeterminate=!1}},listOnActionClick:function(a){if(a.target&&a.target.id){var b=a.target.id.split("--"),c=b[0],b=parseInt(b[1]),d=this.drawBox.drawLayer.graphics[b];this._editorConfig.graphicCurrent=d;switch(c){case "draw-action-up":this.switch2DrawingGraphics(b,
b+1);this.listGenerateDrawTable();break;case "draw-action-down":this.switch2DrawingGraphics(b,b-1);this.listGenerateDrawTable();break;case "draw-action-delete":this._clickedGraphic=d;this.config.confirmOnDelete?this._confirmDeleteMessage=new H({message:'\x3ci class\x3d"message-warning-icon"\x3e\x3c/i\x3e\x26nbsp;'+this.nls.confirmDrawDelete,buttons:[{label:this.nls.yes,onClick:this._removeClickedGraphic},{label:this.nls.no}]}):this._removeClickedGraphic();break;case "draw-action-edit":this.setMode("edit");
break;case "draw-action-zoom":this.setInfoWindow(d);a=f.graphicsExtent([d]);this.map.setExtent(a,!0);this.listGenerateDrawTable();break;case "draw-action-checkclick":d.checked=a.target.checked,this.listUpdateAllCheckbox()}}},_editorConfig:{drawPlus:{FontFamily:!1,bold:!1,italic:!1,underline:!1,angle:!1,placement:{vertical:"middle",horizontal:"center"}},phantom:{point:!1,symbol:!1,layer:!1,handle:!1}},editorPrepareForAdd:function(a){this._editorConfig.graphicCurrent=!1;this.editorSymbolChooserConfigure(a);
this.nameField.value=this.nls.nameFieldDefaultValue;this.descriptionField.value="";this.editorTitle.innerHTML=this.nls.addDrawTitle;this.editorFooterEdit.style.display="none";this.editorFooterAdd.style.display="block";this.editorAddMessage.style.display="block";this.editorEditMessage.style.display="none";this.editorSnappingMessage.style.display="none";var b=this._editorConfig.commontype;this._editorConfig.phantom.symbol=a;this.editorEnableMapPreview("point"==b||"text"==b);"text"==b&&this.editorUpdateTextPlus();
this.editorActivateSnapping(!0);this.editorMeasureConfigure(!1,b)},editorPrepareForEdit:function(a){this._editorConfig.graphicCurrent=a;this.nameField.value=a.attributes.name;this.descriptionField.value=a.attributes.description;this.editorActivateGeometryEdit(a);this.editorSymbolChooserConfigure(a.symbol);this.editorTitle.innerHTML=this.nls.editDrawTitle;this.editorFooterEdit.style.display="block";this.editorFooterAdd.style.display="none";this.editorAddMessage.style.display="none";this.editorEditMessage.style.display=
"block";this.editorSnappingMessage.style.display="block";this.editorEnableMapPreview(!1);this.editorActivateSnapping(!0);this.editorMeasureConfigure(a,!1)},editorSymbolChooserConfigure:function(a){if(a){this.editorSymbolChooser.showBySymbol(a);this.editorSymbolChooser.showByType(this.editorSymbolChooser.type);this._editorConfig.symboltype=this.editorSymbolChooser.type;var b=a.type;"simplelinesymbol"==b?(this.editorSymbolLinePlusNode.style.display="block",a.marker&&a.marker.placement?this.editorLinePlusArrow.set("value",
a.marker.placement):this.editorLinePlusArrow.set("value","")):this.editorSymbolLinePlusNode.style.display="none";if("textsymbol"==b){this.editorSymbolChooser._initTextSettings(a);this.editorSymbolTextPlusNode.style.display="block";if(b=this._UTIL__getParentByTag(this.editorSymbolChooser.inputText,"tr"))b.style.display="none";this._editorConfig.drawPlus.bold=a.font.weight==esri.symbol.Font.WEIGHT_BOLD;this._editorConfig.drawPlus.italic=a.font.style==esri.symbol.Font.STYLE_ITALIC;this._editorConfig.drawPlus.underline=
"underline"==a.font.decoration;this._editorConfig.drawPlus.placement.horizontal=a.horizontalAlignment?a.horizontalAlignment:"center";this._editorConfig.drawPlus.placement.vertical=a.verticalAlignment?a.verticalAlignment:"middle";this.editorTextPlusFontFamilyNode.set("value",a.font.family);this.editorTextPlusAngleNode.set("value",a.angle);this._UTIL__enableClass(this.editorTextPlusBoldNode,"selected",this._editorConfig.drawPlus.bold);this._UTIL__enableClass(this.editorTextPlusItalicNode,"selected",
this._editorConfig.drawPlus.italic);this._UTIL__enableClass(this.editorTextPlusUnderlineNode,"selected",this._editorConfig.drawPlus.underline);a=0;for(b=this._editorTextPlusPlacements.length;a<b;a++){var c=this._editorTextPlusPlacements[a].title.split(" ");this._UTIL__enableClass(this._editorTextPlusPlacements[a],"selected",c[0]==this._editorConfig.drawPlus.placement.vertical&&c[1]==this._editorConfig.drawPlus.placement.horizontal)}}else this.editorSymbolTextPlusNode.style.display="none"}},editorActivateSnapping:function(a){a?
this.map.enableSnapping({layerInfos:[{layer:this.drawBox.drawLayer}],tolerance:20}):this.map.disableSnapping()},editorUpdateTextPlus:function(){if("text"==this.editorSymbolChooser.type){var a=this.nameField.value,b=this.editorTextPlusFontFamilyNode.value,c=this.editorTextPlusAngleNode.value,d=this._editorConfig.drawPlus.bold?esri.symbol.Font.WEIGHT_BOLD:esri.symbol.Font.WEIGHT_NORMAL,e=this._editorConfig.drawPlus.italic?esri.symbol.Font.STYLE_ITALIC:esri.symbol.Font.STYLE_NORMAL,f=this._editorConfig.drawPlus.underline?
"underline":"none",g=this._editorConfig.drawPlus.placement.horizontal,k=this._editorConfig.drawPlus.placement.vertical,h=this.editorSymbolChooser.getSymbol();this.editorSymbolChooser.inputText.value=a;h.text=a;h.font.setFamily(b);h.setAngle(c);h.setHorizontalAlignment(g);h.setVerticalAlignment(k);h.font.setWeight(d);h.font.setStyle(e);h.font.setDecoration(f);this.editorSymbolChooser.inputText.value=a;this.editorSymbolChooser.showBySymbol(h);this.drawBox.setTextSymbol(h);this.editorSymbolChooser.textPreview.innerHTML=
a;this.editorSymbolChooser.textPreview.style.fontFamily=b;this.editorSymbolChooser.textPreview.style["font-style"]=this._editorConfig.drawPlus.italic?"italic":"normal";this.editorSymbolChooser.textPreview.style["font-weight"]=this._editorConfig.drawPlus.bold?"bold":"normal";this.editorSymbolChooser.textPreview.style["text-decoration"]=this._editorConfig.drawPlus.underline?"underline":"none";this.editorTextAnglePreviewNode.style.transform="rotate("+c+"deg)";this.editorTextAnglePreviewNode.style["-ms-transform"]=
"rotate("+c+"deg)";this._editorConfig.graphicCurrent?this._editorConfig.graphicCurrent.setSymbol(h):this.editorUpdateMapPreview(h)}},editorMeasureConfigure:function(a,b){this.measureSection.style.display="block";a&&a.measureParent?(this.fieldsDiv.style.display="none",this.isMeasureSpan.style.display="block"):(this.fieldsDiv.style.display="block",this.isMeasureSpan.style.display="none");if(b)"text"==b?this.measureSection.style.display="none":(this.distanceUnitSelect.set("value",this.configDistanceUnits[0].unit),
this.areaUnitSelect.set("value",this.configAreaUnits[0].unit),this.pointUnitSelect.set("value","map"),this.showMeasure.checked=this.config.measureEnabledByDefault,this._setMeasureVisibility());else if(a)if(b=a.geometry.type,"point"==b&&a.symbol&&"textsymbol"==a.symbol.type)this.measureSection.style.display="none";else{var c=a.measure;this.distanceUnitSelect.set("value",a.measure&&a.measure.lengthUnit?a.measure.lengthUnit:this.configDistanceUnits[0].unit);"polygon"==b&&this.areaUnitSelect.set("value",
a.measure&&a.measure.areaUnit?a.measure.areaUnit:this.configAreaUnits[0].unit);this.showMeasure.checked=c;this._setMeasureVisibility()}else this.measureSection.style.display="none"},editorSetDefaultSymbols:function(){var a=this.editorSymbolChooser.getSymbol();switch(a.type.toLowerCase()){case "simplemarkersymbol":this.drawBox.setPointSymbol(a);break;case "picturemarkersymbol":this.drawBox.setPointSymbol(a);break;case "textsymbol":this.drawBox.setTextSymbol(a);break;case "simplelinesymbol":this.drawBox.setLineSymbol(a);
break;case "cartographiclinesymbol":this.drawBox.setLineSymbol(a);break;case "simplefillsymbol":this.drawBox.setPolygonSymbol(a);break;case "picturefillsymbol":this.drawBox.setPolygonSymbol(a)}},importMessage:!1,importInput:!1,launchImportFile:function(){if(!window.FileReader)return this.showMessage(this.nls.importErrorMessageNavigator,"error"),!1;this.importMessage=new H({message:'\x3cdiv class\x3d"eDraw-import-message" id\x3d"'+this.id+'___div_import_message"\x3e\x3cinput class\x3d"file" type\x3d"file" id\x3d"'+
this.id+'___input_file_import"/\x3e\x3cdiv class\x3d"eDraw-import-draganddrop-message"\x3e'+this.nls.importDragAndDropMessage+"\x3c/div\x3e\x3c/div\x3e",titleLabel:this.nls.importTitle,buttons:[{label:this.nls.importCloseButton}]});this.importInput=dojo.byId(this.id+"___input_file_import");u(this.importInput,"change",this.importFile);var a=dojo.byId(this.id+"___div_import_message");u(a,"dragover",function(a){a.stopPropagation();a.preventDefault();a.dataTransfer.dropEffect="copy"});u(a,"drop",l.hitch(this,
function(a){a.stopPropagation();a.preventDefault();a=a.dataTransfer.files;if(a[0]){var b=new FileReader;b.onload=this.importOnFileLoad;b.readAsText(a[0])}}))},importFile:function(){if(!this.importInput)return this.showMessage(this.nls.importErrorWarningSelectFile,"warning"),this.importMessage&&this.importMessage.close(),!1;var a=this.importInput.files[0];if(!a)return this.showMessage(this.nls.importErrorWarningSelectFile,"warning"),!1;var b=new FileReader;b.onload=this.importOnFileLoad;b.readAsText(a)},
importOnFileLoad:function(a){this.importJsonContent(a.target.result);this.importMessage.close()},importJsonContent:function(a,b,c){try{"string"==typeof a&&(a=JSON.parse(a));if(!a.features)return this.showMessage(this.nls.importErrorFileStructure,"error"),!1;if(1>a.features.length)return this.showMessage(this.nls.importWarningNoDrawings,"warning"),!1;if(!b){var d=a.features[0],e=["name","title","label"];if(d.attributes)for(var f in e)if(d.attributes[e[f]]){b=e[f];break}}if(!c&&(d=a.features[0],e=["description",
"descript","desc","comment","comm"],d.attributes)){f=0;for(var A=e.length;f<A;f++)if(d.attributes[e[f]]){c=e[f];break}}var e=[],g=[];f=0;for(A=a.features.length;f<A;f++){var h=a.features[f],d=new k(h);d.attributes||(d.attributes={});d.attributes.name=b&&d.attributes[b]?d.attributes[b]:"n\u00b0"+(f+1);d.symbol&&"textsymbol"==d.symbol.type&&(d.attributes.name=d.symbol.text);d.attributes.description=c&&d.attributes[c]?d.attributes[c]:"";if(!d.symbol){var l=!1;switch(d.geometry.type){case "point":l=new J;
break;case "polyline":l=new M;break;case "polygon":l=new N}l&&d.setSymbol(l)}h.measure&&(d.measure=h.measure,e.push(f));g.push(d)}a=0;for(var F=e.length;a<F;a++){f=e[a];var m=g[f].measure&&g[f].measure.graphic&&g[g[f].measure.graphic]?g[g[f].measure.graphic]:!1;m?(g[f].measure.graphic=m,m.measureParent=g[f]):g[f].measure=!1}f=0;for(var T=g.length;f<T;f++)g[f]&&this.drawBox.drawLayer.add(g[f]);this.setMode("list")}catch(V){return this.showMessage(this.nls.importErrorFileStructure,"error"),!1}},exportInFile:function(){this.launchExport(!1)},
exportSelectionInFile:function(a){a&&a.preventDefault&&a.preventDefault();this.launchExport(!0)},launchExport:function(a){var b=this.drawingsGetJson(!1,a);if(!b)return this.showMessage(this.nls.importWarningNoExport0Draw,"warning"),!1;a=K.createDataSource({type:K.TYPE_FEATURESET,data:{toJson:function(){return b}},filename:this.config.exportFileName?this.config.exportFileName:"myDrawings"});a.setFormat(K.FORMAT_FEATURESET);a.download();return!1},editorOnClickEditSaveButon:function(){"text"==this.editorSymbolChooser.type&&
this.editorUpdateTextPlus();this._editorConfig.graphicCurrent.attributes.name=this.nameField.value;this._editorConfig.graphicCurrent.attributes.description=this.descriptionField.value;"text"!=this.editorSymbolChooser.type&&this.addMeasure(this._editorConfig.graphicCurrent.geometry,this._editorConfig.graphicCurrent);this.setMode("list")},editorOnClickEditCancelButon:function(){this.editorResetGraphic();this.editorActivateGeometryEdit(!1);this.setMode("list")},editorOnClickResetCancelButon:function(){this.editorResetGraphic();
this.setMode("edit")},editorResetGraphic:function(){if(this._editorConfig.graphicSaved&&this._editorConfig.graphicCurrent){var a=new k(this._editorConfig.graphicSaved);this._editorConfig.graphicCurrent.setGeometry(a.geometry);this._editorConfig.graphicCurrent.setSymbol(a.symbol)}},_showShadowMeasure:!1,_shadowMeasureTextGraphic:null,showShadowMeasure:function(a){this._shadowMeasureTextGraphic&&(this.map.graphics.remove(this._shadowMeasureTextGraphic),this._shadowMeasureTextGraphic=null);if(this.showMeasure.checked&&
"text"!=this._editorConfig.commontype&&a.graphic&&a.graphic.geometry){var b=this._getLabelPoint(a.graphic.geometry);(a=this.getMeasureText(a.graphic.geometry))&&b&&(this._shadowMeasureTextGraphic=this._getTxtGraphic(b,a),this.map.graphics.add(this._shadowMeasureTextGraphic))}},editorActivateGeometryEdit:function(a){a||(this.editorActivateSnapping(!1),this._showShadowMeasure=!1);if(!a&&this._editorConfig.editToolbar)this._editorConfig.editToolbar.deactivate();else{this._showShadowMeasure=!0;this._editorConfig.graphicSaved=
a.toJson();var b=0|m.MOVE;"point"!=a.geometry.type&&(b=b|m.EDIT_VERTICES|m.SCALE|m.ROTATE);this._editorConfig.editToolbar.activate(b,a,{allowAddVertices:!0,allowDeleteVertices:!0,uniformScaling:!0})}},drawBoxOnTypeSelected:function(a,b,c){this._editorConfig.defaultSymbols||(this._editorConfig.defaultSymbols={});this._editorConfig.commontype=c;a=this._editorConfig.defaultSymbols[c];if(!a)switch(c){case "point":a=this.config.defaultSymbols&&this.config.defaultSymbols.SimpleMarkerSymbol?this.config.defaultSymbols.SimpleMarkerSymbol:
null;a=new J(a);break;case "polyline":a=this.config.defaultSymbols&&this.config.defaultSymbols.SimpleLineSymbol?this.config.defaultSymbols.SimpleLineSymbol:null;a=new M(a);break;case "polygon":a=this.config.defaultSymbols&&this.config.defaultSymbols.SimpleFillSymbol?this.config.defaultSymbols.SimpleFillSymbol:null;a=new N(a);break;case "text":a=this.config.defaultSymbols&&this.config.defaultSymbols.TextSymbol?this.config.defaultSymbols.TextSymbol:{verticalAlignment:"middle",horizontalAlignment:"center"},
a=new O(a)}this._showShadowMeasure=!0;a&&(this._editorConfig.defaultSymbols[c]=a,this.setMode("add2"))},extent2Polygon:function(a){var b=new P(a.spatialReference||this.map.spatialReference);b.addRing([[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]);return b},rect2Polygon:function(a){return this.extent2Polygon(a.getExtent())},drawBoxOnDrawEnd:function(a,b,c){b=a.geometry;this.editorEnableMapPreview(!1);a.attributes={name:this.nameField.value,description:this.descriptionField.value};
"extent"===b.type&&(c=this.extent2Polygon(b),a.setGeometry(c),c=a.getLayer(),c.remove(a),c.add(a),c="polygon");"text"!=c&&this.showMeasure.checked&&this.addMeasure(b,a);"text"==c&&""==this.editorSymbolChooser.inputText.value.trim()&&(this.showMessage(this.nls.textWarningMessage,"warning"),a.getLayer().remove(a));this.saveInLocalStorage();this._editorConfig.graphicCurrent=a;this._editorConfig.defaultSymbols[this._editorConfig.commontype]=a.symbol;this.setMode("list")},editorEnableMapPreview:function(a){a?
(this._editorConfig.phantom.layer?(this._editorConfig.phantom.layer.setVisibility(!0),this._editorConfig.phantom.point.setSymbol(this._editorConfig.phantom.symbol)):(this._editorConfig.phantom.layer=new t({id:this.id+"__phantomLayer"}),a=this.map.extent.getCenter(),this._editorConfig.phantom.point=new k(a,this._editorConfig.phantom.symbol,{}),this._editorConfig.phantom.layer.add(this._editorConfig.phantom.point),this._editorConfig.phantom.point.hide(),this.map.addLayer(this._editorConfig.phantom.layer)),
this._editorConfig.phantom.handle||(this._editorConfig.phantom.handle=u(this.map,"mouse-move, mouse-out",l.hitch(this,function(a){if("opened"===this.state||"active"===this.state)switch(a.type){case "mousemove":this._editorConfig.phantom.point&&(this._editorConfig.phantom.point.setGeometry(a.mapPoint),this._editorConfig.phantom.point.show(),this.showShadowMeasure({graphic:{geometry:a.mapPoint}}));break;case "mouseout":this._editorConfig.phantom.point&&this._editorConfig.phantom.point.hide();break;
case "mouseover":this._editorConfig.phantom.point&&(this._editorConfig.phantom.point.setGeometry(a.mapPoint),this._editorConfig.phantom.point.show())}})))):(this._editorConfig.phantom.layer&&this._editorConfig.phantom.layer.setVisibility(!1),this._editorConfig.phantom.symbol=!1,this._editorConfig.phantom.handle&&(dojo.disconnect(this._editorConfig.phantom.handle),this._editorConfig.phantom.handle=!1))},editorUpdateMapPreview:function(a){("text"==this.editorSymbolChooser.type||"marker"==this.editorSymbolChooser.type)&&
this._editorConfig.phantom.handle&&this._editorConfig.phantom.point&&(this._editorConfig.phantom.symbol=a,this._editorConfig.phantom.point.setSymbol(a))},editorOnClickAddCancelButon:function(){this.setMode("add1")},_getLengthAndArea:function(a,b){var c=new q,d={length:null,area:null},d=this._getLengthAndAreaGeometryEngine(a,b,this.areaUnitSelect.value,this.distanceUnitSelect.value,a.spatialReference?a.spatialReference.wkid:this.map.spatialReference.wkid);c.resolve(d);return c},_getLengthAndAreaGeometryEngine:function(a,
b,c,d,e){c=c.toLowerCase().replace("_","-");d=d.toLowerCase().replace("_","-");var f={area:null,length:null};b&&(f.area=4326==e||3857==e?D.geodesicArea(a,c):D.planarArea(a,c),a=this._getPolylineOfPolygon(a));f.length=4326==e||3857==e?D.geodesicLength(a,d):D.planarLength(a,d);return f},_getPolylineOfPolygon:function(a){var b=new E(a.spatialReference);a=a.rings[0];a=a.slice(0,a.length-1);b.addPath(a);return b},_resetUnitsArrays:function(){this.defaultDistanceUnits=[];this.defaultAreaUnits=[];this.configDistanceUnits=
[];this.configAreaUnits=[];this.distanceUnits=[];this.areaUnits=[]},_getDefaultDistanceUnitInfo:function(a){for(var b=0;b<this.defaultDistanceUnits.length;b++){var c=this.defaultDistanceUnits[b];if(c.unit===a)return c}return null},_getDefaultAreaUnitInfo:function(a){for(var b=0;b<this.defaultAreaUnits.length;b++){var c=this.defaultAreaUnits[b];if(c.unit===a)return c}return null},_getDistanceUnitInfo:function(a){for(var b=0;b<this.distanceUnits.length;b++){var c=this.distanceUnits[b];if(c.unit===a)return c}return null},
_getAreaUnitInfo:function(a){for(var b=0;b<this.areaUnits.length;b++){var c=this.areaUnits[b];if(c.unit===a)return c}return null},_setMeasureVisibility:function(){var a="none",b="none",c="none";if(this._editorConfig.symboltype)switch(this._editorConfig.symboltype){case "text":c=b=a="none";break;case "marker":a="block";c=b="none";break;case "line":a="none";b="block";c="none";break;case "fill":a="none",c=b="block"}z.setStyle(this.pointMeasure,"display",a);z.setStyle(this.distanceMeasure,"display",b);
z.setStyle(this.areaMeasure,"display",c)},_getGraphicIndex:function(a){for(var b=0,c=this.drawBox.drawLayer.graphics.length;b<c;b++)if(this.drawBox.drawLayer.graphics[b]==a)return parseInt(b);return!1},_getLabelPoint:function(a){if("point"==a.type)return a;if("polygon"==a.type&&a.getCendroid)return a.getCendroid();if("polyline"==a.type||"polyline"==a.commonType){var b=a.getExtent().getCenter();return(a=D.nearestCoordinate(a,b))&&a.coordinate?a.coordinate:b}return"rect"==a.type&&a.getCenter?a.getExtent().getCenter():
"extent"==a.type&&a.getCenter?a.getCenter():a.getCendroid?a.getCendroid():a.getCenter?a.getCenter():a.getExtent?a.getExtent().getCenter():!1},getMeasureText:function(a){var b=a.spatialReference?a.spatialReference.wkid:this.map.spatialReference.wkid,c=this.pointUnitSelect.value,d=this.distanceUnitSelect.value,e=this.areaUnitSelect.value;"extent"==a.type?a=this.extent2Polygon(a):"rect"==a.type&&(a=this.rect2Polygon(a));switch(a.type){case "point":d={x:this._round(a.x,2),y:this._round(a.y,2)};if("map"!=
c){d=null;4326==b?d={x:a.x,y:a.y}:I.isLoaded()&&(d=I.project(a,new C({wkid:4326})),d={x:d.x,y:d.y});if(!d)return;d=this._prepareLonLat(d,"DMS"==c)}return(this.config.measurePointLabel?this.config.measurePointLabel:"{{x}} {{y}}").replace("{{x}}",d.x).replace("{{y}}",d.y);case "polyline":return a=this._getLengthAndAreaGeometryEngine(a,!1,e,d,b),e=this.config.measurePolylineLabel?this.config.measurePolylineLabel:"{{length}} {{lengthUnit}}",c=L.localizeNumber(a.length.toFixed(1)),d=this.distanceUnitSelect.value,
d=this._getDistanceUnitInfo(d).label,e.replace("{{length}}",c).replace("{{lengthUnit}}",d);case "polygon":return a=this._getLengthAndAreaGeometryEngine(a,!0,e,d,b),b=this.config.measurePolygonLabel?this.config.measurePolygonLabel:"{{area}} {{areaUnit}}    {{length}} {{lengthUnit}}",c=L.localizeNumber(a.length.toFixed(1)),d=this.distanceUnitSelect.value,d=this._getDistanceUnitInfo(d).label,e=this.areaUnitSelect.value,e=this._getAreaUnitInfo(e).label,a=L.localizeNumber(a.area.toFixed(1)),b.replace("{{length}}",
c).replace("{{lengthUnit}}",d).replace("{{area}}",a).replace("{{areaUnit}}",e)}return null},_prepareLonLat:function(a,b){if(!b)return{x:this._round(a.x,5),y:this._round(a.y,5)};a={x:a.x,y:a.y};0>a.x?(a.x=-a.x,b=this.nls.west):b=this.nls.east;var c=Math.floor(a.x),d=60*(a.x-c),e=Math.floor(d);a.x=c+"\u00b0"+e+'"'+this._round(60*(d-e),2)+"'"+b;0>a.y?(a.y=-a.y,b=this.nls.south):b=this.nls.north;c=Math.floor(a.y);d=60*(a.y-c);e=Math.floor(d);a.y=c+"\u00b0"+e+'"'+this._round(60*(d-e),2)+"'"+b;return a},
_round:function(a,b){return b?Math.round(a*Math.pow(10,b))/Math.pow(10,b):Math.round(a)},_getTxtGraphic:function(a,b,c){var d=new G("16px",G.STYLE_ITALIC,G.VARIANT_NORMAL,G.WEIGHT_BOLD,"Courier"),e=new y([0,0,0,1]),d=new O(b,d,e);c&&d.setVerticalAlignment("bottom");return new k(a,d,{name:b,description:""},null)},addMeasure:function(a,b){this._shadowMeasureTextGraphic&&(this.map.graphics.remove(this._shadowMeasureTextGraphic),this._shadowMeasureTextGraphic=null);var c=this.getMeasureText(a),d=b.measure&&
b.measure.graphic&&b.measure.graphic.measureParent?b.measure.graphic:!1,e=this._getLabelPoint(a);d?(a=d,a.symbol.setText(c),a.attributes.name=c,a.geometry.update(e.x,e.y),a.draw()):(a=this._getTxtGraphic(e,c,"point"==a.type),this.drawBox.drawLayer.add(a),c=this._getGraphicIndex(b),e=this.drawBox.drawLayer.graphics.length-1,e>c+1&&this.moveDrawingGraphic(e,c+1));a.measureParent=b;b.measure={graphic:a,pointUnit:this.pointUnitSelect.value,lengthUnit:this.distanceUnitSelect.value,areaUnit:this.areaUnitSelect.value};
return a},_bindEvents:function(){this.own(u(this.drawBox,"IconSelected",l.hitch(this,this.drawBoxOnTypeSelected)));this.own(u(this.drawBox,"DrawEnd",l.hitch(this,this.drawBoxOnDrawEnd)));this.own(u(this.editorSymbolChooser,"change",l.hitch(this,function(){this.editorSetDefaultSymbols();"text"==this.editorSymbolChooser.type?this.editorUpdateTextPlus():this._editorConfig.graphicCurrent&&this._editorConfig.graphicCurrent.setSymbol(this.editorSymbolChooser.getSymbol());"marker"==this.editorSymbolChooser.type&&
this.editorUpdateMapPreview(this.editorSymbolChooser.getSymbol())})));this.own(u(this.showMeasure,"click",l.hitch(this,this._setMeasureVisibility)));this.listOnActionClick=l.hitch(this,this.listOnActionClick);this.importFile=l.hitch(this,this.importFile);this.importOnFileLoad=l.hitch(this,this.importOnFileLoad);this._removeGraphics=l.hitch(this,this._removeGraphics);this._removeClickedGraphic=l.hitch(this,this._removeClickedGraphic);u(this.editorLinePlusArrow,"change",l.hitch(this,function(a){this._editorConfig.drawPlus.arrow=
this.editorLinePlusArrow.value;a=this.editorSymbolChooser.getSymbol();this.editorLinePlusArrow.value?a.setMarker({style:"arrow",placement:this.editorLinePlusArrow.value}):a.marker=null;this.editorSymbolChooser.showBySymbol(a);this.drawBox.setLineSymbol(a);this._editorConfig.graphicCurrent?this._editorConfig.graphicCurrent.setSymbol(a):this.editorUpdateMapPreview(a)}));this.editorUpdateTextPlus=l.hitch(this,this.editorUpdateTextPlus);this.editorTextPlusFontFamilyNode.on("change",this.editorUpdateTextPlus);
this.editorTextPlusAngleNode.on("change",this.editorUpdateTextPlus);u(this.editorTextPlusBoldNode,"click",l.hitch(this,function(a){this._editorConfig.drawPlus.bold=!this._editorConfig.drawPlus.bold;this._UTIL__enableClass(this.editorTextPlusBoldNode,"selected",this._editorConfig.drawPlus.bold);this.editorUpdateTextPlus()}));u(this.editorTextPlusItalicNode,"click",l.hitch(this,function(a){this._editorConfig.drawPlus.italic=!this._editorConfig.drawPlus.italic;this._UTIL__enableClass(this.editorTextPlusItalicNode,
"selected",this._editorConfig.drawPlus.italic);this.editorUpdateTextPlus()}));u(this.editorTextPlusUnderlineNode,"click",l.hitch(this,function(a){this._editorConfig.drawPlus.underline=!this._editorConfig.drawPlus.underline;this._UTIL__enableClass(this.editorTextPlusUnderlineNode,"selected",this._editorConfig.drawPlus.underline);this.editorUpdateTextPlus()}));this.onEditorTextPlusPlacementClick=l.hitch(this,function(a){if(a.target){for(var b=!1,c=0,d=this._editorTextPlusPlacements.length;c<d;c++){var e=
a.target==this._editorTextPlusPlacements[c];this._UTIL__enableClass(this._editorTextPlusPlacements[c],"selected",e);e&&(b=this._editorTextPlusPlacements[c])}b.title&&(a=b.title.split(" "),this._editorConfig.drawPlus.placement={vertical:a[0],horizontal:a[1]},this.editorUpdateTextPlus())}});this._editorTextPlusPlacements=[this.editorTextPlusPlacementTopLeft,this.editorTextPlusPlacementTopCenter,this.editorTextPlusPlacementTopRight,this.editorTextPlusPlacementMiddleLeft,this.editorTextPlusPlacementMiddleCenter,
this.editorTextPlusPlacementMiddleRight,this.editorTextPlusPlacementBottomLeft,this.editorTextPlusPlacementBottomCenter,this.editorTextPlusPlacementBottomRight];for(var a=0,b=this._editorTextPlusPlacements.length;a<b;a++)u(this._editorTextPlusPlacements[a],"click",this.onEditorTextPlusPlacementClick);this.showShadowMeasure=l.hitch(this,this.showShadowMeasure);a=l.hitch(this,function(a){if(this.drawBox.drawToolBar._graphic&&this.drawBox.drawToolBar._graphic.geometry)if(this.drawBox.drawToolBar._tGraphic&&
this.drawBox.drawToolBar._tGraphic.geometry){var b=D.union([this.drawBox.drawToolBar._graphic.geometry,this.drawBox.drawToolBar._tGraphic.geometry]);this.showShadowMeasure({graphic:{geometry:b}});console.log("showShadowMeasureOnDraw -\x3e merge previous and current part",b)}else this.showShadowMeasure({graphic:this.drawBox.drawToolBar._graphic.clone()}),console.log("showShadowMeasureOnDraw -\x3e allready drawn",this.drawBox.drawToolBar._graphic.geometry);else this.drawBox.drawToolBar._tGraphic&&this.drawBox.drawToolBar._tGraphic.geometry?
(this.showShadowMeasure({graphic:this.drawBox.drawToolBar._tGraphic.clone()}),console.log("showShadowMeasureOnDraw -\x3e only current part",this.drawBox.drawToolBar._tGraphic.geometry)):console.log("No geom INFO",this.drawBox.drawToolBar);return a});p.after(this.drawBox.drawToolBar,"_onClickHandler",a);p.after(this.drawBox.drawToolBar,"_onDblClickHandler",a);p.after(this.drawBox.drawToolBar,"_onMouseDragHandler",a);p.after(this.drawBox.drawToolBar,"_onMouseMoveHandler",a);p.after(this.drawBox.drawToolBar,
"activate",l.hitch(this,function(){this._showShadowMeasure=!0}))},_menuInit:function(){this._menuButtons={add:this.menuAddButton,edit:this.menuEditButton,list:this.menuListButton,importExport:this.menuListImportExport};this.TabViewStack=new Q({viewType:"dom",views:[this.addSection,this.editorSection,this.listSection]});z.place(this.TabViewStack.domNode,this.settingAllContent)},_initLocalStorage:function(){if(this.config.allowLocalStorage){this._localStorageKey=this.config.localStorageKey?"WebAppBuilder.2D.eDraw."+
this.config.localStorageKey:"WebAppBuilder.2D.eDraw";var a=e.get(this._localStorageKey);!a||!a.features||1>a.features.length||function(b){setTimeout(function(){b.importJsonContent(a,"name","description");b.showMessage(b.nls.localLoading)},200)}(this)}},_initDrawingPopupAndClick:function(){var a=new esri.InfoTemplate("${name}","${description}");this.drawBox.drawLayer.setInfoTemplate(a);this._onDrawClick=l.hitch(this,function(a){a.graphic&&(this._editorConfig.graphicCurrent=a.graphic,this.setMode("list"))});
this.allowPopup(!0)},_initListDragAndDrop:function(){this._listOnDragOver=l.hitch(this,this._listOnDragOver);this._listOnDragStart=l.hitch(this,this._listOnDragStart);this._listOnDrop=l.hitch(this,this._listOnDrop);u(this.drawsTableBody,"dragover",this._listOnDragOver);u(this.drawsTableBody,"drop",this._listOnDrop)},_initUnitSelect:function(){this._initDefaultUnits();this._initConfigUnits();var a=this.configDistanceUnits,b=this.defaultDistanceUnits;this.distanceUnits=0<a.length?a:b;a=this.configAreaUnits;
b=this.defaultAreaUnits;this.areaUnits=0<a.length?a:b;x.forEach(this.distanceUnits,l.hitch(this,function(a){this.distanceUnitSelect.addOption({value:a.unit,label:a.label})}));x.forEach(this.areaUnits,l.hitch(this,function(a){this.areaUnitSelect.addOption({value:a.unit,label:a.label})}))},_initDefaultUnits:function(){this.defaultDistanceUnits=[{unit:"KILOMETERS",label:this.nls.kilometers},{unit:"MILES",label:this.nls.miles},{unit:"METERS",label:this.nls.meters},{unit:"NAUTICAL_MILES",label:this.nls.nauticals},
{unit:"FEET",label:this.nls.feet},{unit:"YARDS",label:this.nls.yards}];this.defaultAreaUnits=[{unit:"SQUARE_KILOMETERS",label:this.nls.squareKilometers},{unit:"SQUARE_MILES",label:this.nls.squareMiles},{unit:"ACRES",label:this.nls.acres},{unit:"HECTARES",label:this.nls.hectares},{unit:"SQUARE_METERS",label:this.nls.squareMeters},{unit:"SQUARE_FEET",label:this.nls.squareFeet},{unit:"SQUARE_YARDS",label:this.nls.squareYards}]},_initConfigUnits:function(){x.forEach(this.config.distanceUnits,l.hitch(this,
function(a){var b=a.unit;B[b]&&(b=this._getDefaultDistanceUnitInfo(b),a.label=b.label,this.configDistanceUnits.push(a))}));x.forEach(this.config.areaUnits,l.hitch(this,function(a){var b=a.unit;B[b]&&(b=this._getDefaultAreaUnitInfo(b),a.label=b.label,this.configAreaUnits.push(a))}))},postMixInProperties:function(){this.inherited(arguments);this._resetUnitsArrays()},postCreate:function(){this.inherited(arguments);I.load();this.editorSymbolChooser=new R({"class":"full-width",type:"text",symbol:new J},
this.editorSymbolChooserDiv);this.drawBox.setMap(this.map);this._menuInit();this._initUnitSelect();this._bindEvents();this._prepareTextPlus();this._initLocalStorage();this._initDrawingPopupAndClick();this._editorConfig.editToolbar=new m(this.map);this._editorConfig.editToolbar.on("graphic-move",this.showShadowMeasure);this._editorConfig.editToolbar.on("graphic-move-stop",this.showShadowMeasure);this._editorConfig.editToolbar.on("scale",this.showShadowMeasure);this._editorConfig.editToolbar.on("scale-stop",
this.showShadowMeasure);this._editorConfig.editToolbar.on("vertex-add",this.showShadowMeasure);this._editorConfig.editToolbar.on("vertex-delete",this.showShadowMeasure);this._editorConfig.editToolbar.on("vertex-move",this.showShadowMeasure);this._editorConfig.editToolbar.on("vertex-move-stop",this.showShadowMeasure);this._initListDragAndDrop()},_prepareTextPlus:function(){this._UTIL__enableClass(this._editorTextPlusPlacements[4],"selected",!0);this.config.drawPlus&&this.config.drawPlus.fontFamilies&&
0<this.config.drawPlus.fontFamilies.length&&this.editorTextPlusFontFamilyNode.set("options",this.config.drawPlus.fontFamilies).reset()},onOpen:function(){0<this.drawBox.drawLayer.graphics.length?this.setMode("list"):this.setMode("add1")},onClose:function(){this.editorResetGraphic();this.drawBox.deactivate();this.setInfoWindow(!1);this.editorEnableMapPreview(!1);this.editorActivateGeometryEdit(!1);this.map.infoWindow.hide();this.allowPopup(!0)},destroy:function(){this.drawBox&&(this.drawBox.destroy(),
this.drawBox=null);this.editorSymbolChooser&&(this.editorSymbolChooser.destroy(),this.editorSymbolChooser=null);this.inherited(arguments)},_UTIL__enableClass:function(a,b,c){a.classList?c?a.classList.add(b):a.classList.remove(b):(a.className=a.className.replace(b,"").replace("  "," ").trim(),c&&(a.className+=b))},_UTIL__getParentByTag:function(a,b){for(b=b.toLowerCase();a&&a.parentNode;)if(a=a.parentNode,a.tagName&&a.tagName.toLowerCase()==b)return a;return null}})});