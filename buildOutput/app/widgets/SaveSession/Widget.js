//>>built
require({cache:{"widgets/SaveSession/SimpleTable":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/Evented dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dojo/query jimu/utils".split(" "),function(r,v,w,n,f,d,h,p,g,t){return r([v,w,n],{baseClass:"jimu-simple-table",declaredClass:"jimu.dijit.SimpleTable",templateString:'\x3cdiv\x3e\x3cdiv class\x3d"head-section" data-dojo-attach-point\x3d"headDiv"\x3e\x3c/div\x3e\x3cdiv class\x3d"body-section" data-dojo-attach-point\x3d"bodyDiv"\x3e\x3cdiv class\x3d"table-div" data-dojo-attach-point\x3d"tableDiv"\x3e\x3ctable class\x3d"table" cellspacing\x3d"0" onselectstart\x3d"return false;"\x3e\x3ccolgroup\x3e\x3c/colgroup\x3e\x3cthead class\x3d"simple-table-thead simple-table-title"\x3e\x3c/thead\x3e\x3ctbody class\x3d"simple-table-tbody"\x3e\x3c/tbody\x3e\x3c/table\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e',
_name:null,_rowIndex:0,_rowHeight:30,_headHeight:36,REPEATING_ERROR:"REPEATING_ERROR",_classSimpleTableRow:"simple-table-row",_classFirstSimpleTableRow:"first-simple-table-row",_classLastSimpleTableRow:"last-simple-table-row",_classJimuStateDisabled:"jimu-state-disabled",_classRowUpDiv:"row-up-div",_classRowDownDiv:"row-down-div",autoHeight:!0,selectable:!1,fields:null,postMixInProperties:function(){this.nls=window.jimuNls.simpleTable},postCreate:function(){this.inherited(arguments);this._initSelf()},
startup:function(){this.inherited(arguments);this._updateUI()},_initSelf:function(){this._initAttachPoints();this.own(t.bindClickAndDblclickEvents(this.table,f.hitch(this,function(a){if(a=t.getAncestorDom(a.target||a.srcElement,function(a){return d.hasClass(a,"simple-table-row")&&d.hasClass(a,"not-empty")},this.tbody))this.selectRow(a),this._onClickRow(a)}),f.hitch(this,function(a){if(a=t.getAncestorDom(a.target||a.srcElement,function(a){return d.hasClass(a,"simple-table-row")&&d.hasClass(a,"not-empty")},
this.tbody))this.selectRow(a),this._onDblClickRow(a)})));var a=Math.random().toString();this._name="jimu_table_"+a.slice(2,a.length);this.thead=g("thead",this.domNode)[0];this.tbody=g("tbody",this.domNode)[0];if(this.fields&&0<this.fields.length){var b=d.create("tr",{},this.thead);h.forEach(this.fields,f.hitch(this,function(a){var c="auto";"actions"===a.type&&(a.name="actions");a.hidden?c=1:void 0!==a.width&&null!==a.width?c=a.width:"actions"!==a.type||a.name||(a.width=this._calculateActionsWidth(a)+
20,c=a.width);d.create("col",{width:c},this.colgroup);c=d.create("th",{innerHTML:a.title,title:a.title},b);d.addClass(c,"simple-table-field");a.hidden&&d.addClass(c,"hidden-column");a["class"]&&d.addClass(c,a["class"]);d.addClass(c,a.name)}));d.empty(this.headDiv);a=f.clone(this.tableDiv);d.place(a,this.headDiv)}else this.fields=null},_initAttachPoints:function(){this.table=g("table",this.bodyDiv)[0];this.colgroup=g("colgroup",this.bodyDiv)[0];this.head=g("thead",this.bodyDiv)[0];this.tbody=g("tbody",
this.bodyDiv)[0]},clear:function(){var a=this._getNotEmptyRows();d.empty(this.tbody);h.forEach(a,f.hitch(this,function(a){this._onDeleteRow(a)}));this._updateUI();this._rowIndex=0;this._onClearRows(a)},addRows:function(a){var b=[];this.fields&&a&&0<a.length&&h.forEach(a,f.hitch(this,function(a){b.push(this.addRow(a,!0))}));this._updateUI();return b},addRow:function(a,b){this._rowIndex++;var c={success:!1,tr:null,errorCode:null,errorMessage:null,repeatFields:null};if(!this.fields||"object"!==typeof a)return c;
var e=h.filter(this.fields,f.hitch(this,function(a){return"text"===a.type&&!0===a.unique})),e=h.filter(e,f.hitch(this,function(b){return 0<this.getRowDataArrayByFieldValue(b.name,a[b.name]).length}));if(0<e.length)return c.errorCode=this.REPEATING_ERROR,c.errorMessage="repeating data",c.repeatFields=e,c;var l=d.create("tr",{"class":"simple-table-row not-empty"},this.tbody);d.setAttr(l,"rowId","row"+this._rowIndex);h.forEach(this.fields,f.hitch(this,function(b){var c=a[b.name],e=b.type,m=null;"actions"===
e?m=this._createActionsTd(l,b):("text"===e?m=this._createTextTd(l,b,c):"radio"===e?m=this._createRadioTd(l,b,c):"checkbox"===e?m=this._createCheckboxTd(l,b,c):"empty"===e?m=this._createEmptyTd(l,b):"extension"===e&&(m=this._createExtensionTd(l,b,c)),b.hidden&&d.addClass(m,"hidden-column"))}));l.item=a;b||this._updateUI();c.success=!0;c.tr=l;c.errorMessage=null;this._onAddRow(l);return c},deleteRow:function(a){a&&(d.destroy(a),this._updateUI(),this._onDeleteRow(a))},selectRow:function(a){this.selectable&&
(g(".simple-table-row",this.tbody).removeClass("jimu-state-active"),d.addClass(a,"jimu-state-active"),this._onSelectRow(a))},_updateUI:function(){this._updateRowClassName();this._updateHeight()},_updateHeight:function(){if(this.autoHeight){var a=this.getRows();d.setStyle(this.domNode,"height",this._headHeight+this._rowHeight*(0<a.length?a.length:1)+1+"px")}},_updateRowClassName:function(){var a=g("."+this._classFirstSimpleTableRow,this.tbody)[0];a&&(a=g("."+this._classRowUpDiv,a)[0])&&d.removeClass(a,
this._classJimuStateDisabled);(a=g("."+this._classLastSimpleTableRow,this.tbody)[0])&&(a=g("."+this._classRowDownDiv,a)[0])&&d.removeClass(a,this._classJimuStateDisabled);a=g("."+this._classSimpleTableRow,this.tbody);a.removeClass("odd");a.removeClass("even");a.removeClass(this._classFirstSimpleTableRow);a.removeClass(this._classLastSimpleTableRow);h.forEach(a,f.hitch(this,function(a,b){0===b%2?d.addClass(a,"odd"):d.addClass(a,"even")}));if(0<a.length){var b=a[0];d.addClass(b,this._classFirstSimpleTableRow);
(b=g("."+this._classRowUpDiv,b)[0])&&d.addClass(b,this._classJimuStateDisabled);a=a[a.length-1];d.addClass(a,this._classLastSimpleTableRow);(a=g("."+this._classRowDownDiv,a)[0])&&d.addClass(a,this._classJimuStateDisabled)}},_createTextTd:function(a,b,c){var d=null;return d=b.editable?this._createEditableTextTd(a,b,c):this._createNormalTextTd(a,b,c)},_createNormalTextTd:function(a,b,c){var e=d.toDom('\x3ctd class\x3d"simple-table-cell normal-text-td"\x3e\x3cdiv class\x3d"normal-text-div"\x3e\x3c/div\x3e\x3c/td\x3e');
d.addClass(e,b.name);var l=g("div",e)[0];l.innerHTML=c||"";l.title=c||"";b["class"]&&d.addClass(e,b["class"]);d.place(e,a);return e},_createEditableTextTd:function(a,b,c){var e=d.toDom('\x3ctd class\x3d"editable-text-td '+b.name+'"\x3e\x3cdiv class\x3d"editable-div"\x3e\x3c/div\x3e\x3cinput class\x3d"editable-input" type\x3d"text" style\x3d"display:none;" /\x3e\x3c/td\x3e');d.addClass(e,"simple-table-cell");d.place(e,a);b["class"]&&d.addClass(e,b["class"]);var l=g("div",e)[0],m=g("input",e)[0];l.innerHTML=
c||"";""!==l.innerHTML&&(l.title=l.innerHTML);m.value=l.innerHTML;this.own(p(m,"keypress",f.hitch(this,function(a){a.keyCode===dojo.keys.ENTER&&m.blur()})));this.own(p(m,"blur",f.hitch(this,function(){m.value=f.trim(m.value);var c=l.innerHTML,e=m.value;""!==e?b.unique?0<this.getRowDataArrayByFieldValue(b.name,e,a).length?m.value=c:l.innerHTML=e:l.innerHTML=e:m.value=c;a.item[b.name]=l.innerHTML;d.setStyle(m,"display","none");d.setStyle(l,"display","block");this._onEditRow(a)})));return e},_createRadioTd:function(a,
b,c){var e=d.toDom('\x3ctd class\x3d"radio-td '+b.name+'"\x3e\x3cinput type\x3d"radio" /\x3e\x3c/td\x3e');d.addClass(e,"simple-table-cell");d.place(e,a);b["class"]&&d.addClass(e,b["class"]);a=g("input",e)[0];a.name=b.radio&&"row"===b.radio?this._name+this._rowIndex:this._name+b.name;a.checked=!0===c;return e},_createCheckboxTd:function(a,b,c){var e=d.toDom('\x3ctd class\x3d"checkbox-td '+b.name+'"\x3e\x3cinput type\x3d"checkbox" /\x3e\x3c/td\x3e');d.addClass(e,"simple-table-cell");d.place(e,a);b["class"]&&
d.addClass(e,b["class"]);g("input",e)[0].checked=!0===c;return e},_createActionsTd:function(a,b){var c=d.toDom('\x3ctd class\x3d"actions-td"\x3e\x3cdiv class\x3d"action-item-parent jimu-float-leading"\x3e\x3c/div\x3e\x3c/td\x3e');d.addClass(c,"simple-table-cell");var e=g(".action-item-parent",c)[0];d.place(c,a);b["class"]&&d.addClass(c,b["class"]);h.forEach(b.actions,f.hitch(this,function(b){"up"===b?(b=d.create("div",{"class":"action-item jimu-float-leading row-up-div jimu-icon jimu-icon-up"},e),
b.title=this.nls.moveUp,this.own(p(b,"click",f.hitch(this,function(b){b.stopPropagation();if(this.onBeforeRowUp(a)){b=g(".simple-table-row",this.tbody);var c=h.indexOf(b,a);0<c&&(b=b[c-1])&&(d.place(a,b,"before"),this._updateUI(),this.emit("row-up",a))}})))):"down"===b?(b=d.create("div",{"class":"action-item jimu-float-leading row-down-div jimu-icon jimu-icon-down"},e),b.title=this.nls.moveDown,this.own(p(b,"click",f.hitch(this,function(b){b.stopPropagation();if(this.onBeforeRowDown(a)){b=g(".simple-table-row",
this.tbody);var c=h.indexOf(b,a);c<b.length-1&&(b=b[c+1])&&(d.place(a,b,"after"),this._updateUI(),this.emit("row-down",a))}})))):"load"===b?(b=d.create("div",{"class":"action-item jimu-float-leading row-load-div jimu-icon jimu-icon-load"},e),b.title="Load Map",this.own(p(b,"click",f.hitch(this,function(b){b.stopPropagation();this._onActionsLoad(a)})))):"download"===b?(b=d.create("div",{"class":"action-item jimu-float-leading row-load-div jimu-icon jimu-icon-download"},e),b.title="Download Map",this.own(p(b,
"click",f.hitch(this,function(b){b.stopPropagation();this._onActionsDownload(a)})))):"edit"===b?(b=d.create("div",{"class":"action-item jimu-float-leading row-edit-div jimu-icon jimu-icon-edit"},e),b.title=this.nls.edit,this.own(p(b,"click",f.hitch(this,function(b){b.stopPropagation();this.onBeforeRowEdit(a)&&this._onActionsEdit(a)})))):"delete"===b&&(b=d.create("div",{"class":"action-item jimu-float-leading row-delete-div jimu-icon jimu-icon-delete"},e),b.title=this.nls.deleteRow,this.own(p(b,"click",
f.hitch(this,function(b){b.stopPropagation();this.onBeforeRowDelete(a)&&this.deleteRow(a)}))))}));b=this._calculateActionsWidth(b)+"px";d.setStyle(e,"width",b);return c},_calculateActionsWidth:function(a){return 30*h.map(a.actions,function(a){return"load"===a||"up"===a||"down"===a||"edit"===a||"delete"===a||"download"===a}).length},_createEmptyTd:function(a,b){a=d.create("td",{"class":b.name},a);d.addClass(a,"simple-table-cell");d.addClass(a,"empty-text-td");b["class"]&&d.addClass(a,b["class"]);return a},
_createExtensionTd:function(a,b,c){a=d.create("td",{"class":b.name},a);d.addClass(a,"simple-table-cell");d.addClass(a,"extension-td");b["class"]&&d.addClass(a,b["class"]);b.create&&"function"===typeof b.create&&b.create(a);b.setValue&&"function"===typeof b.setValue&&b.setValue(a,c);return a},editRow:function(a,b){var c={success:!1,tr:null,errorCode:null,errorMessage:null,repeatFields:null};if(!this.fields||"object"!==typeof b||!d.isDescendant(a,this.tbody))return c;var e=f.mixin([],this.fields),e=
h.filter(e,f.hitch(this,function(a){return"text"===a.type&&!0===a.unique})),e=h.filter(e,f.hitch(this,function(c){return 0<this.getRowDataArrayByFieldValue(c.name,b[c.name],a).length}));if(0<e.length)return c.errorCode=this.REPEATING_ERROR,c.errorMessage="repeating data",c.repeatFields=e,c;var l=g(".simple-table-cell",a);h.forEach(this.fields,f.hitch(this,function(a,c){if(b.hasOwnProperty(a.name)){c=l[c];var d=b[a.name],e=a.type;"text"===e?a.editable?this._editEditableText(c,a,d):this._editNormalText(c,
a,d):"radio"===e?this._editRadio(c,a,d):"checkbox"===e?this._editCheckbox(c,a,d):"extension"===e&&this._editExtension(c,a,d)}}));c.success=!0;c.tr=a;c.errorMessage=null;this._onEditRow(a);return c},_editNormalText:function(a,b,c){a=g("div",a)[0];a.innerHTML=c||"";a.title=a.innerHTML},_editEditableText:function(a,b,c){b=g("div",a)[0];b.innerHTML=c||"";g("input",a)[0].value=b.innerHTML},_editRadio:function(a,b,c){g("input",a)[0].checked=!0===c},_editCheckbox:function(a,b,c){g("input",a)[0].checked=
!0===c},_editExtension:function(a,b,c){b.setValue&&"function"===typeof b.setValue&&b.setValue(a,c)},_getAllRows:function(){return g(".simple-table-row",this.tbody)},_getNotEmptyRows:function(){var a=this._getAllRows();return h.filter(a,f.hitch(this,function(a){return!d.hasClass(a,"empty")}))},_getEmptyRows:function(){var a=this._getAllRows();return h.filter(a,f.hitch(this,function(a){return d.hasClass(a,"empty")}))},getRows:function(){return this._getNotEmptyRows()},getSelectedRow:function(){var a=
null,b=g(".simple-table-row",this.tbody),b=h.filter(b,f.hitch(this,function(a){return!d.hasClass(a,"empty")&&d.hasClass(a,"jimu-state-active")}));0<b.length&&(a=b[0]);return a},getSelectedRowData:function(){var a=null,b=this.getSelectedRow();b&&(a=this._getRowDataByTr(b));return a},getData:function(a){var b=this._getNotEmptyRows();a&&(b=h.filter(b,f.hitch(this,function(b){return b!==a})));return h.map(b,f.hitch(this,function(a){return this._getRowDataByTr(a)}))},getRowData:function(a){return this._getRowDataByTr(a)},
_getRowDataByTr:function(a){var b=null;if(a)b={};else return null;h.forEach(this.fields,f.hitch(this,function(c){var d=c.type;if("actions"!==d){var f=c.name;b[f]=null;var h=g("."+f,a)[0];h&&("text"===d?(c=g("div",h)[0],b[f]=c.innerHTML):"radio"===d?(c=g("input",h)[0],b[f]=c.checked):"checkbox"===d?(c=g("input",h)[0],b[f]=c.checked):"extension"===d&&c.getValue&&"function"===typeof c.getValue&&(b[f]=c.getValue(h,c)))}}));return b},getRowDataArrayByFieldValue:function(a,b,c){var d=[];if(!this.fields||
!h.some(this.fields,f.hitch(this,function(b){return b.name===a})))return[];c=this.getData(c);return d=h.filter(c,f.hitch(this,function(c){return c[a]==b}))},getItems:function(){var a=[],a=[],a=this._getNotEmptyRows();return a=h.map(a,f.hitch(this,function(a){return a.item}))},_setEditModeOnRow:function(a){a=g(".simple-table-cell",a);h.forEach(a,f.hitch(this,function(a,c){d.hasClass(a,"actions")||this._setEditModeOnCell(a)}))},_setEditModeOnCell:function(a){var b=g("div",a)[0];a=g("input",a)[0];a.value=
b.innerHTML;d.setStyle(b,"display","none");d.setStyle(a,"display","inline");a.focus()},_onClickRow:function(a){this.emit("row-click",a)},_onDblClickRow:function(a){this.emit("row-dblclick",{element:a,item:a.item})},_onSelectRow:function(a){this.emit("row-select",a)},_onAddRow:function(a){this.emit("row-add",a)},_onEditRow:function(a){this.emit("row-edit",a)},_onDeleteRow:function(a){this.emit("row-delete",{element:a,item:a.item})},_onEnterRow:function(a){this.emit("row-enter",a)},_onClearRows:function(a){this.emit("rows-clear",
a)},_onActionsEdit:function(a){this.emit("actions-edit",a);this._setEditModeOnRow(a)},_onActionsLoad:function(a){this.emit("actions-load",{element:a,item:a.item})},_onActionsDownload:function(a){this.emit("actions-download",{element:a,item:a.item})},onBeforeRowUp:function(a){return!0},onBeforeRowDown:function(a){return!0},onBeforeRowEdit:function(a){return!0},onBeforeRowDelete:function(a){return!0}})})},"widgets/SaveSession/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css",
"dojo/i18n!./nls/strings","dojo/text!widgets/SaveSession/config.json"],function(){})},"url:widgets/SaveSession/Widget.html":'\x3cdiv\x3e\r\n    \x3cdiv class\x3d"help-text"\x3eSave the current map settings\x3c/div\x3e\r\n    \x3chr /\x3e\r\n    \x3cdiv id\x3d"save-panel" data-dojo-attach-point\x3d"savePanel"\x3e\r\n        \x3cdiv class\x3d"form-control"\x3e\r\n            \x3clabel for\x3d"session-name-input"\x3eName: \x3c/label\x3e\r\n            \x3cinput type\x3d"text" id\x3d"session-name-input" data-dojo-type\x3d"dijit/form/TextBox" data-dojo-attach-point\x3d"sessionNameTextBox" data-dojo-props\x3d\'trim:true\' class\x3d"textbox" /\x3e\x3c/input\x3e\r\n        \x3c/div\x3e\r\n        \x3cbutton class\x3d"jimu-btn" type\x3d"button" data-dojo-attach-point\x3d"saveButton" data-dojo-attach-event\x3d"onclick:onSaveButtonClicked"\x3eSave\x3c/button\x3e\r\n        \x3cdiv class\x3d"input-text" data-dojo-attach-point\x3d"inputText"\x3eEnter the name for the session\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3chr /\x3e\r\n    \x3ch3\x3eSaved Sessions\x3c/h3\x3e\r\n    \x3cdiv id\x3d"saved-sessions-panel" data-dojo-attach-point\x3d"savedSessionContainer"\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv id\x3d"load-file-panel"\x3e\r\n        \x3ca href\x3d"#" class\x3d"link-btn" data-dojo-attach-point\x3d"loadFromFileButton" data-dojo-attach-event\x3d"onclick:onLoadFromFileButtonClicked"\x3eLoad from file\x3c/a\x3e\r\n        \x3ca href\x3d"#" class\x3d"link-btn" data-dojo-attach-point\x3d"saveToFileButton" data-dojo-attach-event\x3d"onclick:onSaveToFileButtonClicked"\x3eSave to file\x3c/a\x3e\r\n        \x3ca href\x3d"#" class\x3d"link-btn" data-dojo-attach-point\x3d"saveSingleSession" style\x3d"display: none"\x3eSave single session to file\x3c/a\x3e\r\n    \x3c/div\x3e\r\n    \x3c!-- hidden form to return file to save --\x3e\r\n    \x3c!-- clientside download is not supported in all browsers http://caniuse.com/#search\x3ddownload --\x3e\r\n    \x3cform action\x3d"" method\x3d"post" style\x3d"display:none" data-dojo-attach-point\x3d"saveToFileForm"\x3e\r\n        \x3cinput type\x3d"hidden" name\x3d"filename" value\x3d"" data-dojo-attach-point\x3d"saveToFileName"\x3e\r\n        \x3cinput type\x3d"hidden" name\x3d"content" value\x3d"" data-dojo-attach-point\x3d"saveToFileContent"\x3e\r\n    \x3c/form\x3e\r\n\x3c/div\x3e',
"url:widgets/SaveSession/css/style.css":'div.jimu-widget-savesession .textbox {width: 250px;}div.jimu-widget-savesession .form-control {padding: 5px 0 5px 0;}div.jimu-widget-savesession .jimu-icon {margin-left: 5px; margin-right: 5px;}.jimu-icon-load {background-position: -0px -60px; width: 16px; height: 16px;}.jimu-icon-load.jimu-state-disabled {background-position: -63px -60px; width: 16px; height: 16px;}.jimu-icon-load.jimu-state-hover {background-position: -21px -60px; width: 16px; height: 16px;}.jimu-icon-load:hover {background-position: -21px -60px; width: 16px; height: 16px;}.jimu-icon-download {background-image: url("../images/download_icon.png"); width: 15px; height: 16px;}.jimu-icon-download.jimu-state-disabled {background-image: url("../images/download_icon.png"); width: 15px; height: 16px;}.jimu-icon-download.jimu-state-hover,.jimu-icon-download:hover {background-image: url("../images/download_icon_hover.png"); width: 15px; height: 16px;}div.jimu-widget-savesession .input-text {display: inline; color: silver;}.jimu-widget-savesession .help-text {color: silver;}.jimu-widget-savesession a.link-btn:visited,.jimu-widget-savesession a.link-btn {padding: 10px; color: #518dca;}.jimu-widget-savesession a.link-btn:hover {color: blue;}.jimu-widget-savesession a.link-btn.jimu-state-disabled:visited,.jimu-widget-savesession a.link-btn.jimu-state-disabled:hover,.jimu-widget-savesession a.link-btn.jimu-state-disabled {padding: 10px; color: gray; pointer-events: none; text-decoration: none;}#load-file-panel {margin-top: 10px; width: 200px; margin-left: auto; margin-right: auto;}',
"url:widgets/SaveSession/config.json":'{\r\n    "useServerToDownloadFile": false,\r\n    "saveToFileUrl": "",\r\n    "fileNameForAllSessions": "Sessions.json",\r\n    "fileNameTplForSession": "Sessions_${name}.json"\r\n}',"*now":function(r){r(['dojo/i18n!*preload*widgets/SaveSession/nls/Widget*["","ROOT"]'])}}});
define("dojo/_base/declare jimu/BaseWidget dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/_base/array dojo/_base/html dojo/dom-attr dojo/query dojo/on dojo/topic dojo/string dojo/json dojo/Deferred dojo/promise/all esri/geometry/Extent esri/graphic esri/layers/GraphicsLayer esri/layers/FeatureLayer esri/layers/ImageParameters esri/renderers/ClassBreaksRenderer esri/symbols/SimpleFillSymbol esri/symbols/SimpleLineSymbol esri/Color esri/renderers/SimpleRenderer esri/InfoTemplate esri/layers/ArcGISDynamicMapServiceLayer esri/layers/ArcGISTiledMapServiceLayer jimu/ConfigManager jimu/MapManager jimu/WidgetManager jimu/PanelManager jimu/dijit/Popup jimu/dijit/Message jimu/LayerInfos/LayerInfos jimu/utils ./SimpleTable dijit/form/TextBox dijit/form/Select".split(" "),function(r,
v,w,n,f,d,h,p,g,t,a,b,c,e,l,m,H,I,J,A,K,L,M,N,B,O,P,C,Q,D,E,F,u,y,x,G,R){return r([v,w],{baseClass:"jimu-widget-savesession",storageKey:"sessions",sessions:[],sessionLoaded:null,postCreate:function(){this.inherited(arguments);this.saveToFileForm.action=this.config.saveToFileUrl;this.saveToFileName.value=this.config.defaultFileName;this.loadSavedSessionsFromStorage();this.initSavedSessionUI();this.initNewSessionUI();this.refreshLoadFileUI();console.log("SaveSession :: postCreate :: completed")},startup:function(){this.inherited(arguments);
console.log("SaveSession :: startup")},onOpen:function(){console.log("SaveSession :: onOpen");simpleSearchFilterId="widgets_SimpleSearchFilter_Widget_37";var a=this.appConfig.getConfigElementsByName("AddData"),b=E.getInstance();b.showPanel(a[0]);panelID="widgets_AddData_30_panel";b.closePanel(panelID);document.getElementById(simpleSearchFilterId).click()},onReceiveData:function(a,b,c,d){"SimpleSearchFilter"==a&&this.setLayersVisibilityOpacity(sessionLoaded.layers)},initSavedSessionUI:function(){this.sessionTable=
new G({autoHeight:!0,fields:[{name:"name",title:"Session",type:"text","class":"session-name",unique:!0,hidden:!1,editable:!0},{name:"actions",title:"Actions",type:"actions","class":"actions",actions:"load download edit up down delete".split(" ")}],selectable:!1});this.sessionTable.placeAt(this.savedSessionContainer);this.sessionTable.startup();this.own(g(this.sessionTable,"row-delete",n.hitch(this,"onSessionTableChanged")));this.own(g(this.sessionTable,"row-up",n.hitch(this,"onSessionTableChanged")));
this.own(g(this.sessionTable,"row-down",n.hitch(this,"onSessionTableChanged")));this.own(g(this.sessionTable,"row-edit",n.hitch(this,"onSessionTableChanged")));this.own(g(this.sessionTable,"actions-load",n.hitch(this,"onLoadSessionClicked")));this.own(g(this.sessionTable,"row-dblclick",n.hitch(this,"onLoadSessionClicked")));this.own(g(this.sessionTable,"actions-download",n.hitch(this,"onSaveItemToFileClicked")));this.sessionTable.addRows(this.sessions);console.log("SaveSession :: initSavedSessionUI :: session table created")},
refreshSavedSessionUI:function(){this.sessionTable.clear();this.sessionTable.addRows(this.sessions);console.log("SaveSession :: refreshSavedSessionUI :: session table refreshed")},initNewSessionUI:function(){this.refreshNewSessionUI();this.own(this.sessionNameTextBox.on("change",n.hitch(this,"refreshNewSessionUI")));this.own(this.sessionNameTextBox.on("keypress",n.hitch(this,"onKeyPressed")));console.log("SaveSession :: initNewSessionUI :: end")},refreshLoadFileUI:function(){var a="",a=!1;(a=this.sessions&&
0<this.sessions.length)?(h.remove(this.saveToFileButton,"disabled"),d.removeClass(this.saveToFileButton,"jimu-state-disabled"),console.log("SaveSession :: refreshLoadFileUI :: save to file button enabled")):(h.set(this.saveToFileButton,"disabled","true"),d.addClass(this.saveToFileButton,"jimu-state-disabled"),console.log("SaveSession :: refreshLoadFileUI :: save to file button disabled"));!this.config.useServerToDownloadFile&&a&&(a=b.stringify(this.sessions),a=encodeURIComponent(a),h.set(this.saveToFileButton,
"href","data:application/octet-stream,"+a),h.set(this.saveToFileButton,"download",this.config.fileNameForAllSessions),console.log("SaveSession :: refreshLoadFileUI :: data url set on saveToFileButton"))},onKeyPressed:function(a){if(a.keyCode===dojo.keys.ENTER)this.onSaveButtonClicked();setTimeout(n.hitch(this,"refreshNewSessionUI"),0);console.log("SaveSession :: onKeyPressed :: end")},refreshNewSessionUI:function(){var a="",b=!1,a=this.sessionNameTextBox.get("value");(b=this.isValidSessionName(a))?
(h.remove(this.saveButton,"disabled"),d.removeClass(this.saveButton,"jimu-state-disabled"),console.log("SaveSession :: refreshNewSessionUI :: save button enabled")):(h.set(this.saveButton,"disabled","true"),d.addClass(this.saveButton,"jimu-state-disabled"),console.log("SaveSession :: refreshNewSessionUI :: save button disabled"));this.inputText.innerHTML=this.getMesageForSessionName(a);console.log("SaveSession :: refreshNewSessionUI :: end")},isValidSessionName:function(a){return a?!f.some(this.sessions,
function(k){return k.name===a},this):!1},getUniqueSessionName:function(a,b){b=(b||0)+1;var k=a+" "+String(b);this.isValidSessionName(k)||(k=this.getUniqueSessionName(a,b));return k},getMesageForSessionName:function(a){var k="",b=!1;a||(k="Enter the name for the session");(b=f.some(this.sessions,function(k){return k.name===a},this))&&(k="Enter a unique name for the session");return k},onSaveButtonClicked:function(){console.log("SaveSession :: onSaveButtonClicked :: begin");var a,b="",b=this.sessionNameTextBox.get("value");
this.isValidSessionName(b)?(a=this.getSettingsForCurrentMap(),a.name=b,this.sessions.push(a),console.log("SaveSession :: onSaveButtonClicked :: added session \x3d ",a),this.storeSessions(),this.sessionTable.addRow(a),this.refreshLoadFileUI(),this.refreshNewSessionUI(),console.log("SaveSession :: onSaveButtonClicked :: end")):console.log("SaveSession :: onSaveButtonClicked :: invalid sesion name \x3d ",b)},onSessionTableChanged:function(a){console.log("SaveSession :: onSessionTableChanged :: begin");
this.sessions=this.sessionTable.getItems();this.storeSessions();this.refreshLoadFileUI();this.refreshNewSessionUI();console.log("SaveSession :: onSessionTableChanged :: session stored")},onLoadSessionClicked:function(a){sessionLoaded=a=a.item;console.log("SaveSession :: onLoadSessionClicked :: session  \x3d ",a);var b=D.getInstance().getWidgetById("widgets_LayerList_Widget_17");b&&b._onRemoveLayersClick();this.loadSession(a)},onLoadFromFileButtonClicked:function(a){var b=new F({titleLabel:"Load sessions from file",
autoHeight:!0,content:"Choose the file to load: \x3cinput type\x3d'file' id\x3d'file-to-load' name\x3d'file' enctype\x3d'multipart/form-data' /\x3e",container:"main-page",width:400,height:200,buttons:[{label:"Ok",key:dojo.keys.ENTER,onClick:n.hitch(this,function(){console.log("SaveSession :: onLoadFromFile :: ok");var a;a=p("#file-to-load",b.domNode)[0].files[0];b.close();this.loadSavedSessionsFromFile(a)})},{label:"Cancel",key:dojo.keys.ESCAPE,onClick:n.hitch(this,function(){console.log("SaveSession :: onLoadFromFile :: canceled");
b.close()})}],onClose:n.hitch(this,function(){console.log("SaveSession :: onLoadFromFile :: closed")})});console.log("SaveSession :: onLoadFromFileButtonClicked :: ")},onSaveToFileButtonClicked:function(a){this.config.useServerToDownloadFile?(a=b.stringify(this.sessions),this.saveToFileName.value=this.config.fileNameForAllSessions,this.saveToFileContent.value=a,this.saveToFileForm.submit(),console.log("SaveSession :: onSaveToFileButtonClicked :: end")):console.log("SaveSession :: onSaveToFileButtonClicked :: saveToFileForm submit canceled.")},
onSaveItemToFileClicked:function(k){var q="",c="",q=[],c=a.substitute(this.config.fileNameTplForSession,k.item);q.push(k.item);q=b.stringify(q);this.saveToFileName.value=c;this.saveToFileContent.value=q;h.set(this.saveSingleSession,"href","data:application/octet-stream,"+q);h.set(this.saveSingleSession,"download",c);this.saveSingleSession.click();console.log("SaveSession :: onSaveItemToFileClicked :: end")},loadSavedSessionsFromFile:function(a){console.log("SaveSession :: loadSavedSessionsFromFile :: begin for file \x3d ",
a);var k=null,c,d=0,e=this;c=new FileReader;c.onload=function(){var q=c.result;q?(k=b.parse(q),console.log("SaveSession :: loadSavedSessionsFromFile : sessions found ",k),f.forEach(k,function(a){e.isValidSessionName(a.name)||(a.name=e.getUniqueSessionName(a.name),console.log("SaveSession :: loadSavedSessionsFromFile :: session name changed to "+a.name));this.sessions.push(a);this.sessionTable.addRow(a);d+=1},e),e.storeSessions(),e.refreshLoadFileUI(),new u({message:String(d)+" sessions loaded from the file.",
type:"message"}),console.log("SaveSession :: loadSavedSessionsFromFile :: end for file \x3d ",a)):(console.warn("SaveSession :: loadSavedSessionsFromFile : no sessions to load"),new u({message:"No sessions found in the file.",type:"message"}))};c.readAsText(a)},loadSession:function(b){var k,c;b.webmapId&&b.webmapId!==this.map.itemId?(console.log("SaveSession :: loadSession :: changing webmap \x3d ",b.webmapId),k=t.subscribe("mapChanged",n.hitch(this,function(a){console.log("SaveSession :: loadSession :: map changed from  ",
this.map.itemId," to ",a.itemId);this.map=a;k.remove();this.loadSession(b)})),C.getInstance()._onMapChanged({itemId:b.webmapId})):(b.extent&&(c=new l(b.extent),this.map.setExtent(c).then(function(){console.log("SaveSession :: loadSession :: new extent  \x3d ",c)},function(){new u({message:a.substitute("An error occurred zooming to the ${name} map.",b),type:"error"})})),this.setAddedURL(b.addedURL),this.initOnlineDataItems(b.onlineDataItems),this.initLayersFields(b.layers),this.setSelectedCommunity(b),
this.initGeometryTypeAddedFeatLyr(b.layers),this.initLayersRenderer(b.layers),this.initVisibleLayersForDynamic(b.layers),this.initInfoTemplateForUploadedFile(b.layers),this.setGraphicsOnCurrentMap(b.graphics),b.toggleButtonTopics&&this.setToggleButtonTopics(b.toggleButtonTopics),b.chkLayerInSearchFilter&&this.setChkLayerInSearchFilter(b),b.chkLayerInBoundary&&this.setChkLayerInBoundary(b.chkLayerInBoundary),console.log("SaveSession :: loadSession :: session  \x3d ",b))},setAddedURL:function(a){urlArray=
a.split(";");index=0;for(len=urlArray.length;index<len;++index)singleURLArray=urlArray[index].split(","),urlTypeSelection=document.getElementById("urlTypeSelect"),null!=urlTypeSelection&&dijit.byId("urlTypeSelect").set("value",singleURLArray[1]),addURLText=document.getElementById("urlTextInput"),null!=addURLText&&(addURLText.value=singleURLArray[0]),addURLbutton=document.getElementById("addURLButton"),null!=addURLbutton&&addURLbutton.click()},setLayersVisibilityOpacity:function(a){f.forEach(a,function(a){var b=
"";0<=a.id.indexOf(window.layerIdPrefix)?b=a.id.replace(window.layerIdPrefix,""):0<=a.id.indexOf(window.layerIdPBSPrefix)&&(b=a.id.replace(window.layerIdPBSPrefix,""));layer=this.map.getLayer(a.id);if(null!=layer){if(null!=window.hashRenderer[b]){var k=new A(window.hashRenderer[b]);layer.setRenderer(k)}layer.setVisibility(a.isVisible);layer.setOpacity(a.opacity);if("ArcGISDynamicMapServiceLayer"==a.type){visible=[];for(var k=0,c=a.visibleLayers.length;k<c;k++)visible.push(a.visibleLayers[k]);layer.setVisibleLayers(visible)}layer.refresh();
console.log("SaveSession :: loadSession :: set visibility \x3d ",a.isVisible," for layer : id\x3d",layer.id);layerTile=this.map.getLayer(window.layerIdTiledPrefix+b);null!=layerTile&&(null==window.hashRenderer[b]&&layerTile.setVisibility(a.isVisible),layerTile.setOpacity(a.opacity),layerTile.refresh())}},this);y.getInstance(this.map,this.map.itemInfo).then(function(a){g.emit(a,"updated");a.onlayerInfosChanged()})},initOnlineDataItems:function(a){window.onlineDataTobeAdded=a},initLayersFields:function(a){f.forEach(a,
function(a){window.hashFieldsAddedFeatureLayer[a.id]=a.fields},this)},initGeometryTypeAddedFeatLyr:function(a){f.forEach(a,function(a){window.hashGeometryTypeAddedFeatLyr[a.id]=a.geometryType},this)},initLayersRenderer:function(a){f.forEach(a,function(a){window.hashRenderer[a.id.replace(window.layerIdPrefix,"")]=a.renderer},this)},initVisibleLayersForDynamic:function(a){f.forEach(a,function(a){window.hashVisibleLayersForDynamic[a.id.replace(window.layerIdPrefix,"")]=a.visibleLayers},this)},initInfoTemplateForUploadedFile:function(a){f.forEach(a,
function(a){window.hashInfoTemplate[a.id]=a.infoTemplateJson},this)},getSettingsForCurrentMap:function(){var b={name:"",webmapId:"",extent:null,layers:[],selectedCommunity:null,toggleButtonTopics:[],chkLayerInSearchFilter:[],toggleButtonPBSTopics:[],chkLayerInPBS:[],chkLayerInBoundary:[],graphics:[],addedURL:null,onlineDataItems:window.onlineDataAlreadyAdded};b.extent=this.map.extent;b.webmapId=this.map.itemId;b.selectedCommunity=this.getSelectedCommunity();b.graphics=this.getGraphicsForCurrentMap();
b.toggleButtonTopics=this.getToggleButtonTopics();b.chkLayerInSearchFilter=this.getChkLayerInSearchFilter();b.toggleButtonPBSTopics=this.getToggleButtonPBSTopics();b.chkLayerInPBS=this.getChkLayerInPBS();b.chkLayerInBoundary=this.getChkLayerInBoundary();b.addedURL=this.getAddedURL();this.getLayerSettingsForCurrentMap().then(function(a){b.layers=a;console.log("SaveSession :: getSettingsForCurrentMap :: layerSettings completed  \x3d ",a)},function(b){new u({message:a.substitute("An error getting the layers from the current map."),
type:"error"})});return b},getLayerSettingsForCurrentMap:function(){var a=new c;this.getLayerObjectsFromMap().then(n.hitch(this,function(b){console.log("SaveSession :: getLayerSettingsForCurrentMap :: layersObects  \x3d ",b);try{var k=[],c,d=b.layerObjects.length;f.forEach(b.layerObjects,function(a,b){c=this.getSettingsForLayer(a);c.order=d-b;k.push(c)},this);a.resolve(k)}catch(z){console.error("SaveSession :: getLayerSettingsForCurrentMap :: error getting layersObects  \x3d ",z),a.reject(z)}}),n.hitch(this,
function(b){console.error("SaveSession :: getLayerSettingsForCurrentMap :: error getting layersObects  \x3d ",b);a.reject(b)}));return a.promise},getSettingsForLayer:function(a){var b={id:a.id,name:a.name,type:"",isVisible:a.visible,opacity:a.opacity,visibleLayers:a.visibleLayers||null,url:a.url,fields:null,geometryType:null,options:null,renderer:null,infoTemplateJson:[]};b.type=this.getLayerType(a);b.renderer=window.hashRenderer[a.id.replace(window.layerIdPrefix,"")];b.fields=this.getFieldssForFeatureLayer(a);
b.geometryType=this.getGeometryTypeForFeatureLayer(a);b.infoTemplateJson=this.getinfoTemplateForUploadedFile(a);console.log("SaveSession :: getSettingsForCurrentMap :: settings ",b," added for layer \x3d ",a.id);return b},getFieldssForFeatureLayer:function(a){var b=hashFieldsAddedFeatureLayer[a.id];console.log("SaveSession :: getFieldssForFeatureLayer :: fields \x3d  ",b," for layer \x3d ",a.id);return b},getGeometryTypeForFeatureLayer:function(a){var b=hashGeometryTypeAddedFeatLyr[a.id];console.log("SaveSession :: getGeometryTypeForFeatureLayer :: geometryType \x3d  ",
b," for layer \x3d ",a.id);return b},getinfoTemplateForUploadedFile:function(a){var b=hashInfoTemplate[a.id];console.log("SaveSession :: getinfoTemplateForUploadedFile :: infoTemplateJson \x3d  ",b," for layer \x3d ",a.id);return b},getSelectedCommunity:function(){var a=null,a=window.communitySelected;console.log("SaveSession :: getSelectedCommunity :: "+a);return a},getGraphicsForCurrentMap:function(){var a=[],b,c;c=this.getSettingsFromGraphicsLayer(this.map.graphics);a.push(c);f.forEach(this.map.graphicsLayerIds,
function(d){b=this.map.getLayer(d);0<b.graphics.length&&(c=this.getSettingsFromGraphicsLayer(b),a.push(c))},this);console.log("SaveSession :: getGraphicsForCurrentMap :: settings added for graphics \x3d ",a);return a},getToggleButtonTopics:function(){var a=[];for(i in window.allLayerNumber)if(lyr=this.map.getLayer(window.layerIdPrefix+window.allLayerNumber[i]))topicWholeName=window.hashTopic[window.allLayerNumber[i]],topicShortName=window.topicDicESB[topicWholeName],0>a.indexOf(topicShortName)&&a.push(topicShortName);
return a},getChkLayerInSearchFilter:function(){var a=[];for(i in window.allLayerNumber)if(lyr=this.map.getLayer(window.layerIdPrefix+window.allLayerNumber[i]))chkBoxIndex=window.allLayerNumber[i],0>a.indexOf(chkBoxIndex)&&a.push(chkBoxIndex);return a},getToggleButtonPBSTopics:function(){var a=[];for(i in window.allLayerNumber)if(lyr=this.map.getLayer(window.layerIdPBSPrefix+window.allLayerNumber[i]))topicWholeName=window.hashTopicPBS[window.allLayerNumber[i]],topicShortName=window.topicDicPBS[topicWholeName],
0>a.indexOf(topicShortName)&&a.push(topicShortName);return a},getChkLayerInPBS:function(){var a=[];for(i in window.allLayerNumber)if(lyr=this.map.getLayer(window.layerIdPBSPrefix+window.allLayerNumber[i]))chkBoxIndex=window.allLayerNumber[i],0>a.indexOf(chkBoxIndex)&&a.push(chkBoxIndex);return a},getChkLayerInBoundary:function(){var a=[];for(i in window.allLayerNumber)if(lyr=this.map.getLayer(window.layerIdBndrPrefix+window.allLayerNumber[i]))chkBoxIndex=window.allLayerNumber[i],0>a.indexOf(chkBoxIndex)&&
a.push(chkBoxIndex);return a},getAddedURL:function(){var a="",b;for(b in window.hashAddedURLToType)window.hashAddedURLToType.hasOwnProperty(b)&&(a=a+b+","+window.hashAddedURLToType[b]+";");return a=a.substring(0,a.length-1)},getSettingsFromGraphicsLayer:function(a){var b={id:a.id,graphics:[]};-1<a.id.indexOf(window.uploadedFeatLayerIdPrefix)&&f.forEach(a.graphics,function(a){b.graphics.push(a.toJson())},this);console.log("SaveSession :: getSettingsFromGraphicsLayer :: settings ",b," added for graphicLayer \x3d ",
a);return b},setSelectedCommunity:function(a){window.communitySelected=a.selectedCommunity;this.publishData({message:"updateCommunityLayers"})},setGraphicsOnCurrentMap:function(a){var b;b=function(a,b){f.forEach(b.graphics,function(b){b=new m(b);a.add(b)},this)};f.forEach(a,function(a,c){if(-1<a.id.indexOf(window.uploadedFeatLayerIdPrefix)){createdFields=[];fieldsArray=window.hashFieldsAddedFeatureLayer[a.id].split(";");index=0;for(len=fieldsArray.length;index<len;++index)c={},singleFieldArray=fieldsArray[index].split(":"),
"FID"==singleFieldArray[0].toUpperCase()?(c.name=singleFieldArray[0],c.alias=singleFieldArray[0],c.type="esriFieldTypeOID"):singleFieldArray[0].toUpperCase().indexOf("OBJECTID")?(c.name=singleFieldArray[0],c.alias=singleFieldArray[0],c.type="esriFieldTypeOID"):(c.name=singleFieldArray[0],c.alias=singleFieldArray[0],c.type=singleFieldArray[1]),createdFields.push(c);c={geometryType:hashGeometryTypeAddedFeatLyr[a.id],spatialReference:{wkid:this.map.spatialReference.wkid},fields:createdFields,features:[]};
console.log(c.features);c=new esri.tasks.FeatureSet(c);c={layerDefinition:{geometryType:hashGeometryTypeAddedFeatLyr[a.id],fields:createdFields},featureSet:c};"esriGeometryPoint"==hashGeometryTypeAddedFeatLyr[a.id]&&0<=hashFieldsAddedFeatureLayer[a.id].indexOf("__OBJECTID")&&(c.layerDefinition.drawingInfo={renderer:{type:"simple",symbol:{type:"esriPMS",url:"http://static.arcgis.com/images/Symbols/Basic/RedSphere.png",imageData:"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\x3d",
contentType:"image/png",width:15,height:15}}});if(null==window.hashInfoTemplate[a.id])c=new esri.layers.FeatureLayer(c,{mode:esri.layers.FeatureLayer.MODE_SNAPSHOT,id:a.id,title:a.id.replace(window.uploadedFeatLayerIdPrefix,"")});else{var d=new B(window.hashInfoTemplate[a.id]);c=new esri.layers.FeatureLayer(c,{mode:esri.layers.FeatureLayer.MODE_SNAPSHOT,id:a.id,title:a.id.replace(window.uploadedFeatLayerIdPrefix,""),infoTemplate:d})}b(c,a);this.map.addLayer(c)}},this);console.log("SaveSession :: setGraphicsOnCurrentMap :: graphics added to the map")},
setToggleButtonTopics:function(a){index=0;for(len=a.length;index<len;++index){var b=document.getElementById(window.chkTopicPrefix+a[index]);null!=b&&(1==b.checked&&b.click(),b.click())}},setChkLayerInSearchFilter:function(a){function b(){setTimeout(function(){bIsDynamicLayer=!1;layerType="";f.forEach(layersInfo,function(a){0<=a.id.indexOf(window.layerIdPrefix)&&(eaId=a.id.replace(window.layerIdPrefix,""),eaId==settings[c]&&(layerType=a.type))});chkbox=document.getElementById(window.chkSelectableLayer+
settings[c]);null!=chkbox&&(console.log("check on chkbox:"+window.chkSelectableLayer+settings[c]),x.checkOnCheckbox(chkbox));c++;c<settings.length&&b()},3E3)}settings=a.chkLayerInSearchFilter;layersInfo=a.layers;var c=0;b()},setToggleButtonPBSTopics:function(a){index=0;for(len=a.length;index<len;++index){var b=document.getElementById(window.chkTopicPBSPrefix+a[index]);1==b.checked&&b.click();b.click()}},setChkLayerInPBS:function(a){index=0;for(len=a.length;index<len;++index)chkbox=document.getElementById(window.chkSelectableLayer+
a[index]),null!=chkbox&&x.checkOnCheckbox(chkbox)},setChkLayerInBoundary:function(a){index=0;for(len=a.length;index<len;++index)chkbox=document.getElementById(window.chkSelectableLayer+a[index]),null!=chkbox&&x.checkOnCheckbox(chkbox)},clearAllGraphicsOnMap:function(){this.map.graphics.clear();f.forEach(this.map.graphicsLayerIds,function(a){a=this.map.getLayer(a);this.map.removeLayer(a)},this);console.log("SaveSession :: clearAllGraphicsOnMap :: graphics removed from the map")},storeSessions:function(){var a=
b.stringify(this.sessions);localStorage.setItem(this.storageKey,a);console.log("SaveSession :: storeSessions :: completed")},loadSavedSessionsFromStorage:function(){var a="",a=null;(a=localStorage.getItem("sessions"))?(a=b.parse(a),console.log("SaveSession :: loadSavedSessionsFromStorage : sessions found ",a),this.sessions=a,console.log("SaveSession :: loadSavedSessionsFromStorage : end")):console.log("SaveSession :: loadSavedSessionsFromStorage : no stored sessions to load")},getLayerObjectsFromMap:function(){return y.getInstance(this.map,
this.map.itemInfo).then(function(a){var b=[],c=[],b=a.getLayerInfoArray(),c=f.map(b,function(a){return a.getLayerObject()});return e(c).then(function(c){var d=[];f.forEach(c,function(a,c){a.id=a.id||b[c].id;d.push(a)});return{layerInfosObject:a,layerInfos:b,layerObjects:d}})})},getLayerType:function(a){var b=[],b="";if(!a)return"";b=a.declaredClass.split(".");return b=b[b.length-1]}})});