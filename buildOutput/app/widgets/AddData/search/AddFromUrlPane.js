//>>built
require({cache:{"url:widgets/AddData/search/templates/AddFromUrlPane.html":'\x3cdiv class\x3d"secondary-pane add-url-pane"\x3e\r\n  \x3cdiv class\x3d"add-url-pane-container"\x3e\r\n    \x3cdiv class\x3d"add-url-pane-container--inner"\x3e\r\n      \x3clabel for\x3d"${id}_select"\x3e${i18n.addFromUrl.type}\x3c/label\x3e\r\n      \x3cselect id\x3d"${id}_select"\r\n        data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"typeSelect"\x3e\r\n        \x3coption value\x3d"ArcGIS" selected\x3d"selected"\x3e${i18n.addFromUrl.types.ArcGIS}\x3c/option\x3e\r\n        \x3coption value\x3d"WMS"\x3e${i18n.addFromUrl.types.WMS}\x3c/option\x3e\r\n        \x3c!--not yet supported \x3coption value\x3d"WMTS"\x3e${i18n.addFromUrl.types.WMTS}\x3c/option\x3e --\x3e\r\n        \x3c!--not yet supported \x3coption value\x3d"WFS"\x3e${i18n.addFromUrl.types.WFS}\x3c/option\x3e --\x3e\r\n        \x3coption value\x3d"KML"\x3e${i18n.addFromUrl.types.KML}\x3c/option\x3e\r\n        \x3coption value\x3d"GeoRSS"\x3e${i18n.addFromUrl.types.GeoRSS}\x3c/option\x3e\r\n        \x3coption value\x3d"CSV"\x3e${i18n.addFromUrl.types.CSV}\x3c/option\x3e\r\n      \x3c/select\x3e\r\n\t\x3cdiv\x3e\r\n      \x3clabel for\x3d"${id}_url"\x3e${i18n.addFromUrl.url}\x3c/label\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"small-gap"\x3e\r\n      \x3cinput id\x3d"${id}_url" type\x3d"text" class\x3d"url-textbox jimu-input"\r\n          data-dojo-attach-point\x3d"urlTextBox" data-dojo-attach-event\x3d"oninput:_findServiceName"\x3e\r\n    \x3c/div\x3e \r\n\t\x3cdiv data-dojo-attach-point\x3d"lNameFrame" class\x3d"gap" style\x3d"display: none"\x3e\r\n        \x3clabel for\x3d"${id}_name"\x3e${i18n.addFromUrl.name}\x3c/label\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"customName" class\x3d"small-gap"\x3e\r\n          \x3cinput id\x3d"${id}_name" type\x3d"text" class\x3d"url-textbox jimu-input"\r\n                 data-dojo-attach-point\x3d"nameTextBox"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"action-bar"\x3e\r\n        \x3ca class\x3d"jimu-float-leading" href\x3d"javascript:void(0)"\r\n          data-dojo-attach-point\x3d"examplesExpander"\r\n          data-dojo-attach-event\x3d"onClick: examplesExpanderClicked"\r\n          \x3e${i18n.addFromUrl.samplesHint}\x3c/a\x3e\r\n        \x3ca class\x3d"jimu-btn"\r\n          href\x3d"javascript:void(0)"\r\n          data-dojo-attach-point\x3d"addButton"\r\n          data-dojo-attach-event\x3d"onClick: addClicked"\r\n          \x3e${i18n.search.item.actions.add}\r\n        \x3c/a\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"examples" data-dojo-attach-point\x3d"examplesNode"\x3e\r\n        \x3cdiv data-examples-type\x3d"ArcGIS"\x3e\r\n          \x3cdiv\x3ehttp://services.arcgis.com/P3ePLMYs2RVChkJx/arcgis/rest/services/World_Cities/FeatureServer/0\x3c/div\x3e\r\n          \x3cdiv\x3ehttp://services.arcgisonline.com/ArcGIS/rest/services/Demographics/USA_Tapestry/MapServer\x3c/div\x3e\r\n          \x3cdiv\x3ehttp://imagery.arcgisonline.com/ArcGIS/rest/services/LandsatGLS/VegetationAnalysis/ImageServer\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-examples-type\x3d"WMS"\x3e\r\n          \x3cdiv\x3ehttp://mesonet.agron.iastate.edu/cgi-bin/wms/nexrad/n0r.cgi?service\x3dWMS\x26amp;request\x3dGetCapabilities\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-examples-type\x3d"KML"\x3e\r\n          \x3cdiv\x3ehttp://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/2.5_month_age_animated.kml\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-examples-type\x3d"GeoRSS"\x3e\r\n          \x3cdiv\x3ehttp://www.gdacs.org/xml/rss.xml\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-examples-type\x3d"CSV"\x3e\r\n          \x3cdiv\x3ehttp://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/2.5_week.csv\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n'}});
define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/keys dojo/Deferred dojo/promise/all dojo/dom-class dojo/window dojo/dom dojo/dom-style dijit/Viewport dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/AddFromUrlPane.html dojo/i18n!../nls/strings ./LayerLoader ./util esri/layers/ArcGISDynamicMapServiceLayer esri/layers/ArcGISImageServiceLayer esri/layers/ArcGISTiledMapServiceLayer esri/layers/CSVLayer esri/layers/FeatureLayer esri/layers/GeoRSSLayer esri/layers/ImageParameters esri/layers/KMLLayer esri/layers/StreamLayer esri/layers/VectorTileLayer esri/layers/WFSLayer esri/layers/WMSLayer esri/layers/WMTSLayer esri/InfoTemplate jimu/WidgetManager jimu/dijit/Message dijit/form/Select".split(" "),
function(w,t,p,W,n,x,y,z,k,A,X,q,B,C,D,E,F,l,G,H,I,J,K,L,u,M,N,O,P,v,Q,R,S,r,T,U,Y){var V={id:"widgets_TimeSlider_Widget_32",uri:"widgets/TimeSlider/Widget"};return w([C,D,E],{i18n:l,templateString:F,wabWidget:null,_dfd:null,postCreate:function(){this.inherited(arguments);this._updateExamples("ArcGIS");var a=this;this.own(n(this.urlTextBox,"keyup",function(c){c.keyCode===x.ENTER?a.addClicked():k.contains(a.addButton,"disabled")||a._setStatus("")}));this.own(n(this.urlTextBox,"focus",function(){try{a.urlTextBox.select()}catch(c){}}));
this.own(n(this.typeSelect,"change",function(c){a._updateExamples(c)}));this.own(n(this.typeSelect.dropDown,"open",function(){var a=this.domNode.parentElement;a&&k.add(a,"add-data-widget-popup")}));this.own(B.on("resize",a.resize()))},destroy:function(){this.inherited(arguments)},addClicked:function(){var a=this,c=!1,d=this.addButton;if(!k.contains(d,"disabled")){var e=this.typeSelect.get("value"),g=t.trim(this.urlTextBox.value);0<g.length&&(0===g.indexOf("http://")||0===g.indexOf("https://"))&&(c=
!0);c&&(window.hashAddedURLToType[g]=e,a._setStatus(l.search.item.messages.adding),c=new y,this._handleAdd(c,this.wabWidget.map,e,g),c.then(function(b){b?a._setStatus(""):a._setStatus(l.search.item.messages.addFailed);k.remove(d,"disabled")}).otherwise(function(b){"string"===typeof b&&"Unsupported"===b?(a._setStatus(l.search.item.messages.unsupported),k.remove(d,"disabled")):(console.warn("Add layer failed."),console.warn(b),a._setStatus(l.search.item.messages.addFailed),k.remove(d,"disabled"),b&&
"string"===typeof b.message&&0<b.message.length&&(a._setStatus(b.message),console.log(""),g in window.faildedOutsideLayerDictionary||(window.faildedOutsideLayerDictionary[g]=g),a.AddData.publishData({message:"openFailedLayer"})))}))}},examplesExpanderClicked:function(){k.toggle(this.examplesNode,"show")},preHide:function(){},resize:function(){var a=A.getBox(this.ownerDocument);a&&"undefined"!==typeof a.w&&(600<a.w?k.add(this.urlTextBox,"url-textbox-wide"):k.remove(this.urlTextBox,"url-textbox-wide"))},
_findServiceName:function(a){var c=a.target.value;""==a.target.value?q.set(this.lNameFrame,"display","none"):0<c.indexOf("/MapServer")?(q.set(this.lNameFrame,"display","block"),a=c.split("/"),this.nameTextBox.value="MapServer"==a[a.length-2]?a[a.length-3]+"-"+a[a.length-1]:a[a.length-2]):0<c.indexOf("/FeatureServer")?(q.set(this.lNameFrame,"display","block"),a=c.split("/"),this.nameTextBox.value="FeatureServer"==a[a.length-2]?a[a.length-3]+"-"+a[a.length-1]:a[a.length-2]):0<c.indexOf("/ImageServer")&&
(q.set(this.lNameFrame,"display","block"),a=c.split("/"),this.nameTextBox.value=a[a.length-2])},_handleAdd:function(a,c,d,e){e=H.checkMixedContent(e);var g=e.toLowerCase(),b=new G,h=this.nameTextBox.value;""==h.trim()&&(window.addedLayerIndex+=1,h=window.addedLayerIdPrefix+window.addedLayerIndex.toString());window.hashAddedURLToId[e]=h;var k=this,f=null;"ArcGIS"===d?0<g.indexOf("/featureserver")||0<g.indexOf("/mapserver")?b._readRestInfo(e).then(function(m){if(m&&void 0!=m.timeInfo)timeAwareLayer=
new esri.layers.FeatureLayer(e,{mode:esri.layers.FeatureLayer.MODE_SNAPSHOT,outFields:["*"]}),timeAwareLayer.id=window.timeSliderLayerId,timeAwareLayer.on("update-end",function(a){var b=T.getInstance();b.loadWidget(V).then(t.hitch(this,function(a){a.setPosition({relativeTo:"map",bottom:"50px",left:"100px"});b.openWidget(a)}))}),c.addLayers([timeAwareLayer]);else if(m&&"string"===typeof m.type&&"Feature Layer"===m.type)f=new u(e,{id:h,outFields:["*"],infoTemplate:new r}),k._waitThenAdd(a,c,d,b,f);
else if(0<g.indexOf("/featureserver")){var l=[];p.forEach(m.layers,function(a){a=new u(e+"/"+a.id,{id:b._generateLayerId(),outFields:["*"],infoTemplate:new r});l.push(b._waitForLayer(a));window.hashAddedURLToId[e]=a.id});p.forEach(m.tables,function(a){a=new u(e+"/"+a.id,{id:b._generateLayerId(),outFields:["*"]});l.push(b._waitForLayer(a))});z(l).then(function(d){var f=[];p.forEach(d,function(a){f.push(a)});f.reverse();p.forEach(f,function(a){b._setFeatureLayerInfoTemplate(a);a.xtnAddData=!0;window.layerID_Portal_WebMap.push(a.id);
window.hashAddedURLToId[e]=a.id;c.addLayer(a)});a.resolve(f)}).otherwise(function(b){a.reject(b)})}else if(0<g.indexOf("/mapserver")){if(m.tileInfo)f=new K(e,{id:h});else{var n={id:h};m&&m.supportedImageFormatTypes&&-1!==m.supportedImageFormatTypes.indexOf("PNG32")&&(n.imageParameters=new N,n.imageParameters.format="png32");f=new I(e,n)}k._waitThenAdd(a,c,d,b,f)}}).otherwise(function(b){a.reject(b)}):0<g.indexOf("/imageserver")?(f=new J(e,{id:h}),this._waitThenAdd(a,c,d,b,f)):0<g.indexOf("/vectortileserver")||
0<g.indexOf("/resources/styles/root.json")?v&&v.supported()?b._checkVectorTileUrl(e,{}).then(function(e){f=new v(e,{id:h});k._waitThenAdd(a,c,d,b,f)}).otherwise(function(b){a.reject(b)}):a.reject("Unsupported"):0<g.indexOf("/streamserver")?(f=new P(e,{id:h,purgeOptions:{displayCount:1E4},infoTemplate:new r}),this._waitThenAdd(a,c,d,b,f)):a.reject("Unsupported"):"WMS"===d?(f=new R(e,{id:h}),this._waitThenAdd(a,c,d,b,f)):"WMTS"===d?f=new S(e,{id:h}):"WFS"===d?(f=new Q({id:h,url:e,infoTemplate:new r}),
this._waitThenAdd(a,c,d,b,f),console.warn("WFSLayer",f)):"KML"===d?(f=new O(e,{id:h}),this._waitThenAdd(a,c,d,b,f)):"GeoRSS"===d?(f=new M(e,{id:h}),this._waitThenAdd(a,c,d,b,f)):"CSV"===d&&(f=new L(e,{id:h}),f.setInfoTemplate(b._newInfoTemplate()),this._waitThenAdd(a,c,d,b,f))},_persist:function(){try{var a=this.typeSelect.get("value"),c=t.trim(this.urlTextBox.value);this.wabWidget.xtnAddFromUrlPane={type:a,url:c}}catch(d){}},_restore:function(){try{var a=this.wabWidget.xtnAddFromUrlPane;a&&"string"===
typeof a.type&&0<a.type.length&&this.typeSelect.set("value",a.type);a&&"string"===typeof a.url&&0<a.url.length&&(this.urlTextBox.value=a.url)}catch(c){}},_setStatus:function(a){this.wabWidget&&this.wabWidget._setStatus(a)},_showLayers:function(){this.wabWidget&&this.wabWidget.showLayers()},_updateExamples:function(a){p.forEach(this.examplesNode.children,function(c){var d=c.getAttribute("data-examples-type");"string"===typeof d&&0<d.length&&(c.style.display=d===a?"":"none")})},_waitThenAdd:function(a,
c,d,e,g){e._waitForLayer(g).then(function(b){if("WMS"===d)e._setWMSVisibleLayers(b);else if(!b||"esri.layers.ArcGISDynamicMapServiceLayer"!==b.declaredClass&&"esri.layers.ArcGISTiledMapServiceLayer"!==b.declaredClass)b&&"esri.layers.FeatureLayer"===b.declaredClass?e._setFeatureLayerInfoTemplate(b):b&&"esri.layers.CSVLayer"===b.declaredClass&&e._setFeatureLayerInfoTemplate(b);window.layerID_Portal_WebMap.push(b.id);b.xtnAddData=!0;b.title=b.id;if("KML"===d){var h=c.spatialReference,g=b._outSR;h&&g&&
(h.equals(g)||h.isWebMercator()&&4326===g.wkid||g.isWebMercator()&&4326===h.wkid)?c.addLayer(b):new U({titleLabel:l._widgetLabel,message:l.addFromFile.kmlProjectionMismatch})}else c.addLayer(b);a.resolve(b)}).otherwise(function(b){a.reject(b)})}})});