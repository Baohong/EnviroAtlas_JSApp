//>>built
require({cache:{"url:widgets/AddWebMapData/ItemTable.html":'\x3cdiv\x3e\r\n    \x3cdiv class\x3d"items-section all-items-section" data-dojo-attach-point\x3d"allItemsSection"\x3e\r\n        \x3cdiv class\x3d"items-table-div" data-dojo-attach-point\x3d"allItemsTableDiv" data-dojo-attach-event\x3d"onscroll:_onAllItemsSectionScroll"\x3e\r\n            \x3ctable class\x3d"items-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"allItemsTable" data-dojo-attach-event\x3d"onclick:_onItemsTableClicked"\x3e\r\n                \x3ctbody data-dojo-attach-point\x3d"allItemTbody"\x3e\x3c/tbody\x3e\r\n            \x3c/table\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"allItemsShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"items-section filtered-items-section" data-dojo-attach-point\x3d"filteredItemsSection"\x3e\r\n        \x3cdiv class\x3d"items-table-div" data-dojo-attach-point\x3d"filteredItemsTableDiv" data-dojo-attach-event\x3d"onscroll:_onFilteredItemsSectionScroll"\x3e\r\n            \x3ctable class\x3d"items-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"filteredItemsTable" data-dojo-attach-event\x3d"onclick:_onItemsTableClicked"\x3e\r\n                \x3ctbody data-dojo-attach-point\x3d"filteredItemsTbody"\x3e\x3c/tbody\x3e\r\n            \x3c/table\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"search-none-tip-section" data-dojo-attach-point\x3d"searchNoneTipSection" style\x3d"display:none;"\x3e\r\n            \x3cspan class\x3d"search-none-icon jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\r\n            \x3cspan class\x3d"search-none-tip jimu-state-error-text"\x3e${nls.searchNone}\x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"filteredItemShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e'}});
define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./ItemTable.html dojo/Evented dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/Deferred dojo/query dojo/NodeList-traverse dojo/on jimu/utils jimu/portalUtils jimu/portalUrlUtils jimu/dijit/LoadingIndicator dijit/Dialog dijit/form/Button jimu/WidgetManager".split(" "),function(q,r,t,u,v,w,d,m,c,A,f,B,C,x,k,y,D,E,F,z){return q([r,t,u,w],{templateString:v,baseClass:"jimu-item-table",
query:null,filteredQuery:null,portalUrl:null,hidden:!1,nls:null,types:"",typeKeywords:"",_defaultThumbnail:{"Web Mapping Application":"webapp.png","Mobile Application":"mobileapp.png"},postMixInProperties:function(){this.nls=window.jimuNls.itemSelector},postCreate:function(){this.inherited(arguments);this.types&&0<this.types.length||(this.types=[]);(this.hidden=!0===this.hidden)&&this.hide();this.portalUrl&&(this.portalUrl=y.getStandardPortalUrl(this.portalUrl));this.showAllItemsSection();this.searchAllItems()},
show:function(){c.setStyle(this.domNode,"display","block")},hide:function(){c.setStyle(this.domNode,"display","none")},searchAllItems:function(a){this.showAllItemsSection();a&&(this.query=d.mixin({},a),this.query.start=1,this.clearAllItemsSection());this.portalUrl&&this.query&&0<this.query.start&&(this.allItemsShelter.show(),k.getPortal(this.portalUrl).queryItems(this.query).then(d.hitch(this,function(a){this.domNode&&(this.allItemsShelter.hide(),this.query.start=a.nextStart,this._createItems(a,this.allItemTbody))}),
d.hitch(this,function(a){console.error(a);this.domNode&&this.allItemsShelter.hide()})))},searchFilteredItems:function(a){this.showFilterItemsSection();a&&(this.filteredQuery=d.clone(a),this.filteredQuery.start=1,this.clearFilteredItemsSection());this.portalUrl&&this.filteredQuery&&0<this.filteredQuery.start&&(this.filteredItemShelter.show(),k.getPortal(this.portalUrl).queryItems(this.filteredQuery).then(d.hitch(this,function(b){this.domNode&&(this.showFilterItemsSection(),a&&this.clearFilteredItemsSection(),
this.filteredQuery.start=b.nextStart,this._createItems(b,this.filteredItemsTbody),this._filterItemCallback())}),d.hitch(this,function(a){console.error(a);this.domNode&&this._filterItemCallback()})))},_filterItemCallback:function(){this.filteredItemShelter.hide();0<this._getItemCount(this.filteredItemsTbody)?(c.setStyle(this.filteredItemsTableDiv,"display","block"),c.setStyle(this.searchNoneTipSection,"display","none")):(c.setStyle(this.filteredItemsTableDiv,"display","none"),c.setStyle(this.searchNoneTipSection,
"display","block"))},clear:function(){this.clearAllItemsSection();this.clearFilteredItemsSection()},clearAllItemsSection:function(){c.empty(this.allItemTbody)},clearFilteredItemsSection:function(){c.empty(this.filteredItemsTbody)},showAllItemsSection:function(){c.setStyle(this.allItemsSection,"display","block");c.setStyle(this.filteredItemsSection,"display","none")},showFilterItemsSection:function(){c.setStyle(this.allItemsSection,"display","none");c.setStyle(this.filteredItemsSection,"display","block");
c.setStyle(this.filteredItemsTableDiv,"display","block");c.setStyle(this.searchNoneTipSection,"display","none")},_onAllItemsSectionScroll:function(){this._isScrollToBottom(this.allItemsTableDiv)&&this.searchAllItems()},_onFilteredItemsSectionScroll:function(){this._isScrollToBottom(this.filteredItemsTableDiv)&&this.searchFilteredItems()},_isScrollToBottom:function(a){return x.isScrollToBottom(a)},_createItems:function(a,b){a=a.results;var n=m.map(this.types,d.hitch(this,function(a){return a.toLowerCase()}));
a=m.filter(a,d.hitch(this,function(a){a=a.type&&a.type.toLowerCase()||"";return 0<=m.indexOf(n,a)}));if(0!==a.length){var e,h=f("td.empty",b),g;if(0<h.length){var p=Math.min(a.length,h.length),l=a.splice(0,p);for(g=0;g<p;g++){var k=h[g];e=this._createItem(l[g]);c.place(e,k);c.removeClass(k,"empty")}}if(0!==a.length)for(g=0;g<a.length;g++)if(e=c.toDom("\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e"),c.place(e,b),h=f("td",e)[0],e=a[g])e=this._createItem(e),c.place(e,h)}},_getItemCount:function(a){return f(".item",
a).length},_createItem:function(a){var b=c.toDom('\x3cdiv class\x3d"item"\x3e\x3cdiv class\x3d"item-thumbnail jimu-auto-vertical"\x3e\x3cdiv class\x3d"none-thumbnail-tip jimu-auto-vertical-content"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"item-info"\x3e\x3cdiv class\x3d"item-name"\x3e\x3c/div\x3e\x3cdiv class\x3d"item-snippet"\x3e\x3c/div\x3e\x3ca class\x3d"item-details" target\x3d"_blank"\x3e\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e');b.item=a;var n=f(".item-thumbnail",b)[0],e=f(".item-name",b)[0],
h=f(".item-snippet",b)[0],g=f(".item-details",b)[0],d=f(".none-thumbnail-tip",b)[0];if(!a.thumbnailUrl){var l=this._defaultThumbnail[a.type];l&&(a.thumbnailUrl=require.toUrl("jimu")+"/images/"+l)}a.thumbnailUrl?c.setStyle(n,"backgroundImage","url("+a.thumbnailUrl+")"):d.innerHTML=this.nls.noneThumbnail;e.innerHTML=a.title;e.title=e.innerHTML;h.innerHTML="\x3cdiv\x3e\x3cp\x3e"+a.snippet+"\x3c/p\x3e\x3c/div\x3e";h.title=a.snippet;g.innerHTML="Add to map";return b},showDetails:function(a,b){var d,e=
selfAddWebMapData.appConfig.getConfigElementsByName("FeaturedCollectionPreview")[0];d=z.getInstance();var f=dojo.byId("itemIDdiv").innerHTML;1==window.fcDetailsOpened&&f==b.id?(d.closeWidget(e.id),document.getElementById("titleForFCWidget").style.display="none",document.getElementById("closeFCWidgetArea").style.display="none",window.fcDetailsOpened=!1):(1==window.fcDetailsFirstCreated&&(d.closeWidget(e.id),window.fcDetailsFirstCreated=!1),d.openWidget(e.id),document.getElementById("titleForFCWidget").style.display=
"",document.getElementById("closeFCWidgetArea").style.display="",document.getElementById("closeFCWidget").style.display="",d.activateWidget(e.id),window.fcDetailsOpened=!0);dojo.byId("itemIDdiv").innerHTML=b.id;dojo.byId("detailsThumbnailDiv").innerHTML="\x3cimage alt\x3d'Item Thumbnail' style\x3d'border:1px solid black' src\x3d'"+b.thumbnailUrl+"'\x3e";dojo.byId("detailsTitleDiv").innerHTML="\x3ch1\x3e"+b.title+"\x3c/h1\x3e";dojo.byId("detailsOwnerDiv").innerHTML="by \x3ca target\x3d'_blank' href\x3d'"+
b.ownerPageUrl+"'\x3e"+b.owner+"\x3c/a\x3e\x3c/div\x3e";d=new Date(b.modified);dojo.byId("detailsDateDiv").innerHTML="Last Updated: "+d.toDateString()+"\x3cbr/\x3e\x3chr/\x3e";dojo.byId("detailsSnippetDiv").innerHTML=b.snippet;dojo.byId("detailsDescriptionDiv").innerHTML=b.description;dijit.byId("addButton").label="Add to map";dijit.byId("addButton").onClick=function(){a.emit("item-selected",b)};dijit.byId("agolButton").label="View in GeoPlatform";dijit.byId("agolButton").onClick=function(){window.open(b.detailsPageUrl,
"_blank")};dojo.byId("featuredLayerList").innerHTML="\x3cimage alt\x3d'loading...' src\x3d'./widgets/AddWebMapData/images/loading.gif'\x3e";b.getItemData().then(function(a){dojo.byId("featuredLayerList").innerHTML="";var b="\x3cul\x3e";layersReversed=a.operationalLayers.reverse();layersReversed.forEach(function(a){b+="\x3cli\x3e"+a.title+"\x3c/li\x3e"});b+="\x3cul\x3e";a=c.toDom(b);c.place(a,dojo.byId("featuredLayerList"))})},_onItemsTableClicked:function(a){a=a.target||a.srcElement;var b=f(a).parents(".item")[0];
b&&(c.hasClass(a,"item-details")?(f(".item.jimu-state-active",this.domNode).removeClass("jimu-state-active"),c.addClass(b,"jimu-state-active"),this.emit("item-selected",b.item)):this.showDetails(this,b.item))},getSelectedItem:function(){var a=null,b=f(".item.jimu-state-active",this.domNode);0<b.length&&(a=d.mixin({},b[0].item));return a}})});