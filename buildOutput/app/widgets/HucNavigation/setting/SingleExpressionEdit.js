//>>built
require({cache:{"url:widgets/HucNavigation/setting/SingleExpressionEdit.html":'\x3cdiv style\x3d"width:100%;"\x3e\r\n  \x3cdiv class\x3d"error-message-div" data-dojo-attach-point\x3d"errorMessage"\x3e\x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"singleExpressionsSection"\x3e\r\n    \x3ctable class\x3d"input-table" style\x3d"width:100%;" cellspacing\x3d"0"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd colspan\x3d"3"\x3e\r\n            \x3ctable style\x3d"width:100%;" cellspacing\x3d"0"\x3e\r\n              \x3ctr\x3e\r\n                \x3ctd style\x3d"width:50%;"\x3e\r\n                  \x3ctable style\x3d"width:100%;" cellspacing\x3d"0"\x3e\r\n                    \x3ctbody\x3e\r\n                      \x3ctr\x3e\r\n                        \x3ctd style\x3d"width:125px;text-align:left;"\x3e\r\n                          \x3cspan\x3e${nls.expressionAlias}\x3c/span\x3e\r\n                        \x3c/td\x3e\r\n                        \x3ctd style\x3d"width:auto; padding-left:8px;"\x3e\r\n                          \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-attach-point\x3d"expressionAlias" style\x3d"width:100%;" placeholder\x3d"Example: Parcel Number" data-dojo-props\x3d"required:true,trim:true,intermediateChanges:true"/\x3e\r\n                        \x3c/td\x3e\r\n                      \x3c/tr\x3e\r\n                    \x3c/tbody\x3e\r\n                  \x3c/table\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd style\x3d"width:50%;"\x3e\r\n                  \x3ctable style\x3d"width:100%;" cellspacing\x3d"0"\x3e\r\n                    \x3ctbody\x3e\r\n                      \x3ctr\x3e\r\n                        \x3ctd style\x3d"width:135px;text-align:left;"\x3e\r\n                          \x3cspan style\x3d"margin-left:20px;"\x3e${nls.searchLabel}\x3c/span\x3e\r\n                        \x3c/td\x3e\r\n                        \x3ctd style\x3d"width:auto;"\x3e\r\n                          \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-attach-point\x3d"searchLabel" style\x3d"width:100%;" placeholder\x3d"Example: Search by Parcel Number" data-dojo-props\x3d"required:true,trim:true,intermediateChanges:true"/\x3e\r\n                        \x3c/td\x3e\r\n                      \x3c/tr\x3e\r\n                    \x3c/tbody\x3e\r\n                  \x3c/table\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n            \x3c/table\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd colspan\x3d"3"\x3e\r\n            \x3ctable style\x3d"width:100%;" cellspacing\x3d"0"\x3e\r\n              \x3ctbody\x3e\r\n                \x3ctr\x3e\r\n                  \x3ctd style\x3d"width:auto;vertical-align:top;"\x3e\r\n                    \x3cdiv class\x3d"btn-add-section" data-dojo-attach-point\x3d"btnAddValue"\x3e\r\n                      \x3cspan class\x3d"btn-add-icon"\x3e\x3c/span\x3e\r\n                      \x3cspan class\x3d"btn-add-label"\x3e${nls.addValue}\x3c/span\x3e\r\n                    \x3c/div\x3e\r\n                    \x3cdiv class\x3d"values-table" style\x3d"width:100%;" data-dojo-attach-point\x3d"valuesTable" data-dojo-type\x3d"jimu/dijit/SimpleTable"\r\n                         data-dojo-props\x3d"_rowHeight:40,autoHeight:true,selectable:true,\r\n                                          fields:[{name:\'operator\',title:\'${nls.operator}\',type:\'text\',editable:false,width:\'100px\'},\r\n                                          {name:\'sqltext\',title:\'${nls.valuesTitle}\',type:\'text\',editable:false},\r\n                                          {name:\'actions\',width:\'120px\',title:\'${nls.actions}\',type:\'actions\',actions:[\'edit\',\'delete\']}\r\n                                          ]"\x3e\x3c/div\x3e\r\n                  \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n              \x3c/tbody\x3e\r\n            \x3c/table\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"single-values-section" style\x3d"display:none;" data-dojo-attach-point\x3d"singleValuesSection"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n'}});
define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/query dojo/on dojo/json dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/Tooltip dojo/text!./SingleExpressionEdit.html dijit/form/TextBox dijit/form/ValidationTextBox jimu/dijit/Popup ./LayerFieldChooser jimu/dijit/SimpleTable esri/request ./SingleValueEdit dojo/keys jimu/utils".split(" "),function(k,c,f,e,u,d,v,l,m,n,g,p,w,x,q,y,z,A,r,h,t){return k([l,m,n],{baseClass:"widget-esearch-singleexpression-setting",
templateString:p,nls:null,config:null,tr:null,searchSetting:null,layerURL:null,layerDef:null,layerUniqueCache:null,layerInfoCache:null,singleValueedit:null,lastOperator:"",disableuvcache:!1,postCreate:function(){this.inherited(arguments);this._bindEvents();this.setConfig(this.config)},startup:function(){this.inherited(arguments);this.popup.disableButton(0)},setConfig:function(a){a&&(this.isHosted=t.isHostedService(this.layerURL),this.config=a,this.resetAll(),this.searchLabel.set("value",c.trim(this.config.textsearchlabel||
"")),this.expressionAlias.set("value",c.trim(this.config.alias||"")),this.config.values&&this._initValuesTable())},getConfig:function(){if(!this.validate(!1))return!1;var a=this._getAllSingleValues(),b={alias:c.trim(this.expressionAlias.get("value")),textsearchlabel:c.trim(this.searchLabel.get("value")),values:{value:[]}};b.values.value=a;return this.config=b},_initValuesTable:function(){this.valuesTable.clear();var a=1;f.forEach(this.config&&this.config.values.value,c.hitch(this,function(b){var c=
{config:b,len:a};b.operator&&(this.lastOperator=b.operator);this._createSingleValue(c);a++}))},_getSingleValueCount:function(){return this.valuesTable.getRows()},_createSingleValue:function(a){var b={sqltext:a.config&&a.config.sqltext||"",operator:a.config&&a.config.operator||""};1<a.len&&""===b.operator&&(this.lastOperator=b.operator="AND");b=this.valuesTable.addRow(b);if(!b.success)return null;b.tr.singleValue=a.config;b.tr.len=a.len;b.tr.operator=this.lastOperator;return b.tr},resetAll:function(){this.expressionAlias.set("value",
"");this.searchLabel.set("value","")},_bindEvents:function(){this.own(d(this.expressionAlias,"change",c.hitch(this,this._checkProceed)));this.own(d(this.valuesTable,"row-add",c.hitch(this,this._checkProceed)));this.own(d(this.valuesTable,"row-delete",c.hitch(this,this._checkProceed)));this.own(d(this.btnAddValue,"click",c.hitch(this,function(){var a={config:null,len:this._getSingleValueCount().length+1};if(a=this._createSingleValue(a))this.popupState="ADD",this._showSingleValuesSection(a)})));this.own(d(this.valuesTable,
"actions-edit",c.hitch(this,function(a){this.popupState="EDIT";this._showSingleValuesSection(a)})));this.own(d(this.valuesTable,"row-delete",c.hitch(this,function(a){delete a.singleValue})))},_checkProceed:function(){if(this.popup){var a="",b=!0;e.setAttr(this.errorMessage,"innerHTML","");b=""!==c.trim(this.expressionAlias.get("value"))?b&&0<this.valuesTable.getData().length:!1;""===c.trim(this.expressionAlias.get("value"))&&(a+=this.nls.expressionAlias+" "+this.nls.requiredfield+" ");0===this.valuesTable.getData().length&&
(a=""===a?a+(this.nls.valuesTitle+" "+this.nls.isempty):a+(", "+this.nls.valuesTitle+" "+this.nls.isempty));b?this.popup.enableButton(0):(this.popup.disableButton(0),a&&e.setAttr(this.errorMessage,"innerHTML",a))}},validate:function(a){return""===c.trim(this.expressionAlias.get("value"))?(a&&this._showTooltip(this.expressionAlias.domNode,"Please input value."),!1):!0},_showTooltip:function(a,b,c){this._scrollToDom(a);g.show(b,a);setTimeout(function(){g.hide(a)},c?c:2E3)},_scrollToDom:function(a){var b=
this.searchSetting.domNode.parentNode,c=e.position(b).y;a=e.position(a).y;b.scrollTop=a-c},_showSingleValuesSection:function(a){this._openSingleValueEdit("EDIT"===this.popupState?this.nls.updateExpressionValue:this.nls.addExpressionValue,a)},_getAllSingleValues:function(){var a=this.valuesTable._getNotEmptyRows(),a=f.map(a,c.hitch(this,function(a){return a.singleValue}));1===a.length&&delete a[0].operator;return a},_openSingleValueEdit:function(a,b){this.singleValueedit=new r({nls:this.nls,tr:b,searchSetting:this,
layerURL:this.layerURL,layerDef:this.layerDef,layerUniqueCache:this.layerUniqueCache,layerInfoCache:this.layerInfoCache,len:b.len,operator:b.operator,isHosted:this.isHosted,config:b.singleValue||{},disableuvcache:this.disableuvcache});this.popup2=new q({titleLabel:a,autoHeight:!0,content:this.singleValueedit,container:"main-page",buttons:[{label:this.nls.ok,key:h.ENTER,onClick:c.hitch(this,"_onSingleValueEditOk")},{label:this.nls.cancel,key:h.ESCAPE}],onClose:c.hitch(this,"_onSingleValueEditClose")});
e.addClass(this.popup2.domNode,"widget-setting-popup");this.singleValueedit.startup()},_onSingleValueEditOk:function(){var a={},b=this.singleValueedit.getConfig();a.sqltext=b.sqltext;a.operator=b.operator||"";b.operator&&(this.lastOperator=b.operator);this.singleValueedit.tr.singleValue=b;this.valuesTable.editRow(this.singleValueedit.tr,a);this.popupState="";this.popup2.close()},_onSingleValueEditClose:function(){"ADD"===this.popupState&&this.valuesTable.deleteRow(this.singleValueedit.tr);this.popup2=
this.singleValueedit=null}})});