//>>built
require({cache:{"url:widgets/HucNavigation/SingleParameter.html":'\x3cdiv\x3e\r\n  \x3ctable style\x3d"width:100%;"\x3e\r\n    \x3ccolgroup\x3e\r\n      \x3ccol width\x3d"100px" /\x3e\r\n      \x3ccol width\x3d"auto" /\x3e\r\n    \x3c/colgroup\x3e\r\n    \x3ctbody\x3e\r\n      \x3ctr data-dojo-attach-point\x3d"uniqueMessageTR" style\x3d"display: none;"\x3e\r\n        \x3ctd colspan\x3d"2"\x3e\r\n          \x3cdiv style\x3d"margin-bottom: 8px; height: 18px;"\x3e\r\n            \x3cdiv class\x3d"uniqueBusy"\x3e\x3c/div\x3e\r\n            \x3cdiv class\x3d"uniqueMessage" data-dojo-attach-point\x3d"uniqueMessageNode"\x3e\x3c/div\x3e\r\n            \x3cdiv class\x3d"cancelUnique" data-dojo-attach-point\x3d"uniqueCancelNode"\x3e${nls.cancel}\x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv class\x3d"prompt" data-dojo-attach-point\x3d"promptNode"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"allValueBoxContainer" style\x3d"width:100%;padding-bottom:2px;"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"stringTextBoxContainer" style\x3d"display:none;"\x3e\r\n              \x3cinput data-dojo-attach-point\x3d"stringTextBox" data-dojo-type\x3d"dijit/form/TextBox" data-dojo-props\x3d"trim:true" style\x3d"display:none;width:100%;height:30px;" class\x3d"dijit-form-TextBox" /\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"stringCodedValuesFS" data-dojo-type\x3d"dijit/form/FilteringSelect"\r\n                   data-dojo-props\x3d"searchAttr:\'name\',intermediateChanges:true" class\x3d"dijit-form-FilteringSelect"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n\r\n            \x3cdiv data-dojo-attach-point\x3d"numberTextBoxContainer" style\x3d"display:none;"\x3e\r\n              \x3cinput data-dojo-attach-point\x3d"numberTextBox" data-dojo-type\x3d"dijit/form/NumberTextBox"\r\n                     data-dojo-props\x3d"intermediateChanges:true,constraints: {pattern: \'#####0.##########\'}"\r\n                     class\x3d"dijit-form-NumberTextBox" style\x3d"display:none;width:100%;height:30px;" /\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"numberCodedValuesFS" data-dojo-type\x3d"dijit/form/FilteringSelect"\r\n                   data-dojo-props\x3d"searchAttr:\'name\',required:false,intermediateChanges:true" class\x3d"dijit-form-FilteringSelect"\x3e\x3c/div\x3e\r\n              \x3ctable data-dojo-attach-point\x3d"numberRangeTable" style\x3d"display:none;width:100%;border-collapse:collapse;" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n                \x3ctbody\x3e\r\n                  \x3ctr\x3e\r\n                    \x3ctd style\x3d"width:40%;"\x3e\r\n                      \x3cinput data-dojo-attach-point\x3d"numberTextBox1" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-event\x3d"blur:_onRangeNumberBlur" data-dojo-props\x3d"intermediateChanges:true,constraints: {pattern: \'#####0.##########\'}" class\x3d"dijit-form-NumberTextBox" style\x3d"width:100%;height:30px;" /\x3e\r\n                    \x3c/td\x3e\r\n                    \x3ctd style\x3d"width:20%;text-align:center;"\x3e\r\n                      \x3cspan\x3e${nls.and}\x3c/span\x3e\r\n                    \x3c/td\x3e\r\n                    \x3ctd style\x3d"width:40%;"\x3e\r\n                      \x3cinput data-dojo-attach-point\x3d"numberTextBox2" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-event\x3d"blur:_onRangeNumberBlur" data-dojo-props\x3d"intermediateChanges:true,constraints: {pattern: \'#####0.##########\'}" class\x3d"dijit-form-NumberTextBox" style\x3d"width:100%;height:30px;" /\x3e\r\n                    \x3c/td\x3e\r\n                  \x3c/tr\x3e\r\n                \x3c/tbody\x3e\r\n              \x3c/table\x3e\r\n            \x3c/div\x3e\r\n\r\n            \x3cdiv data-dojo-attach-point\x3d"dateTextBoxContainer" style\x3d"display:none;"\x3e\r\n              \x3cinput data-dojo-attach-point\x3d"dateTextBox" data-dojo-type\x3d"dijit/form/DateTextBox"\r\n                     data-dojo-props\x3d"value:new Date(),trim:true,constraints:{datePattern: \'yyyy-MM-dd\'}"\r\n                     class\x3d"dijit-form-DateTextBox" style\x3d"display:none;width:100%;height:30px;" /\x3e\r\n\r\n              \x3ctable data-dojo-attach-point\x3d"dateRangeTable" style\x3d"display:none;width:100%;border-collapse:collapse;" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n                \x3ctbody\x3e\r\n                  \x3ctr\x3e\r\n                    \x3ctd style\x3d"width:40%;"\x3e\r\n                      \x3cinput data-dojo-attach-point\x3d"dateTextBox1" data-dojo-type\x3d"dijit/form/DateTextBox"\r\n                             data-dojo-attach-event\x3d"change:_onRangeDateBlur"\r\n                             data-dojo-props\x3d"value:new Date(),trim:true,constraints:{datePattern: \'yyyy-MM-dd\'}"\r\n                             class\x3d"dijit-form-DateTextBox" style\x3d"width:100%;height:30px;" /\x3e\r\n                    \x3c/td\x3e\r\n                    \x3ctd style\x3d"width:20%;text-align:center;"\x3e\r\n                      \x3cspan\x3e${nls.and}\x3c/span\x3e\r\n                    \x3c/td\x3e\r\n                    \x3ctd\x3e\r\n                      \x3cinput data-dojo-attach-point\x3d"dateTextBox2" data-dojo-type\x3d"dijit/form/DateTextBox" data-dojo-attach-event\x3d"change:_onRangeDateBlur"\r\n                             data-dojo-props\x3d"value:new Date(),trim:true,constraints:{datePattern: \'yyyy-MM-dd\'}"\r\n                             class\x3d"dijit-form-DateTextBox" style\x3d"width:100%;height:30px;" /\x3e\r\n                    \x3c/td\x3e\r\n                  \x3c/tr\x3e\r\n                \x3c/tbody\x3e\r\n              \x3c/table\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd\x3e\r\n          \x3cspan class\x3d"required" title\x3d"${nls.requiredTip}" data-dojo-attach-point\x3d"requiredNode"\x3e*${nls.required}\x3c/span\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv class\x3d"hint" data-dojo-attach-point\x3d"hintNode"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n    \x3c/tbody\x3e\r\n  \x3c/table\x3e\r\n\x3c/div\x3e\r\n'}});
define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./SingleParameter.html dojo/_base/lang dojo/_base/html dojo/_base/array dojo/json dojo/on dojo/query dojo/Deferred dijit/form/FilteringSelect dijit/form/ValidationTextBox dijit/form/DateTextBox dijit/form/Textarea dijit/form/NumberTextBox dojo/store/Memory esri/request ./PagingQueryTask dojo/keys dojo/Evented dijit/focus".split(" "),function(v,w,x,y,z,d,g,l,A,q,B,C,D,E,F,G,H,n,I,t,J,K,m){return v([w,
x,y],{baseClass:"widget-esearch-single-parameter",templateString:z,fieldInfo:null,layerDetails:null,layerUri:null,layerDef:null,value:null,nls:null,isValueRequired:!1,allString:"all",dayInMS:86399E3,_type:-1,layerUniqueCache:null,pagingQueryTask:null,pagingAttempts:0,disableuvcache:!1,pagingWasCanceled:!1,selectFilterType:null,numberwithin:!1,postCreate:function(){this.inherited(arguments);this.fieldInfo&&this.value&&this.build(this.fieldInfo,this.value)},focusValueObj:function(){var a=this.value.fieldObj.shortType;
"string"===a||this.numberwithin?1===this._type?m.focus(this.stringTextBox):2===this._type&&m.focus(this.stringCodedValuesFS):"number"===a?1===this._type?m.focus(this.numberTextBox):2===this._type?m.focus(this.numberCodedValuesFS):3===this._type&&m.focus(this.numberTextBox1):"date"===a&&(1===this._type?m.focus(this.dateTextBox):2===this._type&&m.focus(this.dateTextBox1))},getValueObj:function(){var a=this.value.fieldObj.shortType;return"string"===a||this.numberwithin?this._getStringValueObj():"number"===
a?this._getNumberValueObj():"date"===a?this._getDateValueObj():null},setValueObj:function(a){var b=this.value.fieldObj.shortType;"string"===b||this.numberwithin?1===this._type?this.stringTextBox.set("value",a.valueObj.value):2===this._type&&(b=l.filter(this.stringCodedValuesFS.store.data,d.hitch(this,function(b){return b.code===a.valueObj.value})),0<b.length&&this.stringCodedValuesFS.set("value",b[0].id)):"number"===b?1===this._type?this.numberTextBox.set("value",a.valueObj.value):2===this._type?
(b=l.filter(this.numberCodedValuesFS.store,d.hitch(this,function(b){return b.code===a.valueObj.value})),0<b.length&&this.numberCodedValuesFS.set("value",b[0].id)):3===this._type&&(this.numberTextBox1.set("value",a.valueObj.value1),this.numberTextBox2.set("value",a.valueObj.value2)):"date"===b&&(1===this._type?""===a.valueObj.value?this.dateTextBox.set("value",null):this.dateTextBox.set("value",new Date(a.valueObj.value)):2===this._type&&(""===a.valueObj.value?(this.dateTextBox1.set("value",null),
this.dateTextBox2.set("value",null)):(this.dateTextBox1.set("value",new Date(a.valueObj.value1)),this.dateTextBox2.set("value",new Date(a.valueObj.value2)))))},_getStringValueObj:function(){var a=null;if(1===this._type)a={},a.value=this.stringTextBox.get("value");else if(2===this._type){if(!this.stringCodedValuesFS.validate())return this._showValidationErrorTip(this.stringCodedValuesFS),null;var a={},b=this._getSelectedFilteringItem(this.stringCodedValuesFS);a.value=b.code}return a},_getNumberValueObj:function(){var a=
null;if(1===this._type){if(!this.numberTextBox.validate())return this._showValidationErrorTip(this.numberTextBox),null;a={};a.value=parseFloat(this.numberTextBox.get("value"))}else if(2===this._type){if(!this.numberCodedValuesFS.validate())return this._showValidationErrorTip(this.numberCodedValuesFS),null;var a={},b=this._getSelectedFilteringItem(this.numberCodedValuesFS);a.value="allu"===b.code||"all"===b.code?b.code:parseFloat(b.code)}else if(3===this._type){if(!this.numberTextBox1.validate())return this._showValidationErrorTip(this.numberTextBox1),
null;if(!this.numberTextBox2.validate())return this._showValidationErrorTip(this.numberTextBox2),null;a={};a.value1=parseFloat(this.numberTextBox1.get("value"));a.value2=parseFloat(this.numberTextBox2.get("value"))}return a},_getDateValueObj:function(){var a=null;if(1===this._type){if(!this.dateTextBox.validate())return this._showValidationErrorTip(this.dateTextBox),null;a={};this.dateTextBox.get("value")?a.value=dojo.date.locale.format(this.dateTextBox.get("value"),{datePattern:"yyyy-MM-dd HH:mm:ss",
selector:"date"}):a.value=null}else if(2===this._type){if(!this.dateTextBox1.validate())return this._showValidationErrorTip(this.dateTextBox1),null;if(!this.dateTextBox2.validate())return this._showValidationErrorTip(this.dateTextBox2),null;a={};this.dateTextBox1.get("value")?a.value1=dojo.date.locale.format(this.dateTextBox1.get("value"),{datePattern:"yyyy-MM-dd HH:mm:ss",selector:"date"}):a.value1=null;this.dateTextBox2.get("value")?a.value2=dojo.date.locale.format(this.dateTextBox2.get("value"),
{datePattern:"yyyy-MM-dd HH:mm:ss",selector:"date"}):a.value2=null}return a},formatDate:function(a){var b=dojo.date.locale.format(a,{datePattern:"yyyy-MM-dd",selector:"date"});a=dojo.date.locale.format(a,{selector:"time",timePattern:"HH:mm:ss"});return b+" "+a},addDay:function(a){return new Date(a.getTime()+this.dayInMS)},build:function(a,b){this.numberwithin=!1;this.own(q(this.stringTextBox,"keydown",d.hitch(this,function(a){13===(void 0!==a.keyCode?a.keyCode:a.which)&&this.emit("sp-enter-pressed",
{})})));this.own(q(this.numberTextBox,"keydown",d.hitch(this,function(a){13===(void 0!==a.keyCode?a.keyCode:a.which)&&this.emit("sp-enter-pressed",{})})));this.own(q(this.dateTextBox,"keydown",d.hitch(this,function(a){13===(void 0!==a.keyCode?a.keyCode:a.which)&&this.emit("sp-enter-pressed",{})})));this.fieldInfo=a;this.value=b;b.hasOwnProperty("required")&&b.required?g.setStyle(this.requiredNode,"display",""):g.setStyle(this.requiredNode,"display","none");this.promptNode.innerHTML=b.prompt||"";this.hintNode.innerHTML=
b.textsearchhint||"";var e=this.value.fieldObj.shortType,c=this.value.userlist||null,f=this.value.uniquevalsfromfield||null;if("string"===e)this.stringCodedValuesFS.set("autoComplete",!1),"contains"===this.selectFilterType&&this.stringCodedValuesFS.set("queryExpr","*${0}*"),""===b.prompt?(this.stringCodedValuesFS.set("readOnly",!0),this.stringTextBox.set("readOnly",!0)):(this.stringCodedValuesFS.set("readOnly",!1),this.stringTextBox.set("readOnly",!1)),c?this._buildString(a,this.value,c):f?this._buildString(a,
this.value,null,f):this._buildString(a,this.value);else if("number"===e){""===b.prompt?(this.numberTextBox1.set("readOnly",!0),this.numberTextBox2.set("readOnly",!0),this.numberCodedValuesFS.set("readOnly",!0),this.numberTextBox.set("readOnly",!0)):(this.numberTextBox1.set("readOnly",!1),this.numberTextBox2.set("readOnly",!1),this.numberCodedValuesFS.set("readOnly",!1),this.numberTextBox.set("readOnly",!1));if(0<this.value.sqltext.toLowerCase().indexOf(" in (")){this.numberwithin=!0;this._buildString(a,
this.value);return}c?this._buildNumber(a,this.value,c):f?this._buildNumber(a,this.value,null,f):this._buildNumber(a,this.value)}else"date"===e&&(""===b.prompt?(this.dateTextBox.set("readOnly",!0),this.dateTextBox1.set("readOnly",!0),this.dateTextBox2.set("readOnly",!0)):(this.dateTextBox.set("readOnly",!1),this.dateTextBox1.set("readOnly",!1),this.dateTextBox2.set("readOnly",!1)),this._buildDate(a,this.value));"numberOperatorIsBlank"===b.operation||"numberOperatorIsNotBlank"===b.operation||"stringOperatorIsBlank"===
b.operation||"stringOperatorIsNotBlank"===b.operation||"dateOperatorIsBlank"===b.operation||"dateOperatorIsNotBlank"===b.operation?g.setStyle(this.allValueBoxContainer,"display","none"):g.setStyle(this.allValueBoxContainer,"display","inline-block")},_getCodedValues:function(a){var b=null;(a=a.domain)&&"codedValue"===a.type&&a.codedValues&&0<a.codedValues.length&&(b=a.codedValues);return b},_getSubTypeValues:function(){var a=[];a.push({name:"",code:-1});for(var b=0;b<this.layerDetails.types.length;b++){var d=
this.layerDetails.types[b];a.push({name:d.name,code:d.id})}return a},_buildString:function(a,b,e,c){g.setStyle(this.stringTextBoxContainer,"display","block");g.setStyle(this.numberTextBoxContainer,"display","none");g.setStyle(this.dateTextBoxContainer,"display","none");var f=b.valueObj;if((b=this._getCodedValues(a))||e||c){var h;this._type=2;this._showDijit(this.stringCodedValuesFS);this._hideDijit(this.stringTextBox);this.stringCodedValuesFS.set("displayedValue","");var m=new n({data:[]});this.stringCodedValuesFS.set("store",
m);if(!b||c||e)if(c){var p;b=this.disableuvcache?null:this.layerUniqueCache[this.layerUri];b||(b={},this.layerUniqueCache[this.layerUri]=b);m=this.layerDef?c+this.layerDef:c;e=[];m in b?(e=b[m],p=new n({data:e}),this.stringCodedValuesFS.set("store",p),f&&(c=l.filter(h,d.hitch(this,function(a){return a.code===f.value})),0<c.length?this.stringCodedValuesFS.set("value",c[0].id):this.stringCodedValuesFS.set("value",e[0].id)),setTimeout(d.hitch(this,function(){this.emit("sp-ready",{})}),200)):(this.pagingQueryTask=
new t,this.own(q(this.uniqueCancelNode,"click",d.hitch(this,function(){this.pagingWasCanceled=this.pagingQueryTask.esc=this.pagingQueryTask.pagingEscaped=!0}))),this.pagingQueryTask.uri=this.layerUri,this.pagingQueryTask.fieldName=c,this.pagingQueryTask.dateFormat="",this.pagingQueryTask.version=this.layerDetails.currentVersion,this.layerDetails.maxRecordCount&&(this.pagingQueryTask.maxRecordCount=this.layerDetails.maxRecordCount),this.pagingQueryTask.isRequired=this.isValueRequired,this.layerDef&&
(this.pagingQueryTask.defExpr=this.layerDef),this.pagingQueryTask.on("pagingComplete",d.hitch(this,function(b){g.setStyle(this.uniqueMessageTR,"display","none");this.uniqueMessageNode.innerHTML="";this.pagingAttempts=0;h=l.map(b,d.hitch(this,function(a,b){a=d.mixin({},a);a.id=b;return a}));if(this._isFieldCoded(a)){var c=a.domain;l.map(h,d.hitch(this,function(a){for(var b=0;b<c.codedValues.length;b++){var d=c.codedValues[b];if(a.code===d.code){a.name=d.name;break}}}))}this.pagingWasCanceled||(this.layerDef?
this.layerUniqueCache[this.layerUri][this.pagingQueryTask.fieldName+this.layerDef]=h:this.layerUniqueCache[this.layerUri][this.pagingQueryTask.fieldName]=h);p=new n({data:h});"undefined"!==typeof this.stringCodedValuesFS&&(this.stringCodedValuesFS.set("store",p),f&&(b=l.filter(h,d.hitch(this,function(a){return a.code===f.value})),0<b.length?this.stringCodedValuesFS.set("value",b[0].id):this.stringCodedValuesFS.set("value",h[0].id)),setTimeout(d.hitch(this,function(){this.emit("sp-ready",{})}),200))})),
this.pagingQueryTask.on("pagingFault",d.hitch(this,function(){this.pagingAttempts++;4>=this.pagingAttempts?(console.warn("pagingQueryTask has been launched again for the "+this.pagingAttempts+" time"),this.pagingQueryTask.startup(),this.pagingQueryTask.execute()):(this._type=1,this._showDijit(this.stringTextBox),this._hideDijit(this.stringCodedValuesFS),this.stringTextBox.set("value",f.value||""),g.setStyle(this.uniqueMessageTR,"display","none"),this.uniqueMessageNode.innerHTML="",setTimeout(d.hitch(this,
function(){this.emit("sp-ready",{})}),200))})),this.pagingQueryTask.startup(),this.pagingQueryTask.execute(),g.setStyle(this.uniqueMessageTR,"display","table-row"),this.uniqueMessageNode.innerHTML=this.nls.uniqueValues,this.pagingQueryTask.on("featuresTotal",d.hitch(this,function(){g.setStyle(this.uniqueMessageTR,"display","table-row");this.uniqueMessageNode.innerHTML=this.nls.processingUnique+this.pagingQueryTask.featuresProcessed+this.nls.of+this.pagingQueryTask.featuresTotal})),this.pagingQueryTask.on("featuresProcessed",
d.hitch(this,function(){g.setStyle(this.uniqueMessageTR,"display","table-row");this.uniqueMessageNode.innerHTML=this.nls.processingUnique+this.pagingQueryTask.featuresProcessed+this.nls.of+this.pagingQueryTask.featuresTotal})))}else-1<e.indexOf("',")?(c=this.trimArray(e.split("',")),c=l.map(c,function(a,b){String(a).indexOf("|'")&&(a=String(a).replace("|'","|"));return a}),e=String(c[c.length-1]),"'"==e.substring(e.length-1)&&(c[c.length-1]=e.substring(0,e.length-1))):c=this.trimArray(e.split(",")),
h=l.map(c,d.hitch(this,function(a,b){var c;c=a;a===this.allString&&(c="all");0>a.indexOf("|")?c=d.mixin({},{name:a,code:c}):(a=a.split("|"),c="all"===c?d.mixin({},{name:a[0],code:c}):d.mixin({},{name:a[0],code:a[1]}));c.id=b;return c})),this.isValueRequired||(c=d.mixin({},{name:"",code:""}),c.id=h.length,h.unshift(c));else h=l.map(b,d.hitch(this,function(a,b){a=d.mixin({},a);a.id=b;return a})),this.isValueRequired||(c=d.mixin({},{name:"",code:""}),c.id=h.length,h.unshift(c));if(!h)return;c=new n({data:h});
this.stringCodedValuesFS.set("store",c);f&&(c=l.filter(h,d.hitch(this,function(a){return a.code===f.value})),0<c.length?this.stringCodedValuesFS.set("value",c[0].id):this.stringCodedValuesFS.set("value",h[0].id))}else c=new n({data:[]}),this.stringCodedValuesFS.set("store",c),this._type=1,this._showDijit(this.stringTextBox),this._hideDijit(this.stringCodedValuesFS),this.stringTextBox.set("value",f?f.value:""),this.isValueRequired&&this.stringTextBox.set("required",!0);setTimeout(d.hitch(this,function(){this.emit("sp-ready",
{})}),200)},trimArray:function(a){for(var b=0;b<a.length;b++)a[b]=a[b].replace(/^\s*/,"").replace(/\s*$/,"");return a},_buildNumber:function(a,b,e,c){g.setStyle(this.stringTextBoxContainer,"display","none");g.setStyle(this.numberTextBoxContainer,"display","block");g.setStyle(this.dateTextBoxContainer,"display","none");var f=b.valueObj,h=b.operation;b=this._getCodedValues(a);var m=parseFloat(f.value);if(h===this.nls.numberOperatorIsBetween||h===this.nls.numberOperatorIsNotBetween)this._type=3,g.setStyle(this.numberRangeTable,
"display","table"),this._hideDijit(this.numberTextBox),this._hideDijit(this.numberCodedValuesFS),c=parseFloat(f.value1),e=parseFloat(f.value2),this.numberTextBox1.set("value",c),this.numberTextBox2.set("value",e),this.isValueRequired&&(this.numberTextBox1.set("required",!0),this.numberTextBox2.set("required",!0)),setTimeout(d.hitch(this,function(){this.emit("sp-ready",{})}),200);else if(g.setStyle(this.numberRangeTable,"display","none"),this.layerDetails.typeIdField&&this.layerDetails.typeIdField.toUpperCase()===
a.name.toUpperCase()){if(c=this._getSubTypeValues()){this._type=2;this._showDijit(this.numberCodedValuesFS);this._hideDijit(this.numberTextBox);c=l.map(c,d.hitch(this,function(a,b){a=d.mixin({},a);a.id=b;return a}));this.isValueRequired||(e=d.mixin({},{name:"",code:""}),e.id=c.length,c.unshift(e));e=new n({data:c});this.numberCodedValuesFS.set("store",e);if(f&&!isNaN(f.value)){var p=parseFloat(f.value);e=l.filter(c,d.hitch(this,function(a){return parseFloat(a.code)===p}));0<e.length?this.numberCodedValuesFS.set("value",
e[0].id):this.numberCodedValuesFS.set("value",c[0].id)}else this.numberCodedValuesFS.set("value",c[0].id);setTimeout(d.hitch(this,function(){this.emit("sp-ready",{})}),200)}}else if(b||e||c){var k;this._type=2;this._showDijit(this.numberCodedValuesFS);this._hideDijit(this.numberTextBox);this.numberCodedValuesFS.set("displayedValue","");h=new n({data:[]});this.numberCodedValuesFS.set("store",h);if(!b||c||e)if(c){var r;b=this.layerUniqueCache[this.layerUri];b||(b={},this.layerUniqueCache[this.layerUri]=
b);e=[];c in b?(e=b[c],r=new n({data:e}),this.numberCodedValuesFS.set("store",r),f&&(c=l.filter(k,d.hitch(this,function(a){return a.code===f.value})),0<c.length?this.numberCodedValuesFS.set("value",c[0].id):this.numberCodedValuesFS.set("value",e[0].id)),setTimeout(d.hitch(this,function(){this.emit("sp-ready",{})}),200)):(this.pagingQueryTask=new t,this.own(q(this.uniqueCancelNode,"click",d.hitch(this,function(){this.pagingWasCanceled=this.pagingQueryTask.esc=this.pagingQueryTask.pagingEscaped=!0}))),
this.pagingQueryTask.uri=this.layerUri,this.pagingQueryTask.fieldName=c,this.pagingQueryTask.dateFormat="",this.pagingQueryTask.version=this.layerDetails.currentVersion,this.pagingQueryTask.maxRecordCount=this.layerDetails.maxRecordCount,this.layerDef&&(this.pagingQueryTask.defExpr=this.layerDef),this.pagingQueryTask.on("pagingComplete",d.hitch(this,function(b){g.setStyle(this.uniqueMessageTR,"display","none");this.uniqueMessageNode.innerHTML="";this.pagingAttempts=0;k=l.map(b,d.hitch(this,function(a,
b){a=d.mixin({},a);a.id=b;return a}));if(this._isFieldCoded(a)){var c=a.domain;l.map(k,d.hitch(this,function(a){for(var b=0;b<c.codedValues.length;b++){var d=c.codedValues[b];if(a.code===d.code){a.name=d.name;break}}}))}this.pagingWasCanceled||(this.layerUniqueCache[this.layerUri][this.pagingQueryTask.fieldName]=k);r=new n({data:k});"undefined"!==typeof this.numberCodedValuesFS&&(this.numberCodedValuesFS.set("store",r),f&&(b=l.filter(k,d.hitch(this,function(a){return a.code===f.value})),0<b.length?
this.numberCodedValuesFS.set("value",b[0].id):this.numberCodedValuesFS.set("value",k[0].id)),setTimeout(d.hitch(this,function(){this.emit("sp-ready",{})}),200))})),this.pagingQueryTask.on("pagingFault",d.hitch(this,function(){this.pagingAttempts++;4>=this.pagingAttempts?(console.warn("pagingQueryTask has been launched again for the "+this.pagingAttempts+" time"),this.pagingQueryTask.startup(),this.pagingQueryTask.execute()):(this._type=1,this._showDijit(this.numberTextBox),this._hideDijit(this.numberCodedValuesFS),
this.numberTextBox.set("value",m),setTimeout(d.hitch(this,function(){this.emit("sp-ready",{})}),200))})),this.pagingQueryTask.startup(),this.pagingQueryTask.execute(),g.setStyle(this.uniqueMessageTR,"display","table-row"),this.uniqueMessageNode.innerHTML=this.nls.uniqueValues,this.pagingQueryTask.on("featuresTotal",d.hitch(this,function(){g.setStyle(this.uniqueMessageTR,"display","table-row");this.uniqueMessageNode.innerHTML=this.nls.processingUnique+this.pagingQueryTask.featuresProcessed+this.nls.of+
this.pagingQueryTask.featuresTotal})),this.pagingQueryTask.on("featuresProcessed",d.hitch(this,function(){g.setStyle(this.uniqueMessageTR,"display","table-row");this.uniqueMessageNode.innerHTML=this.nls.processingUnique+this.pagingQueryTask.featuresProcessed+this.nls.of+this.pagingQueryTask.featuresTotal})))}else c=this.trimArray(e.split(",")),k=l.map(c,d.hitch(this,function(a,b){var c;c=a;a===this.allString&&(c="all");0>a.indexOf("|")?c=d.mixin({},{name:a,code:c}):(a=a.split("|"),c="all"===c?d.mixin({},
{name:a[0],code:c}):d.mixin({},{name:a[0],code:a[1]}));c.id=b;return c})),this.isValueRequired||(e=d.mixin({},{name:"",code:""}),e.id=k.length,k.unshift(e)),c=new n({data:k}),this.numberCodedValuesFS.set("store",c),f&&!isNaN(f.value)?(parseFloat(f.value),c=l.filter(k,d.hitch(this,function(a){return parseFloat(a.code)===u})),0<c.length?this.numberCodedValuesFS.set("value",c[0].id):this.numberCodedValuesFS.set("value",k[0].id)):this.numberCodedValuesFS.set("value",k[0].id),setTimeout(d.hitch(this,function(){this.emit("sp-ready",
{})}),200);else{k=l.map(b,d.hitch(this,function(a,b){a=d.mixin({},a);a.id=b;return a}));this.isValueRequired||(c=d.mixin({},{name:"",code:""}),c.id=k.length,k.unshift(c));c=new n({data:k});this.numberCodedValuesFS.set("store",c);if(f&&!isNaN(f.value)){var u=parseFloat(f.value);c=l.filter(k,d.hitch(this,function(a){return parseFloat(a.code)===u}));0<c.length?this.numberCodedValuesFS.set("value",c[0].id):this.numberCodedValuesFS.set("value",k[0].id)}else this.numberCodedValuesFS.set("value",k[0].id);
setTimeout(d.hitch(this,function(){this.emit("sp-ready",{})}),200)}}else c=new n({data:[]}),this.numberCodedValuesFS.set("store",c),this._type=1,this._showDijit(this.numberTextBox),this._hideDijit(this.numberCodedValuesFS),this.numberTextBox.set("value",m),this.isValueRequired&&this.numberTextBox.set("required",!0),setTimeout(d.hitch(this,function(){this.emit("sp-ready",{})}),200)},_isFieldCoded:function(a){return(a=a.domain)&&"codedValue"===a.type&&a.codedValues&&0<a.codedValues.length},_buildDate:function(a,
b){g.setStyle(this.stringTextBoxContainer,"display","none");g.setStyle(this.numberTextBoxContainer,"display","none");g.setStyle(this.dateTextBoxContainer,"display","block");a=b.valueObj;var e=b.operation;e===this.nls.dateOperatorIsBetween||e===this.nls.dateOperatorIsNotBetween?(this._type=2,g.setStyle(this.dateRangeTable,"display","table"),this._hideDijit(this.dateTextBox),b.date1minus&&(b=parseInt(b.date1minus,10),b=new Date((new Date).getTime()-this.dayInMS*b),this.dateTextBox1.set("value",b)),
"[value]"!==a.value1&&"[value]"!==a.value2&&(this.dateTextBox1.set("value",new Date(a.value1)),this.dateTextBox2.set("value",new Date(a.value2))),this.isValueRequired&&(this.dateTextBox1.set("required",!0),this.dateTextBox2.set("required",!0))):(this._type=1,g.setStyle(this.dateRangeTable,"display","none"),this._showDijit(this.dateTextBox),this.dateTextBox.set("value",new Date(a.value)),this.isValueRequired&&this.dateTextBox.set("required",!0));setTimeout(d.hitch(this,function(){this.emit("sp-ready",
{})}),200)},_getSelectedFilteringItem:function(a){if(a.validate()){var b=a.get("value");if(isNaN(b))this._showValidationErrorTip(a);else if(a=a.store.query({id:b}),0<a.length&&(a=a[0]))return a}else this._showValidationErrorTip(a);return null},_showValidationErrorTip:function(a){!a.validate()&&a.domNode&&a.focusNode&&(a.focusNode.focus(),a.focusNode.blur())},_showDijit:function(a){a&&a.domNode&&g.setStyle(a.domNode,"display","inline-block")},_hideDijit:function(a){a&&a.domNode&&g.setStyle(a.domNode,
"display","none")},_onRangeNumberBlur:function(){if(this.numberTextBox1.validate()&&this.numberTextBox2.validate()){var a=parseFloat(this.numberTextBox1.get("value")),b=parseFloat(this.numberTextBox2.get("value"));a>b&&(this.numberTextBox1.set("value",b),this.numberTextBox2.set("value",a))}},_onRangeDateBlur:function(){if(this.dateTextBox1.validate()&&this.dateTextBox2.validate()){var a=this.dateTextBox1.get("value"),b=a.getTime(),d=this.dateTextBox2.get("value"),c=d.getTime();b>c&&(this.dateTextBox1.set("value",
d),this.dateTextBox2.set("value",a))}}})});